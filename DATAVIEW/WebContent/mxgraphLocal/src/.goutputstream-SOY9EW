var mxClient={VERSION:'1.10.0.6',IS_IE:navigator.userAgent.indexOf('MSIE')>=0,IS_IE6:navigator.userAgent.indexOf('MSIE 6')>=0,IS_NS:navigator.userAgent.indexOf('Mozilla/')>=0&&navigator.userAgent.indexOf('MSIE')<0,IS_OP:navigator.userAgent.indexOf('Opera/')>=0,IS_OT:navigator.userAgent.indexOf('Presto/2.4.')<0&&navigator.userAgent.indexOf('Presto/2.3.')<0&&navigator.userAgent.indexOf('Presto/2.2.')<0&&navigator.userAgent.indexOf('Presto/2.1.')<0&&navigator.userAgent.indexOf('Presto/2.0.')<0&&navigator.userAgent.indexOf('Presto/1.')<0,IS_SF:navigator.userAgent.indexOf('AppleWebKit/')>=0&&navigator.userAgent.indexOf('Chrome/')<0,IS_GC:navigator.userAgent.indexOf('Chrome/')>=0,IS_MT:(navigator.userAgent.indexOf('Firefox/')>=0&&navigator.userAgent.indexOf('Firefox/1.')<0&&navigator.userAgent.indexOf('Firefox/2.')<0)||(navigator.userAgent.indexOf('Iceweasel/')>=0&&navigator.userAgent.indexOf('Iceweasel/1.')<0&&navigator.userAgent.indexOf('Iceweasel/2.')<0)||(navigator.userAgent.indexOf('SeaMonkey/')>=0&&navigator.userAgent.indexOf('SeaMonkey/1.')<0)||(navigator.userAgent.indexOf('Iceape/')>=0&&navigator.userAgent.indexOf('Iceape/1.')<0),IS_SVG:navigator.userAgent.indexOf('Firefox/')>=0||navigator.userAgent.indexOf('Iceweasel/')>=0||navigator.userAgent.indexOf('Seamonkey/')>=0||navigator.userAgent.indexOf('Iceape/')>=0||navigator.userAgent.indexOf('Galeon/')>=0||navigator.userAgent.indexOf('Epiphany/')>=0||navigator.userAgent.indexOf('AppleWebKit/')>=0||navigator.userAgent.indexOf('Gecko/')>=0||navigator.userAgent.indexOf('Opera/')>=0,NO_FO:navigator.userAgent.indexOf('Firefox/1.')>=0||navigator.userAgent.indexOf('Iceweasel/1.')>=0||navigator.userAgent.indexOf('Firefox/2.')>=0||navigator.userAgent.indexOf('Iceweasel/2.')>=0||navigator.userAgent.indexOf('SeaMonkey/1.')>=0||navigator.userAgent.indexOf('Iceape/1.')>=0||navigator.userAgent.indexOf('Camino/1.')>=0||navigator.userAgent.indexOf('Epiphany/2.')>=0||navigator.userAgent.indexOf('Opera/')>=0||navigator.userAgent.indexOf('MSIE')>=0||navigator.userAgent.indexOf('Mozilla/2.')>=0,IS_VML:navigator.appName.toUpperCase()=='MICROSOFT INTERNET EXPLORER',IS_MAC:navigator.userAgent.toUpperCase().indexOf('MACINTOSH')>0,IS_TOUCH:navigator.userAgent.toUpperCase().indexOf('IPAD')>0||navigator.userAgent.toUpperCase().indexOf('IPOD')>0||navigator.userAgent.toUpperCase().indexOf('IPHONE')>0||navigator.userAgent.toUpperCase().indexOf('ANDROID')>0,IS_LOCAL:document.location.href.indexOf('http://')<0&&document.location.href.indexOf('https://')<0,isBrowserSupported:function(){return mxClient.IS_VML||mxClient.IS_SVG;},link:function(rel,href,doc){doc=doc||document;if(mxClient.IS_IE6){doc.write('<link rel="'+rel+'" href="'+href+'" charset="ISO-8859-1" type="text/css"/>');}else{var link=doc.createElement('link');link.setAttribute('rel',rel);link.setAttribute('href',href);link.setAttribute('charset','ISO-8859-1');link.setAttribute('type','text/css');var head=doc.getElementsByTagName('head')[0];head.appendChild(link);}},include:function(src){document.write('<script src="'+src+'"></script>');},dispose:function(){for(var i=0;i<mxEvent.objects.length;i++){if(mxEvent.objects[i].mxListenerList!=null){mxEvent.removeAllListeners(mxEvent.objects[i]);}}}};if(typeof(mxLoadResources)=='undefined'){mxLoadResources=true;}if(typeof(mxLoadStylesheets)=='undefined'){mxLoadStylesheets=true;}if(typeof(mxBasePath)!='undefined'&&mxBasePath.length>0){if(mxBasePath.substring(mxBasePath.length-1)=='/'){mxBasePath=mxBasePath.substring(0,mxBasePath.length-1);}mxClient.basePath=mxBasePath;}else{mxClient.basePath='.';}if(typeof(mxImageBasePath)!='undefined'&&mxImageBasePath.length>0){if(mxImageBasePath.substring(mxImageBasePath.length-1)=='/'){mxImageBasePath=mxImageBasePath.substring(0,mxImageBasePath.length-1);}mxClient.imageBasePath=mxImageBasePath;}else{mxClient.imageBasePath=mxClient.basePath+'/images';}if(typeof(mxLanguage)!='undefined'){mxClient.language=mxLanguage;}else{mxClient.language=(mxClient.IS_IE)?navigator.userLanguage:navigator.language;var dash=mxClient.language.indexOf('-');if(dash>0){mxClient.language=mxClient.language.substring(0,dash);}}if(typeof(mxDefaultLanguage)!='undefined'){mxClient.defaultLanguage=mxDefaultLanguage;}else{mxClient.defaultLanguage='en';}if(mxLoadStylesheets){mxClient.link('stylesheet',mxClient.basePath+'/css/common.css');}if(typeof(mxLanguages)!='undefined'){mxClient.languages=mxLanguages;}if(mxClient.IS_IE){if(document.documentMode>=9){mxClient.IS_VML=false;mxClient.IS_SVG=true;}else{if(document.documentMode==8){document.namespaces.add('v','urn:schemas-microsoft-com:vml','#default#VML');document.namespaces.add('o','urn:schemas-microsoft-com:office:office','#default#VML');}else{document.namespaces.add('v','urn:schemas-microsoft-com:vml');document.namespaces.add('o','urn:schemas-microsoft-com:office:office');}var ss=document.createStyleSheet();ss.cssText='v\\:*{behavior:url(#default#VML)}o\\:*{behavior:url(#default#VML)}';if(mxLoadStylesheets){mxClient.link('stylesheet',mxClient.basePath+'/css/explorer.css');}}window.attachEvent('onunload',mxClient.dispose);}var mxLog={consoleName:'Console',TRACE:false,DEBUG:true,WARN:true,buffer:'',init:function(){if(mxLog.window==null&&document.body!=null){var title=mxLog.consoleName+' - mxGraph '+mxClient.VERSION;var table=document.createElement('table');table.setAttribute('width','100%');table.setAttribute('height','100%');var tbody=document.createElement('tbody');var tr=document.createElement('tr');var td=document.createElement('td');td.style.verticalAlign='top';mxLog.textarea=document.createElement('textarea');mxLog.textarea.setAttribute('readOnly','true');mxLog.textarea.style.height='100%';mxLog.textarea.style.resize='none';mxLog.textarea.value=mxLog.buffer;if(mxClient.IS_NS&&document.compatMode!='BackCompat'){mxLog.textarea.style.width='99%';}else{mxLog.textarea.style.width='100%';}td.appendChild(mxLog.textarea);tr.appendChild(td);tbody.appendChild(tr);tr=document.createElement('tr');mxLog.td=document.createElement('td');mxLog.td.style.verticalAlign='top';mxLog.td.setAttribute('height','30px');tr.appendChild(mxLog.td);tbody.appendChild(tr);table.appendChild(tbody);mxLog.addButton('Info',function(evt){mxLog.info();});mxLog.addButton('DOM',function(evt){var content=mxUtils.getInnerHtml(document.body);mxLog.debug(content);});mxLog.addButton('Trace',function(evt){mxLog.TRACE=!mxLog.TRACE;if(mxLog.TRACE){mxLog.debug('Tracing enabled');}else{mxLog.debug('Tracing disabled');}});mxLog.addButton('Copy',function(evt){try{mxUtils.copy(mxLog.textarea.value);}catch(err){mxUtils.alert(err);}});mxLog.addButton('Show',function(evt){try{mxUtils.popup(mxLog.textarea.value);}catch(err){mxUtils.alert(err);}});mxLog.addButton('Clear',function(evt){mxLog.textarea.value='';});var h=(document.body.clientHeight||document.documentElement.clientHeight);var w=document.body.clientWidth;mxLog.window=new mxWindow(title,table,Math.max(0,w-320),Math.max(0,h-210),300,160);mxLog.window.setMaximizable(true);mxLog.window.setScrollable(false);mxLog.window.setResizable(true);mxLog.window.setClosable(true);mxLog.window.destroyOnClose=false;if((mxClient.IS_NS||mxClient.IS_IE)&&!mxClient.IS_GC&&!mxClient.IS_SF&&document.compatMode!='BackCompat'){var elt=mxLog.window.getElement();var resizeHandler=function(sender,evt){mxLog.textarea.style.height=Math.max(0,elt.offsetHeight-70)+'px';};mxLog.window.addListener(mxEvent.RESIZE_END,resizeHandler);mxLog.window.addListener(mxEvent.MAXIMIZE,resizeHandler);mxLog.window.addListener(mxEvent.NORMALIZE,resizeHandler);mxLog.textarea.style.height='92px';}}},info:function(){mxLog.writeln(mxUtils.toString(navigator));},addButton:function(lab,funct){var button=document.createElement('button');mxUtils.write(button,lab);mxEvent.addListener(button,'click',funct);mxLog.td.appendChild(button);},isVisible:function(){if(mxLog.window!=null){return mxLog.window.isVisible();}return false;},show:function(){mxLog.setVisible(true);},setVisible:function(visible){if(mxLog.window==null){mxLog.init();}if(mxLog.window!=null){mxLog.window.setVisible(visible);}},enter:function(string){if(mxLog.TRACE){mxLog.writeln('Entering '+string);return new Date().getTime();}},leave:function(string,t0){if(mxLog.TRACE){var dt=(t0!=0)?' ('+(new Date().getTime()-t0)+' ms)':'';mxLog.writeln('Leaving '+string+dt);}},debug:function(){if(mxLog.DEBUG){mxLog.writeln.apply(this,arguments);}},warn:function(){if(mxLog.WARN){mxLog.writeln.apply(this,arguments);}},write:function(){var string='';for(var i=0;i<arguments.length;i++){string+=arguments[i];if(i<arguments.length-1){string+=' ';}}if(mxLog.textarea!=null){mxLog.textarea.value=mxLog.textarea.value+string;if(navigator.userAgent.indexOf('Presto/2.5')>=0){mxLog.textarea.style.visibility='hidden';mxLog.textarea.style.visibility='visible';}mxLog.textarea.scrollTop=mxLog.textarea.scrollHeight;}else{mxLog.buffer+=string;}},writeln:function(){var string='';for(var i=0;i<arguments.length;i++){string+=arguments[i];if(i<arguments.length-1){string+=' ';}}mxLog.write(string+'\n');}};var mxObjectIdentity={FIELD_NAME:'mxObjectId',counter:0,get:function(obj){if(typeof(obj)=='object'&&obj[mxObjectIdentity.FIELD_NAME]==null){var ctor=mxUtils.getFunctionName(obj.constructor);obj[mxObjectIdentity.FIELD_NAME]=ctor+'#'+mxObjectIdentity.counter++;}return obj[mxObjectIdentity.FIELD_NAME];},clear:function(obj){if(typeof(obj)=='object'){delete obj[mxObjectIdentity.FIELD_NAME];}}};function mxDictionary(){this.clear();};mxDictionary.prototype.map=null;mxDictionary.prototype.clear=function(){this.map={};};mxDictionary.prototype.get=function(key){var id=mxObjectIdentity.get(key);return this.map[id];};mxDictionary.prototype.put=function(key,value){var id=mxObjectIdentity.get(key);var previous=this.map[id];this.map[id]=value;return previous;};mxDictionary.prototype.remove=function(key){var id=mxObjectIdentity.get(key);var previous=this.map[id];delete this.map[id];return previous;};mxDictionary.prototype.getKeys=function(){var result=[];for(var key in this.map){result.push(key);}return result;};mxDictionary.prototype.getValues=function(){var result=[];for(var key in this.map){result.push(this.map[key]);}return result;};mxDictionary.prototype.visit=function(visitor){for(var key in this.map){visitor(key,this.map[key]);}};var mxResources={resources:[],loadDefaultBundle:true,loadSpecialBundle:true,isLanguageSupported:function(lan){if(mxClient.languages!=null){return mxUtils.indexOf(mxClient.languages,lan)>=0;}return true;},getDefaultBundle:function(basename,lan){if(mxResources.loadDefaultBundle||!mxResources.isLanguageSupported(lan)){return basename+'.properties';}else{return null;}},getSpecialBundle:function(basename,lan){if(mxResources.loadSpecialBundle&&lan!=mxClient.defaultLanguage){return basename+'_'+lan+'.properties';}else{return null;}},add:function(basename,lan){lan=(lan!=null)?lan:mxClient.language;if(lan!=mxConstants.NONE){var defaultBundle=mxResources.getDefaultBundle(basename,lan);if(defaultBundle!=null){try{var req=mxUtils.load(defaultBundle);if(req.isReady()){mxResources.parse(req.getText());}}catch(e){}}if(mxResources.isLanguageSupported(lan)){var specialBundle=mxResources.getSpecialBundle(basename,lan);if(specialBundle!=null){try{var req=mxUtils.load(specialBundle);if(req.isReady()){mxResources.parse(req.getText());}}catch(e){}}}}},parse:function(text){if(text!=null){var lines=text.split('\n');for(var i=0;i<lines.length;i++){var index=lines[i].indexOf('=');if(index>0){var key=lines[i].substring(0,index);var idx=lines[i].length;if(lines[i].charCodeAt(idx-1)==13){idx--;}var value=lines[i].substring(index+1,idx);mxResources.resources[key]=unescape(value);}}}},get:function(key,params,defaultValue){var value=mxResources.resources[key];if(value==null){value=defaultValue;}if(value!=null&&params!=null){var result=[];var index=null;for(var i=0;i<value.length;i++){var c=value.charAt(i);if(c=='{'){index='';}else if(index!=null&&c=='}'){index=parseInt(index)-1;if(index>=0&&index<params.length){result.push(params[index]);}index=null;}else if(index!=null){index+=c;}else{result.push(c);}}value=result.join('');}return value;}};function mxPoint(x,y){this.x=(x!=null)?x:0;this.y=(y!=null)?y:0;};mxPoint.prototype.x=null;mxPoint.prototype.y=null;mxPoint.prototype.equals=function(obj){return obj.x==this.x&&obj.y==this.y;};mxPoint.prototype.clone=function(){return mxUtils.clone(this);};function mxRectangle(x,y,width,height){mxPoint.call(this,x,y);this.width=(width!=null)?width:0;this.height=(height!=null)?height:0;};mxRectangle.prototype=new mxPoint();mxRectangle.prototype.constructor=mxRectangle;mxRectangle.prototype.width=null;mxRectangle.prototype.height=null;mxRectangle.prototype.setRect=function(x,y,w,h){this.x=x;this.y=y;this.width=w;this.height=h;};mxRectangle.prototype.getCenterX=function(){return this.x+this.width/2;};mxRectangle.prototype.getCenterY=function(){return this.y+this.height/2;};mxRectangle.prototype.add=function(rect){if(rect!=null){var minX=Math.min(this.x,rect.x);var minY=Math.min(this.y,rect.y);var maxX=Math.max(this.x+this.width,rect.x+rect.width);var maxY=Math.max(this.y+this.height,rect.y+rect.height);this.x=minX;this.y=minY;this.width=maxX-minX;this.height=maxY-minY;}};mxRectangle.prototype.grow=function(amount){this.x-=amount;this.y-=amount;this.width+=2*amount;this.height+=2*amount;};mxRectangle.prototype.getPoint=function(){return new mxPoint(this.x,this.y);};mxRectangle.prototype.equals=function(obj){return obj.x==this.x&&obj.y==this.y&&obj.width==this.width&&obj.height==this.height;};var mxEffects={animateChanges:function(graph,changes,done){var maxStep=10;var step=0;var animate=function(){var isRequired=false;for(var i=0;i<changes.length;i++){var change=changes[i];if(change instanceof mxGeometryChange||change instanceof mxTerminalChange||change instanceof mxValueChange||change instanceof mxChildChange||change instanceof mxStyleChange){var state=graph.getView().getState(change.cell||change.child,false);if(state!=null){isRequired=true;if(change.constructor!=mxGeometryChange||graph.model.isEdge(change.cell)){mxUtils.setOpacity(state.shape.node,100*step/maxStep);}else{var scale=graph.getView().scale;var dx=(change.geometry.x-change.previous.x)*scale;var dy=(change.geometry.y-change.previous.y)*scale;var sx=(change.geometry.width-change.previous.width)*scale;var sy=(change.geometry.height-change.previous.height)*scale;if(step==0){state.x-=dx;state.y-=dy;state.width-=sx;state.height-=sy;}else{state.x+=dx/maxStep;state.y+=dy/maxStep;state.width+=sx/maxStep;state.height+=sy/maxStep;}graph.cellRenderer.redraw(state);mxEffects.cascadeOpacity(graph,change.cell,100*step/maxStep);}}}}mxUtils.repaintGraph(graph,new mxPoint(1,1));if(step<maxStep&&isRequired){step++;window.setTimeout(animate, delay);}else if(done!=null){done();}};var delay=30;animate();},cascadeOpacity:function(graph,cell,opacity){var childCount=graph.model.getChildCount(cell);for(var i=0;i<childCount;i++){var child=graph.model.getChildAt(cell,i);var childState=graph.getView().getState(child);if(childState!=null){mxUtils.setOpacity(childState.shape.node,opacity);mxEffects.cascadeOpacity(graph,child,opacity);}}var edges=graph.model.getEdges(cell);if(edges!=null){for(var i=0;i<edges.length;i++){var edgeState=graph.getView().getState(edges[i]);if(edgeState!=null){mxUtils.setOpacity(edgeState.shape.node,opacity);}}}},fadeOut:function(node,from,remove,step,delay,isEnabled){step=step||40;delay=delay||30;var opacity=from||100;mxUtils.setOpacity(node,opacity);if(isEnabled||isEnabled==null){var f=function(){opacity=Math.max(opacity-step,0);mxUtils.setOpacity(node,opacity);if(opacity>0){window.setTimeout(f, delay);}else{node.style.visibility='hidden';if(remove&&node.parentNode){node.parentNode.removeChild(node);}}};window.setTimeout(f, delay);}else{node.style.visibility='hidden';if(remove&&node.parentNode){node.parentNode.removeChild(node);}}}};var mxUtils={errorResource:(mxClient.language!='none')?'error':'',closeResource:(mxClient.language!='none')?'close':'',errorImage:mxClient.imageBasePath+'/error.gif',removeCursors:function(element){if(element.style!=null){element.style.cursor='';}var children=element.childNodes;if(children!=null){var childCount=children.length;for(var i=0;i<childCount;i+=1){mxUtils.removeCursors(children[i]);}}},repaintGraph:function(graph,pt){if(mxClient.IS_GC||mxClient.IS_SF||mxClient.IS_OP){var c=graph.container;if(c!=null&&pt!=null&&(c.scrollLeft>0||c.scrollTop>0)){var dummy=document.createElement('div');dummy.style.position='absolute';dummy.style.left=pt.x+'px';dummy.style.top=pt.y+'px';dummy.style.width='1px';dummy.style.height='1px';c.appendChild(dummy);c.removeChild(dummy);}}},getCurrentStyle:function(){if(mxClient.IS_IE){return function(element){return(element!=null)?element.currentStyle:null;};}else{return function(element){return(element!=null)?window.getComputedStyle(element,''):null;};}}(),hasScrollbars:function(node){var style=mxUtils.getCurrentStyle(node);return style!=null&&(style.overflow=='scroll'||style.overflow=='auto');},bind:function(scope,funct){return function(){return funct.apply(scope,arguments);};},eval:function(expr){var result=null;if(expr.indexOf('function')>=0){try{eval('var _mxJavaScriptExpression='+expr);result=_mxJavaScriptExpression;_mxJavaScriptExpression=null;}catch(e){mxLog.warn(e.message+' while evaluating '+expr);}}else{try{result=eval(expr);}catch(e){mxLog.warn(e.message+' while evaluating '+expr);}}return result;},findNode:function(node,attr,value){var tmp=node.getAttribute(attr);if(tmp!=null&&tmp==value){return node;}node=node.firstChild;while(node!=null){var result=mxUtils.findNode(node,attr,value);if(result!=null){return result;}node=node.nextSibling;}return null;},findNodeByAttribute:function(){if(document.documentMode>=9){return function(node,attr,value){var result=null;if(node.nodeType==mxConstants.NODETYPE_ELEMENT&&node.getAttribute(attr)==value){result=node;}else{var child=node.firstChild;while(child!=null&&result==null){result=mxUtils.findNodeByAttribute(child,attr,value);child=child.nextSibling;}}return result;};}else if(mxClient.IS_IE){return function(node,attr,value){var expr='//*[@'+attr+'=\''+value+'\']';return node.ownerDocument.selectSingleNode(expr);};}else{return function(node,attr,value){var result=node.ownerDocument.evaluate('//*[@'+attr+'=\''+value+'\']',node.ownerDocument,null,XPathResult.ANY_TYPE,null);return result.iterateNext();};}}(),getFunctionName:function(f){var str=null;if(f!=null){if(f.name!=null){str=f.name;}else{var tmp=f.toString();var idx1=9;while(tmp.charAt(idx1)==' '){idx1++;}var idx2=tmp.indexOf('(',idx1);str=tmp.substring(idx1,idx2);}}return str;},indexOf:function(array,obj){if(array!=null&&obj!=null){for(var i=0;i<array.length;i++){if(array[i]==obj){return i;}}}return-1;},remove:function(obj,array){var result=null;if(typeof(array)=='object'){var index=mxUtils.indexOf(array,obj);while(index>=0){array.splice(index,1);result=obj;index=mxUtils.indexOf(array,obj);}}for(var key in array){if(array[key]==obj){delete array[key];result=obj;}}return result;},isNode:function(value,nodeName,attributeName,attributeValue){if(value!=null&&!isNaN(value.nodeType)&&(nodeName==null||value.nodeName.toLowerCase()==nodeName.toLowerCase())){return attributeName==null||value.getAttribute(attributeName)==attributeValue;}return false;},getChildNodes:function(node,nodeType){nodeType=nodeType||mxConstants.NODETYPE_ELEMENT;var children=[];var tmp=node.firstChild;while(tmp!=null){if(tmp.nodeType==nodeType){children.push(tmp);}tmp=tmp.nextSibling;}return children;},createXmlDocument:function(){var doc=null;if(document.implementation&&document.implementation.createDocument){doc=document.implementation.createDocument('','',null);}else if(window.ActiveXObject){doc=new ActiveXObject('Microsoft.XMLDOM');}return doc;},parseXml:function(){if(mxClient.IS_IE&&(typeof(document.documentMode)==='undefined'||document.documentMode<9)){return function(xml){var result=mxUtils.createXmlDocument();result.async='false';result.loadXML(xml);return result;};}else{return function(xml){var parser=new DOMParser();return parser.parseFromString(xml,'text/xml');};}}(),clearSelection:function(){if(document.selection){return function(){document.selection.empty();};}else if(window.getSelection){return function(){window.getSelection().removeAllRanges();};}}(),getPrettyXml:function(node,tab,indent){var result=[];if(node!=null){tab=tab||'  ';indent=indent||'';if(node.nodeType==mxConstants.NODETYPE_TEXT){result.push(node.nodeValue);}else{result.push(indent+'<'+node.nodeName);var attrs=node.attributes;if(attrs!=null){for(var i=0;i<attrs.length;i++){var val=mxUtils.htmlEntities(attrs[i].nodeValue);result.push(' '+attrs[i].nodeName+'="'+val+'"');}}var tmp=node.firstChild;if(tmp!=null){result.push('>\n');while(tmp!=null){result.push(mxUtils.getPrettyXml(tmp,tab,indent+tab));tmp=tmp.nextSibling;}result.push(indent+'</'+node.nodeName+'>\n');}else{result.push('/>\n');}}}return result.join('');},removeWhitespace:function(node,before){var tmp=(before)?node.previousSibling:node.nextSibling;while(tmp!=null&&tmp.nodeType==mxConstants.NODETYPE_TEXT){var next=(before)?tmp.previousSibling:tmp.nextSibling;var text=mxUtils.getTextContent(tmp);if(mxUtils.trim(text).length==0){tmp.parentNode.removeChild(tmp);}tmp=next;}},htmlEntities:function(s,newline){s=s||'';s=s.replace(/&/g,'&amp;');s=s.replace(/"/g,'&quot;');s=s.replace(/\'/g,'&#39;');s=s.replace(/</g,'&lt;');s=s.replace(/>/g,'&gt;');if(newline==null||newline){s=s.replace(/\n/g,'&#xa;');}return s;},isVml:function(node){return node!=null&&node.tagUrn=='urn:schemas-microsoft-com:vml';},getXml:function(node,linefeed){var xml='';if(node!=null){xml=node.xml;if(xml==null){if(node.innerHTML){xml=node.innerHTML;}else{var xmlSerializer=new XMLSerializer();xml=xmlSerializer.serializeToString(node);}}else{xml=xml.replace(/\r\n\t[\t]*/g,'').replace(/>\r\n/g,'>').replace(/\r\n/g,'\n');}}linefeed=linefeed||'&#xa;';xml=xml.replace(/\n/g,linefeed);return xml;},getTextContent:function(node){var result='';if(node!=null){if(node.firstChild!=null){node=node.firstChild;}result=node.nodeValue||'';}return result;},getInnerHtml:function(){if(mxClient.IS_IE){return function(node){if(node!=null){return node.innerHTML;}return '';};}else{return function(node){if(node!=null){var serializer=new XMLSerializer();return serializer.serializeToString(node);}return '';};}}(),getOuterHtml:function(){if(mxClient.IS_IE){return function(node){if(node!=null){if(node.outerHTML!=null){return node.outerHTML;}else{var tmp=[];tmp.push('<'+node.nodeName);var attrs=node.attributes;if(attrs!=null){for(var i=0;i<attrs.length;i++){var value=attrs[i].nodeValue;if(value!=null&&value.length>0){tmp.push(' ');tmp.push(attrs[i].nodeName);tmp.push('="');tmp.push(value);tmp.push('"');}}}if(node.innerHTML.length==0){tmp.push('/>');}else{tmp.push('>');tmp.push(node.innerHTML);tmp.push('</'+node.nodeName+'>');}return tmp.join('');}}return '';};}else{return function(node){if(node!=null){var serializer=new XMLSerializer();return serializer.serializeToString(node);}return '';};}}(),write:function(parent,text){doc=parent.ownerDocument;var node=doc.createTextNode(text);if(parent!=null){parent.appendChild(node);}return node;},writeln:function(parent,text){doc=parent.ownerDocument;var node=doc.createTextNode(text);if(parent!=null){parent.appendChild(node);parent.appendChild(document.createElement('br'));}return node;},br:function(parent,count){count=count||1;var br=null;for(var i=0;i<count;i++){if(parent!=null){br=parent.ownerDocument.createElement('br');parent.appendChild(br);}}return br;},button:function(label,funct,doc){doc=(doc!=null)?doc:document;var button=doc.createElement('button');mxUtils.write(button,label);mxEvent.addListener(button,'click',function(evt){funct(evt);});return button;},para:function(parent,text){var p=document.createElement('p');mxUtils.write(p,text);if(parent!=null){parent.appendChild(p);}return p;},linkAction:function(parent,text,editor,action,pad){return mxUtils.link(parent,text,function(){editor.execute(action);},pad);},linkInvoke:function(parent,text,editor,functName,arg,pad){return mxUtils.link(parent,text,function(){editor[functName](arg);},pad);},link:function(parent,text,funct,pad){var a=document.createElement('span');a.style.color='blue';a.style.textDecoration='underline';a.style.cursor='pointer';if(pad!=null){a.style.paddingLeft=pad+'px';}mxEvent.addListener(a,'click',funct);mxUtils.write(a,text);if(parent!=null){parent.appendChild(a);}return a;},fit:function(node){var left=parseInt(node.offsetLeft);var width=parseInt(node.offsetWidth);var b=document.body;var d=document.documentElement;var right=(b.scrollLeft||d.scrollLeft)+(b.clientWidth||d.clientWidth);if(left+width>right){node.style.left=Math.max((b.scrollLeft||d.scrollLeft),right-width)+'px';}var top=parseInt(node.offsetTop);var height=parseInt(node.offsetHeight);var bottom=(b.scrollTop||d.scrollTop)+Math.max(b.clientHeight||0,d.clientHeight);if(top+height>bottom){node.style.top=Math.max((b.scrollTop||d.scrollTop),bottom-height)+'px';}},open:function(filename){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');}catch(e){mxUtils.alert('Permission to read file denied.');return '';}var file=Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);file.initWithPath(filename);if(!file.exists()){mxUtils.alert('File not found.');return '';}var is=Components.classes['@mozilla.org/network/file-input-stream;1'].createInstance(Components.interfaces.nsIFileInputStream);is.init(file,0x01,00004,null);var sis=Components.classes['@mozilla.org/scriptableinputstream;1'].createInstance(Components.interfaces.nsIScriptableInputStream);sis.init(is);var output=sis.read(sis.available());return output;}else{var activeXObject=new ActiveXObject('Scripting.FileSystemObject');var newStream=activeXObject.OpenTextFile(filename,1);var text=newStream.readAll();newStream.close();return text;}return null;},save:function(filename,content){if(mxClient.IS_NS){try{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');}catch(e){mxUtils.alert('Permission to write file denied.');return;}var file=Components.classes['@mozilla.org/file/local;1'].createInstance(Components.interfaces.nsILocalFile);file.initWithPath(filename);if(!file.exists()){file.create(0x00,0644);}var outputStream=Components.classes['@mozilla.org/network/file-output-stream;1'].createInstance(Components.interfaces.nsIFileOutputStream);outputStream.init(file,0x20|0x02,00004,null);outputStream.write(content,content.length);outputStream.flush();outputStream.close();}else{var fso=new ActiveXObject('Scripting.FileSystemObject');var file=fso.CreateTextFile(filename,true);file.Write(content);file.Close();}},saveAs:function(content){var iframe=document.createElement('iframe');iframe.setAttribute('src','');iframe.style.visibility='hidden';document.body.appendChild(iframe);try{if(mxClient.IS_NS){var doc=iframe.contentDocument;doc.open();doc.write(content);doc.close();try{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');iframe.focus();saveDocument(doc);}catch(e){mxUtils.alert('Permission to save document denied.');}}else{var doc=iframe.contentWindow.document;doc.write(content);doc.execCommand('SaveAs',false,document.location);}}finally{document.body.removeChild(iframe);}},copy:function(content){if(window.clipboardData){window.clipboardData.setData('Text',content);}else{netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');var clip=Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);if(!clip){return;}var trans=Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);if(!trans){return;}trans.addDataFlavor('text/unicode');var str=Components.classes['@mozilla.org/supports-string;1'].createInstance(Components.interfaces.nsISupportsString);var copytext=content;str.data=copytext;trans.setTransferData('text/unicode',str,copytext.length*2);var clipid=Components.interfaces.nsIClipboard;clip.setData(trans,null,clipid.kGlobalClipboard);}},load:function(url){var req=new mxXmlRequest(url,null,'GET',false);req.send();return req;},get:function(url,onload,onerror){return new mxXmlRequest(url,null,'GET').send(onload,onerror);},post:function(url,params,onload,onerror){return new mxXmlRequest(url,params).send(onload,onerror);},submit:function(url,params,doc,target){return new mxXmlRequest(url,params).simulate(doc,target);},loadInto:function(url,doc,onload){if(mxClient.IS_IE){doc.onreadystatechange=function(){if(doc.readyState==4){onload();}};}else{doc.addEventListener('load',onload,false);}doc.load(url);},getValue:function(array,key,defaultValue){var value=(array!=null)?array[key]:null;if(value==null){value=defaultValue;}return value;},getNumber:function(array,key,defaultValue){var value=(array!=null)?array[key]:null;if(value==null){value=defaultValue||0;}return Number(value);},getColor:function(array,key,defaultValue){var value=(array!=null)?array[key]:null;if(value==null){value=defaultValue;}else if(value==mxConstants.NONE){value=null;}return value;},clone:function(obj,transients,shallow){shallow=(shallow!=null)?shallow:false;var clone=null;if(obj!=null&&typeof(obj.constructor)=='function'){clone=new obj.constructor();for(var i in obj){if(i!=mxObjectIdentity.FIELD_NAME&&(transients==null||mxUtils.indexOf(transients,i)<0)){if(!shallow&&typeof(obj[i])=='object'){clone[i]=mxUtils.clone(obj[i]);}else{clone[i]=obj[i];}}}}return clone;},equalPoints:function(a,b){if((a==null&&b!=null)||(a!=null&&b==null)||(a!=null&&b!=null&&a.length!=b.length)){return false;}else if(a!=null&&b!=null){for(var i=0;i<a.length;i++){if(a[i]==b[i]||(a[i]!=null&&!a[i].equals(b[i]))){return false;}}}return true;},equalEntries:function(a,b){if((a==null&&b!=null)||(a!=null&&b==null)||(a!=null&&b!=null&&a.length!=b.length)){return false;}else if(a!=null&&b!=null){for(var key in a){if(a[key]!=b[key]){return false;}}}return true;},extend:function(ctor,superCtor){var f=function(){};f.prototype=superCtor.prototype;ctor.prototype=new f();ctor.prototype.constructor=ctor;},toString:function(obj){var output='';for(var i in obj){try{if(obj[i]==null){output+=i+' = [null]\n';}else if(typeof(obj[i])=='function'){output+=i+' => [Function]\n';}else if(typeof(obj[i])=='object'){var ctor=mxUtils.getFunctionName(obj[i].constructor);output+=i+' => ['+ctor+']\n';}else{output+=i+' = '+obj[i]+'\n';}}catch(e){output+=i+'='+e.message;}}return output;},toRadians:function(deg){return Math.PI*deg/180;},arcToCurves:function(x0,y0,r1,r2,angle,largeArcFlag,sweepFlag,x,y){x-=x0;y-=y0;if(r1===0||r2===0){return result;}var fS=sweepFlag;var psai=angle;r1=Math.abs(r1);r2=Math.abs(r2);var ctx=-x/2;var cty=-y/2;var cpsi=Math.cos(psai*Math.PI/180);var spsi=Math.sin(psai*Math.PI/180);var rxd=cpsi*ctx+spsi*cty;var ryd=-1*spsi*ctx+cpsi*cty;var rxdd=rxd*rxd;var rydd=ryd*ryd;var r1x=r1*r1;var r2y=r2*r2;var lamda=rxdd/r1x+rydd/r2y;var sds;if(lamda>1){r1=Math.sqrt(lamda)*r1;r2=Math.sqrt(lamda)*r2;sds=0;}else{var seif=1;if(largeArcFlag===fS){seif=-1;}sds=seif*Math.sqrt((r1x*r2y-r1x*rydd-r2y*rxdd)/(r1x*rydd+r2y*rxdd));}var txd=sds*r1*ryd/r2;var tyd=-1*sds*r2*rxd/r1;var tx=cpsi*txd-spsi*tyd+x/2;var ty=spsi*txd+cpsi*tyd+y/2;var rad=Math.atan2((ryd-tyd)/r2,(rxd-txd)/r1)-Math.atan2(0,1);var s1=(rad>=0)?rad:2*Math.PI+rad;rad=Math.atan2((-ryd-tyd)/r2,(-rxd-txd)/r1)-Math.atan2((ryd-tyd)/r2,(rxd-txd)/r1);var dr=(rad>=0)?rad:2*Math.PI+rad;if(fS==0&&dr>0){dr-=2*Math.PI;}else if(fS!=0&&dr<0){dr+=2*Math.PI;}var sse=dr*2/Math.PI;var seg=Math.ceil(sse<0?-1*sse:sse);var segr=dr/seg;var t=8/3*Math.sin(segr/4)*Math.sin(segr/4)/Math.sin(segr/2);var cpsir1=cpsi*r1;var cpsir2=cpsi*r2;var spsir1=spsi*r1;var spsir2=spsi*r2;var mc=Math.cos(s1);var ms=Math.sin(s1);var x2=-t*(cpsir1*ms+spsir2*mc);var y2=-t*(spsir1*ms-cpsir2*mc);var x3=0;var y3=0;var result=[];for(var n=0;n<seg;++n){s1+=segr;mc=Math.cos(s1);ms=Math.sin(s1);x3=cpsir1*mc-spsir2*ms+tx;y3=spsir1*mc+cpsir2*ms+ty;var dx=-t*(cpsir1*ms+spsir2*mc);var dy=-t*(spsir1*ms-cpsir2*mc);var index=n*6;result[index]=Number(x2+x0);result[index+1]=Number(y2+y0);result[index+2]=Number(x3-dx+x0);result[index+3]=Number(y3-dy+y0);result[index+4]=Number(x3+x0);result[index+5]=Number(y3+y0);x2=x3+dx;y2=y3+dy;}return result;},getBoundingBox:function(rect,rotation){var result=null;if(rect!=null&&rotation!=null&&rotation!=0){var rad=mxUtils.toRadians(rotation);var cos=Math.cos(rad);var sin=Math.sin(rad);var cx=new mxPoint(rect.x+rect.width/2,rect.y+rect.height/2);var p1=new mxPoint(rect.x,rect.y);var p2=new mxPoint(rect.x+rect.width,rect.y);var p3=new mxPoint(p2.x,rect.y+rect.height);var p4=new mxPoint(rect.x,p3.y);p1=mxUtils.getRotatedPoint(p1,cos,sin,cx);p2=mxUtils.getRotatedPoint(p2,cos,sin,cx);p3=mxUtils.getRotatedPoint(p3,cos,sin,cx);p4=mxUtils.getRotatedPoint(p4,cos,sin,cx);result=new mxRectangle(p1.x,p1.y,0,0);result.add(new mxRectangle(p2.x,p2.y,0,0));result.add(new mxRectangle(p3.x,p3.y,0,0));result.add(new mxRectangle(p4.x,p4.Y,0,0));}return result;},getRotatedPoint:function(pt,cos,sin,c){c=(c!=null)?c:new mxPoint();var x=pt.x-c.x;var y=pt.y-c.y;var x1=x*cos-y*sin;var y1=y*cos+x*sin;return new mxPoint(x1+c.x,y1+c.y);},getPortConstraints:function(terminal,edge,source,defaultValue){var value=mxUtils.getValue(terminal.style,mxConstants.STYLE_PORT_CONSTRAINT,null);if(value==null){return defaultValue;}else{var directions=value.toString();var returnValue=mxConstants.DIRECTION_MASK_NONE;if(directions.indexOf(mxConstants.DIRECTION_NORTH)>=0){returnValue|=mxConstants.DIRECTION_MASK_NORTH;}if(directions.indexOf(mxConstants.DIRECTION_WEST)>=0){returnValue|=mxConstants.DIRECTION_MASK_WEST;}if(directions.indexOf(mxConstants.DIRECTION_SOUTH)>=0){returnValue|=mxConstants.DIRECTION_MASK_SOUTH;}if(directions.indexOf(mxConstants.DIRECTION_EAST)>=0){returnValue|=mxConstants.DIRECTION_MASK_EAST;}return returnValue;}},reversePortConstraints:function(constraint){var result=0;result=(constraint&mxConstants.DIRECTION_MASK_WEST)<<3;result|=(constraint&mxConstants.DIRECTION_MASK_NORTH)<<1;result|=(constraint&mxConstants.DIRECTION_MASK_SOUTH)>>1;result|=(constraint&mxConstants.DIRECTION_MASK_EAST)>>3;return result;},findNearestSegment:function(state,x,y){var index=-1;if(state.absolutePoints.length>0){var last=state.absolutePoints[0];var min=null;for(var i=1;i<state.absolutePoints.length;i++){var current=state.absolutePoints[i];var dist=mxUtils.ptSegDistSq(last.x,last.y,current.x,current.y,x,y);if(min==null||dist<min){min=dist;index=i-1;}last=current;}}return index;},rectangleIntersectsSegment:function(bounds,p1,p2){var top=bounds.y;var left=bounds.x;var bottom=top+bounds.height;var right=left+bounds.width;var minX=p1.x;var maxX=p2.x;if(p1.x>p2.x){minX=p2.x;maxX=p1.x;}if(maxX>right){maxX=right;}if(minX<left){minX=left;}if(minX>maxX) {return false;}var minY=p1.y;var maxY=p2.y;var dx=p2.x-p1.x;if(Math.abs(dx)>0.0000001){var a=(p2.y-p1.y)/dx;var b=p1.y-a*p1.x;minY=a*minX+b;maxY=a*maxX+b;}if(minY>maxY){var tmp=maxY;maxY=minY;minY=tmp;}if(maxY>bottom){maxY=bottom;}if(minY<top){minY=top;}if(minY>maxY) {return false;}return true;},contains:function(bounds,x,y){return(bounds.x<=x&&bounds.x+bounds.width>=x&&bounds.y<=y&&bounds.y+bounds.height>=y);},intersects:function(a,b){var tw=a.width;var th=a.height;var rw=b.width;var rh=b.height;if(rw<=0||rh<=0||tw<=0||th<=0){return false;}var tx=a.x;var ty=a.y;var rx=b.x;var ry=b.y;rw+=rx;rh+=ry;tw+=tx;th+=ty;return((rw<rx||rw>tx)&&(rh<ry||rh>ty)&&(tw<tx||tw>rx)&&(th<ty||th>ry));},intersectsHotspot:function(state,x,y,hotspot,min,max){hotspot=(hotspot!=null)?hotspot:1;min=(min!=null)?min:0;max=(max!=null)?max:0;if(hotspot>0){var cx=state.getCenterX();var cy=state.getCenterY();var w=state.width;var h=state.height;var start=mxUtils.getValue(state.style,mxConstants.STYLE_STARTSIZE);if(start>0){if(mxUtils.getValue(state.style,mxConstants.STYLE_HORIZONTAL,true)){cy=state.y+start/2;h=start;}else{cx=state.x+start/2;w=start;}}w=Math.max(min,w*hotspot);h=Math.max(min,h*hotspot);if(max>0){w=Math.min(w,max);h=Math.min(h,max);}var rect=new mxRectangle(cx-w/2,cy-h/2,w,h);return mxUtils.contains(rect,x,y);}return true;},getOffset:function(container){var offsetLeft=0;var offsetTop=0;while(container.offsetParent){offsetLeft+=container.offsetLeft;offsetTop+=container.offsetTop;container=container.offsetParent;}return new mxPoint(offsetLeft,offsetTop);},getScrollOrigin:function(node){var b=document.body;var d=document.documentElement;var sl=(b.scrollLeft||d.scrollLeft);var st=(b.scrollTop||d.scrollTop);var result=new mxPoint(sl,st);while(node!=null&&node!=b&&node!=d){if(!isNaN(node.scrollLeft)&&!isNaN(node.scrollTop)){result.x+=node.scrollLeft;result.y+=node.scrollTop;}node=node.parentNode;}return result;},convertPoint:function(container,x,y){var origin=mxUtils.getScrollOrigin(container);var offset=mxUtils.getOffset(container);offset.x-=origin.x;offset.y-=origin.y;return new mxPoint(x-offset.x,y-offset.y);},ltrim:function(str,chars){chars=chars||"\\s";return str.replace(new RegExp("^["+chars+"]+","g"),"");},rtrim:function(str,chars){chars=chars||"\\s";return str.replace(new RegExp("["+chars+"]+$","g"),"");},trim:function(str,chars){return mxUtils.ltrim(mxUtils.rtrim(str,chars),chars);},isNumeric:function(str){return str!=null&&(str.length==null||(str.length>0&&str.indexOf('0x')<0)&&str.indexOf('0X')<0)&&!isNaN(str);},mod:function(n,m){return((n%m)+m)%m;},intersection:function(x0,y0,x1,y1,x2,y2,x3,y3){var denom=((y3-y2)*(x1-x0))-((x3-x2)*(y1-y0));var nume_a=((x3-x2)*(y0-y2))-((y3-y2)*(x0-x2));var nume_b=((x1-x0)*(y0-y2))-((y1-y0)*(x0-x2));var ua=nume_a/denom;var ub=nume_b/denom;if(ua>=0.0&&ua<=1.0&&ub>=0.0&&ub<=1.0){var intersectionX=x0+ua*(x1-x0);var intersectionY=y0+ua*(y1-y0);return new mxPoint(intersectionX,intersectionY);}return null;},ptSegDistSq:function(x1,y1,x2,y2,px,py){x2-=x1;y2-=y1;px-=x1;py-=y1;var dotprod=px*x2+py*y2;var projlenSq;if(dotprod<=0.0){projlenSq=0.0;}else{px=x2-px;py=y2-py;dotprod=px*x2+py*y2;if(dotprod<=0.0){projlenSq=0.0;}else{projlenSq=dotprod*dotprod/(x2*x2+y2*y2);}}var lenSq=px*px+py*py-projlenSq;if(lenSq<0){lenSq=0;}return lenSq;},relativeCcw:function(x1,y1,x2,y2,px,py){x2-=x1;y2-=y1;px-=x1;py-=y1;var ccw=px*y2-py*x2;if(ccw==0.0){ccw=px*x2+py*y2;if(ccw>0.0){px-=x2;py-=y2;ccw=px*x2+py*y2;if(ccw<0.0){ccw=0.0;}}}return(ccw<0.0)?-1:((ccw>0.0)?1:0);},animateChanges:function(graph,changes){mxEffects.animateChanges.apply(this,arguments);},cascadeOpacity:function(graph,cell,opacity){mxEffects.cascadeOpacity.apply(this,arguments);},fadeOut:function(node,from,remove,step,delay,isEnabled){mxEffects.fadeOut.apply(this,arguments);},setOpacity:function(node,value){if(mxUtils.isVml(node)){if(value>=100){node.style.filter=null;}else{node.style.filter='alpha(opacity='+(value/5)+')';}}else if(mxClient.IS_IE&&(typeof(document.documentMode)==='undefined'||document.documentMode<9)){if(value>=100){node.style.filter=null;}else{node.style.filter='alpha(opacity='+value+')';}}else{node.style.opacity=(value/100);}},createImage:function(src){var imageNode=null;if(mxClient.IS_IE6&&document.compatMode!='CSS1Compat'){imageNode=document.createElement('v:image');imageNode.setAttribute('src',src);imageNode.style.borderStyle='none';}else{imageNode=document.createElement('img');imageNode.setAttribute('src',src);imageNode.setAttribute('border','0');}return imageNode;},sortCells:function(cells,ascending){ascending=(ascending!=null)?ascending:true;var lookup=new mxDictionary();cells.sort(function(o1,o2){var p1=lookup.get(o1);if(p1==null){p1=mxCellPath.create(o1).split(mxCellPath.PATH_SEPARATOR);lookup.put(o1,p1);}var p2=lookup.get(o2);if(p2==null){p2=mxCellPath.create(o2).split(mxCellPath.PATH_SEPARATOR);lookup.put(o2,p2);}var comp=mxCellPath.compare(p1,p2);return(comp==0)?0:(((comp>0)==ascending)?1:-1);});return cells;},getStylename:function(style){if(style!=null){var pairs=style.split(';');var stylename=pairs[0];if(stylename.indexOf('=')<0){return stylename;}}return '';},getStylenames:function(style){var result=[];if(style!=null){var pairs=style.split(';');for(var i=0;i<pairs.length;i++){if(pairs[i].indexOf('=')<0){result.push(pairs[i]);}}}return result;},indexOfStylename:function(style,stylename){if(style!=null&&stylename!=null){var tokens=style.split(';');var pos=0;for(var i=0;i<tokens.length;i++){if(tokens[i]==stylename){return pos;}pos+=tokens[i].length+1;}}return-1;},addStylename:function(style,stylename){if(mxUtils.indexOfStylename(style,stylename)<0){if(style==null){style='';}else if(style.length>0&&style.charAt(style.length-1)!=';'){style+=';';}style+=stylename;}return style;},removeStylename:function(style,stylename){var result=[];if(style!=null){var tokens=style.split(';');for(var i=0;i<tokens.length;i++){if(tokens[i]!=stylename){result.push(tokens[i]);}}}return result.join(';');},removeAllStylenames:function(style){var result=[];if(style!=null){var tokens=style.split(';');for(var i=0;i<tokens.length;i++){if(tokens[i].indexOf('=')>=0){result.push(tokens[i]);}}}return result.join(';');},setCellStyles:function(model,cells,key,value){if(cells!=null&&cells.length>0){model.beginUpdate();try{for(var i=0;i<cells.length;i++){if(cells[i]!=null){var style=mxUtils.setStyle(model.getStyle(cells[i]),key,value);model.setStyle(cells[i],style);}}}finally{model.endUpdate();}}},setStyle:function(style,key,value){var isValue=value!=null&&(typeof(value.length)=='undefined'||value.length>0);if(style==null||style.length==0){if(isValue){style=key+'='+value;}}else{var index=style.indexOf(key+'=');if(index<0){if(isValue){var sep=(style.charAt(style.length-1)==';')?'':';';style=style+sep+key+'='+value;}}else{var tmp=(isValue)?(key+'='+value):'';var cont=style.indexOf(';',index);if(!isValue){cont++;}style=style.substring(0,index)+tmp+((cont>index)?style.substring(cont):'');}}return style;},setCellStyleFlags:function(model,cells,key,flag,value){if(cells!=null&&cells.length>0){model.beginUpdate();try{for(var i=0;i<cells.length;i++){if(cells[i]!=null){var style=mxUtils.setStyleFlag(model.getStyle(cells[i]),key,flag,value);model.setStyle(cells[i],style);}}}finally{model.endUpdate();}}},setStyleFlag:function(style,key,flag,value){if(style==null||style.length==0){if(value||value==null){style=key+'='+flag;}else{style=key+'=0';}}else{var index=style.indexOf(key+'=');if(index<0){var sep=(style.charAt(style.length-1)==';')?'':';';if(value||value==null){style=style+sep+key+'='+flag;}else{style=style+sep+key+'=0';}}else{var cont=style.indexOf(';',index);var tmp='';if(cont<0){tmp=style.substring(index+key.length+1);}else{tmp=style.substring(index+key.length+1,cont);}if(value==null){tmp=parseInt(tmp)^flag;}else if(value){tmp=parseInt(tmp)|flag;}else{tmp=parseInt(tmp)&~flag;}style=style.substring(0,index)+key+'='+tmp+((cont>=0)?style.substring(cont):'');}}return style;},getSizeForString:function(text,fontSize,fontFamily){var div=document.createElement('div');div.style.fontSize=fontSize||mxConstants.DEFAULT_FONTSIZE;div.style.fontFamily=fontFamily||mxConstants.DEFAULT_FONTFAMILY;div.style.position='absolute';div.style.display='inline';div.style.visibility='hidden';div.innerHTML=text;document.body.appendChild(div);var size=new mxRectangle(0,0,div.offsetWidth,div.offsetHeight);document.body.removeChild(div);return size;},getViewXml:function(graph,scale,cells,x0,y0){x0=(x0!=null)?x0:0;y0=(y0!=null)?y0:0;scale=(scale!=null)?scale:1;if(cells==null){var model=graph.getModel();cells=[model.getRoot()];}var view=graph.getView();var result=null;var eventsEnabled=view.isEventsEnabled();view.setEventsEnabled(false);var drawPane=view.drawPane;var overlayPane=view.overlayPane;if(graph.dialect==mxConstants.DIALECT_SVG){view.drawPane=document.createElementNS(mxConstants.NS_SVG,'g');view.canvas.appendChild(view.drawPane);view.overlayPane=document.createElementNS(mxConstants.NS_SVG,'g');view.canvas.appendChild(view.overlayPane);}else{view.drawPane=view.drawPane.cloneNode(false);view.canvas.appendChild(view.drawPane);view.overlayPane=view.overlayPane.cloneNode(false);view.canvas.appendChild(view.overlayPane);}var translate=view.getTranslate();view.translate=new mxPoint(x0,y0);var temp=new mxTemporaryCellStates(graph.getView(),scale,cells);try{var enc=new mxCodec();result=enc.encode(graph.getView());}finally{temp.destroy();view.translate=translate;view.canvas.removeChild(view.drawPane);view.canvas.removeChild(view.overlayPane);view.drawPane=drawPane;view.overlayPane=overlayPane;view.setEventsEnabled(eventsEnabled);}return result;},getScaleForPageCount:function(pageCount,graph,pageFormat,border){if(pageCount<1){return 1;}pageFormat=(pageFormat!=null)?pageFormat:mxConstants.PAGE_FORMAT_A4_PORTRAIT;border=(border!=null)?border:0;var availablePageWidth=pageFormat.width-(border*2);var availablePageHeight=pageFormat.height-(border*2);var graphBounds=graph.getGraphBounds().clone();var sc=graph.getView().getScale();graphBounds.width/=sc;graphBounds.height/=sc;var graphWidth=graphBounds.width;var graphHeight=graphBounds.height;var scale=1;var pageFormatAspectRatio=availablePageWidth/availablePageHeight;var graphAspectRatio=graphWidth/graphHeight;var pagesAspectRatio=graphAspectRatio/pageFormatAspectRatio;var pageRoot=Math.sqrt(pageCount);var pagesAspectRatioSqrt=Math.sqrt(pagesAspectRatio);var numRowPages=pageRoot*pagesAspectRatioSqrt;var numColumnPages=pageRoot/pagesAspectRatioSqrt;if(numRowPages<1&&numColumnPages>pageCount){var scaleChange=numColumnPages/pageCount;numColumnPages=pageCount;numRowPages/=scaleChange;}if(numColumnPages<1&&numRowPages>pageCount){var scaleChange=numRowPages/pageCount;numRowPages=pageCount;numColumnPages/=scaleChange;}var currentTotalPages=Math.ceil(numRowPages)*Math.ceil(numColumnPages);var numLoops=0;while(currentTotalPages>pageCount){var roundRowDownProportion=Math.floor(numRowPages)/numRowPages;var roundColumnDownProportion=Math.floor(numColumnPages)/numColumnPages;if(roundRowDownProportion==1){roundRowDownProportion=Math.floor(numRowPages-1)/numRowPages;}if(roundColumnDownProportion==1){roundColumnDownProportion=Math.floor(numColumnPages-1)/numColumnPages;}var scaleChange=1;if(roundRowDownProportion>roundColumnDownProportion){scaleChange=roundRowDownProportion;}else{scaleChange=roundColumnDownProportion;}numRowPages=numRowPages*scaleChange;numColumnPages=numColumnPages*scaleChange;currentTotalPages=Math.ceil(numRowPages)*Math.ceil(numColumnPages);numLoops++;if(numLoops>10){break;}}var posterWidth=availablePageWidth*numRowPages;scale=posterWidth/graphWidth;return scale*0.99999;},show:function(graph,doc,x0,y0){x0=(x0!=null)?x0:0;y0=(y0!=null)?y0:0;if(doc==null){var wnd=window.open();doc=wnd.document;}else{doc.open();}var bounds=graph.getGraphBounds();var dx=-bounds.x+x0;var dy=-bounds.y+y0;if(mxClient.IS_IE){var html='<html>';html+='<head>';var base=document.getElementsByTagName('base');for(var i=0;i<base.length;i++){html+=base[i].outerHTML;}html+='<style>';for(var i=0;i<document.styleSheets.length;i++){try{html+=document.styleSheets(i).cssText;}catch(e){}}html+='</style>';html+='</head>';html+='<body>';html+=graph.container.innerHTML;html+='</body>';html+='<html>';doc.writeln(html);doc.close();var node=doc.body.getElementsByTagName('DIV')[0];if(node!=null){node.style.position='absolute';node.style.left=dx+'px';node.style.top=dy+'px';}}else{doc.writeln('<html');doc.writeln('<head>');var base=document.getElementsByTagName('base');for(var i=0;i<base.length;i++){doc.writeln(mxUtils.getOuterHtml(base[i]));}var links=document.getElementsByTagName('link');for(var i=0;i<links.length;i++){doc.writeln(mxUtils.getOuterHtml(links[i]));}var styles=document.getElementsByTagName('style');for(var i=0;i<styles.length;i++){doc.writeln(mxUtils.getOuterHtml(styles[i]));}doc.writeln('</head>');doc.writeln('</html>');doc.close();if(doc.body==null){doc.documentElement.appendChild(doc.createElement('body'));}doc.body.style.overflow='auto';var node=graph.container.firstChild;while(node!=null){var clone=node.cloneNode(true);doc.body.appendChild(clone);node=node.nextSibling;}var node=doc.getElementsByTagName('g')[0];if(node!=null){node.setAttribute('transform','translate('+dx+','+dy+')');var root=node.ownerSVGElement;root.setAttribute('width',bounds.width+Math.max(bounds.x,0)+3);root.setAttribute('height',bounds.height+Math.max(bounds.y,0)+3);}}mxUtils.removeCursors(doc.body);return doc;},printScreen:function(graph){var wnd=window.open();mxUtils.show(graph,wnd.document);var print=function(){wnd.focus();wnd.print();wnd.close();};if(mxClient.IS_GC){wnd.setTimeout(print, 500);}else{print();}},popup:function(content,isInternalWindow){if(isInternalWindow){var div=document.createElement('div');div.style.overflow='scroll';div.style.width='636px';div.style.height='460px';var pre=document.createElement('pre');pre.innerHTML=mxUtils.htmlEntities(content,false).replace(/\n/g,'<br>').replace(/ /g,'&nbsp;');div.appendChild(pre);var w=document.body.clientWidth;var h=(document.body.clientHeight||document.documentElement.clientHeight);var wnd=new mxWindow('Popup Window',div,w/2-320,h/2-240,640,480,false,true);wnd.setClosable(true);wnd.setVisible(true);}else{if(mxClient.IS_NS){var wnd=window.open();wnd.document.writeln('<pre>'+mxUtils.htmlEntities(content)+'</pre');wnd.document.close();}else{var wnd=window.open();var pre=wnd.document.createElement('pre');pre.innerHTML=mxUtils.htmlEntities(content,false).replace(/\n/g,'<br>').replace(/ /g,'&nbsp;');wnd.document.body.appendChild(pre);}}},alert:function(message){alert(message);},prompt:function(message,defaultValue){return prompt(message,defaultValue);},confirm:function(message){return confirm(message);},error:function(message,width,close,icon){var div=document.createElement('div');div.style.padding='20px';var img=document.createElement('img');img.setAttribute('src',icon||mxUtils.errorImage);img.setAttribute('valign','bottom');img.style.verticalAlign='middle';div.appendChild(img);div.appendChild(document.createTextNode('\u00a0'));div.appendChild(document.createTextNode('\u00a0'));div.appendChild(document.createTextNode('\u00a0'));mxUtils.write(div,message);var w=document.body.clientWidth;var h=(document.body.clientHeight||document.documentElement.clientHeight);var warn=new mxWindow(mxResources.get(mxUtils.errorResource)||mxUtils.errorResource,div,(w-width)/2,h/4,width,null,false,true);if(close){mxUtils.br(div);var tmp=document.createElement('p');var button=document.createElement('button');if(mxClient.IS_IE){button.style.cssText='float:right';}else{button.setAttribute('style','float:right');}mxEvent.addListener(button,'click',function(evt){warn.destroy();});mxUtils.write(button,mxResources.get(mxUtils.closeResource)||mxUtils.closeResource);tmp.appendChild(button);div.appendChild(tmp);mxUtils.br(div);warn.setClosable(true);}warn.setVisible(true);return warn;},makeDraggable:function(element,graphF,funct,dragElement,dx,dy,autoscroll,scalePreview,highlightDropTargets,getDropTarget){var dragSource=new mxDragSource(element,funct);dragSource.dragOffset=new mxPoint((dx!=null)?dx:0,(dy!=null)?dy:mxConstants.TOOLTIP_VERTICAL_OFFSET);dragSource.autoscroll=autoscroll;dragSource.setGuidesEnabled(false);if(highlightDropTargets!=null){dragSource.highlightDropTargets=highlightDropTargets;}if(getDropTarget!=null){dragSource.getDropTarget=getDropTarget;}dragSource.getGraphForEvent=function(evt){return(typeof(graphF)=='function')?graphF(evt):graphF;};if(dragElement!=null){dragSource.createDragElement=function(){return dragElement.cloneNode(true);};if(scalePreview){dragSource.createPreviewElement=function(graph){var elt=dragElement.cloneNode(true);var w=parseInt(elt.style.width);var h=parseInt(elt.style.height);elt.style.width=Math.round(w*graph.view.scale)+'px';elt.style.height=Math.round(h*graph.view.scale)+'px';return elt;};}}return dragSource;}};var mxConstants={DEFAULT_HOTSPOT:0.3,MIN_HOTSPOT_SIZE:8,MAX_HOTSPOT_SIZE:0,RENDERING_HINT_EXACT:'exact',RENDERING_HINT_FASTER:'faster',RENDERING_HINT_FASTEST:'fastest',DIALECT_SVG:'svg',DIALECT_VML:'vml',DIALECT_MIXEDHTML:'mixedHtml',DIALECT_PREFERHTML:'preferHtml',DIALECT_STRICTHTML:'strictHtml',NS_SVG:'http://www.w3.org/2000/svg',NS_XHTML:'http://www.w3.org/1999/xhtml',NS_XLINK:'http://www.w3.org/1999/xlink',SHADOWCOLOR:'gray',SHADOW_OFFSET_X:2,SHADOW_OFFSET_Y:3,SHADOW_OPACITY:1,NODETYPE_ELEMENT:1,NODETYPE_ATTRIBUTE:2,NODETYPE_TEXT:3,NODETYPE_CDATA:4,NODETYPE_ENTITY_REFERENCE:5,NODETYPE_ENTITY:6,NODETYPE_PROCESSING_INSTRUCTION:7,NODETYPE_COMMENT:8,NODETYPE_DOCUMENT:9,NODETYPE_DOCUMENTTYPE:10,NODETYPE_DOCUMENT_FRAGMENT:11,NODETYPE_NOTATION:12,TOOLTIP_VERTICAL_OFFSET:16,DEFAULT_VALID_COLOR:'#00FF00',DEFAULT_INVALID_COLOR:'#FF0000',HIGHLIGHT_STROKEWIDTH:3,CURSOR_MOVABLE_VERTEX:'move',CURSOR_MOVABLE_EDGE:'move',CURSOR_LABEL_HANDLE:'default',CURSOR_BEND_HANDLE:'pointer',CURSOR_CONNECT:'pointer',HIGHLIGHT_COLOR:'#00FF00',CONNECT_TARGET_COLOR:'#0000FF',INVALID_CONNECT_TARGET_COLOR:'#FF0000',DROP_TARGET_COLOR:'#0000FF',VALID_COLOR:'#00FF00',INVALID_COLOR:'#FF0000',EDGE_SELECTION_COLOR:'#00FF00',VERTEX_SELECTION_COLOR:'#00FF00',VERTEX_SELECTION_STROKEWIDTH:1,EDGE_SELECTION_STROKEWIDTH:1,VERTEX_SELECTION_DASHED:true,EDGE_SELECTION_DASHED:true,GUIDE_COLOR:'#FF0000',GUIDE_STROKEWIDTH:1,OUTLINE_COLOR:'#0099FF',OUTLINE_STROKEWIDTH:(mxClient.IS_IE)?2:3,HANDLE_SIZE:7,LABEL_HANDLE_SIZE:4,HANDLE_FILLCOLOR:'#00FF00',HANDLE_STROKECOLOR:'black',LABEL_HANDLE_FILLCOLOR:'yellow',CONNECT_HANDLE_FILLCOLOR:'#0000FF',LOCKED_HANDLE_FILLCOLOR:'#FF0000',OUTLINE_HANDLE_FILLCOLOR:'#00FFFF',OUTLINE_HANDLE_STROKECOLOR:'#0033FF',DEFAULT_FONTFAMILY:'Arial,Helvetica',DEFAULT_FONTSIZE:11,DEFAULT_STARTSIZE:40,DEFAULT_MARKERSIZE:6,DEFAULT_IMAGESIZE:24,ENTITY_SEGMENT:30,RECTANGLE_ROUNDING_FACTOR:0.15,LINE_ARCSIZE:20,ARROW_SPACING:10,ARROW_WIDTH:30,ARROW_SIZE:30,PAGE_FORMAT_A4_PORTRAIT:new mxRectangle(0,0,826,1169),PAGE_FORMAT_A4_LANDSCAPE:new mxRectangle(0,0,1169,826),PAGE_FORMAT_LETTER_PORTRAIT:new mxRectangle(0,0,850,1100),PAGE_FORMAT_LETTER_LANDSCAPE:new mxRectangle(0,0,1100,850),NONE:'none',STYLE_PERIMETER:'perimeter',STYLE_SOURCE_PORT:'sourcePort',STYLE_TARGET_PORT:'targetPort',STYLE_PORT_CONSTRAINT:'portConstraint',STYLE_OPACITY:'opacity',STYLE_TEXT_OPACITY:'textOpacity',STYLE_OVERFLOW:'overflow',STYLE_ORTHOGONAL:'orthogonal',STYLE_EXIT_X:'exitX',STYLE_EXIT_Y:'exitY',STYLE_EXIT_PERIMETER:'exitPerimeter',STYLE_ENTRY_X:'entryX',STYLE_ENTRY_Y:'entryY',STYLE_ENTRY_PERIMETER:'entryPerimeter',STYLE_WHITE_SPACE:'whiteSpace',STYLE_ROTATION:'rotation',STYLE_FILLCOLOR:'fillColor',STYLE_GRADIENTCOLOR:'gradientColor',STYLE_GRADIENT_DIRECTION:'gradientDirection',STYLE_STROKECOLOR:'strokeColor',STYLE_SEPARATORCOLOR:'separatorColor',STYLE_STROKEWIDTH:'strokeWidth',STYLE_ALIGN:'align',STYLE_VERTICAL_ALIGN:'verticalAlign',STYLE_LABEL_POSITION:'labelPosition',STYLE_VERTICAL_LABEL_POSITION:'verticalLabelPosition',STYLE_IMAGE_ASPECT:'imageAspect',STYLE_IMAGE_ALIGN:'imageAlign',STYLE_IMAGE_VERTICAL_ALIGN:'imageVerticalAlign',STYLE_GLASS:'glass',STYLE_IMAGE:'image',STYLE_IMAGE_WIDTH:'imageWidth',STYLE_IMAGE_HEIGHT:'imageHeight',STYLE_IMAGE_BACKGROUND:'imageBackground',STYLE_IMAGE_BORDER:'imageBorder',STYLE_IMAGE_FLIPH:'imageFlipH',STYLE_IMAGE_FLIPV:'imageFlipV',STYLE_STENCIL_FLIPH:'stencilFlipH',STYLE_STENCIL_FLIPV:'stencilFlipV',STYLE_NOLABEL:'noLabel',STYLE_NOEDGESTYLE:'noEdgeStyle',STYLE_LABEL_BACKGROUNDCOLOR:'labelBackgroundColor',STYLE_LABEL_BORDERCOLOR:'labelBorderColor',STYLE_LABEL_PADDING:'labelPadding',STYLE_INDICATOR_SHAPE:'indicatorShape',STYLE_INDICATOR_IMAGE:'indicatorImage',STYLE_INDICATOR_COLOR:'indicatorColor',STYLE_INDICATOR_STROKECOLOR:'indicatorStrokeColor',STYLE_INDICATOR_GRADIENTCOLOR:'indicatorGradientColor',STYLE_INDICATOR_SPACING:'indicatorSpacing',STYLE_INDICATOR_WIDTH:'indicatorWidth',STYLE_INDICATOR_HEIGHT:'indicatorHeight',STYLE_INDICATOR_DIRECTION:'indicatorDirection',STYLE_SHADOW:'shadow',STYLE_SEGMENT:'segment',STYLE_ENDARROW:'endArrow',STYLE_STARTARROW:'startArrow',STYLE_ENDSIZE:'endSize',STYLE_STARTSIZE:'startSize',STYLE_ENDFILL:'endFill',STYLE_STARTFILL:'startFill',STYLE_DASHED:'dashed',STYLE_DASH_PATTERN:'dashPattern',STYLE_ROUNDED:'rounded',STYLE_ARCSIZE:'arcSize',STYLE_SMOOTH:'smooth',STYLE_SOURCE_PERIMETER_SPACING:'sourcePerimeterSpacing',STYLE_TARGET_PERIMETER_SPACING:'targetPerimeterSpacing',STYLE_PERIMETER_SPACING:'perimeterSpacing',STYLE_SPACING:'spacing',STYLE_SPACING_TOP:'spacingTop',STYLE_SPACING_LEFT:'spacingLeft',STYLE_SPACING_BOTTOM:'spacingBottom',STYLE_SPACING_RIGHT:'spacingRight',STYLE_HORIZONTAL:'horizontal',STYLE_DIRECTION:'direction',STYLE_ELBOW:'elbow',STYLE_FONTCOLOR:'fontColor',STYLE_FONTFAMILY:'fontFamily',STYLE_FONTSIZE:'fontSize',STYLE_FONTSTYLE:'fontStyle',STYLE_AUTOSIZE:'autosize',STYLE_FOLDABLE:'foldable',STYLE_EDITABLE:'editable',STYLE_BENDABLE:'bendable',STYLE_MOVABLE:'movable',STYLE_RESIZABLE:'resizable',STYLE_CLONEABLE:'cloneable',STYLE_DELETABLE:'deletable',STYLE_SHAPE:'shape',STYLE_EDGE:'edgeStyle',STYLE_LOOP:'loopStyle',STYLE_ROUTING_CENTER_X:'routingCenterX',STYLE_ROUTING_CENTER_Y:'routingCenterY',FONT_BOLD:1,FONT_ITALIC:2,FONT_UNDERLINE:4,FONT_SHADOW:8,SHAPE_RECTANGLE:'rectangle',SHAPE_ELLIPSE:'ellipse',SHAPE_DOUBLE_ELLIPSE:'doubleEllipse',SHAPE_RHOMBUS:'rhombus',SHAPE_LINE:'line',SHAPE_IMAGE:'image',SHAPE_ARROW:'arrow',SHAPE_LABEL:'label',SHAPE_CYLINDER:'cylinder',SHAPE_SWIMLANE:'swimlane',SHAPE_CONNECTOR:'connector',SHAPE_ACTOR:'actor',SHAPE_CLOUD:'cloud',SHAPE_TRIANGLE:'triangle',SHAPE_HEXAGON:'hexagon',ARROW_CLASSIC:'classic',ARROW_BLOCK:'block',ARROW_OPEN:'open',ARROW_OVAL:'oval',ARROW_DIAMOND:'diamond',ARROW_DIAMOND_THIN:'diamondThin',ALIGN_LEFT:'left',ALIGN_CENTER:'center',ALIGN_RIGHT:'right',ALIGN_TOP:'top',ALIGN_MIDDLE:'middle',ALIGN_BOTTOM:'bottom',DIRECTION_NORTH:'north',DIRECTION_SOUTH:'south',DIRECTION_EAST:'east',DIRECTION_WEST:'west',DIRECTION_MASK_NONE:0,DIRECTION_MASK_WEST:1,DIRECTION_MASK_NORTH:2,DIRECTION_MASK_SOUTH:4,DIRECTION_MASK_EAST:8,DIRECTION_MASK_ALL:15,ELBOW_VERTICAL:'vertical',ELBOW_HORIZONTAL:'horizontal',EDGESTYLE_ELBOW:'elbowEdgeStyle',EDGESTYLE_ENTITY_RELATION:'entityRelationEdgeStyle',EDGESTYLE_LOOP:'loopEdgeStyle',EDGESTYLE_SIDETOSIDE:'sideToSideEdgeStyle',EDGESTYLE_TOPTOBOTTOM:'topToBottomEdgeStyle',EDGESTYLE_ORTHOGONAL:'orthogonalEdgeStyle',EDGESTYLE_SEGMENT:'segmentEdgeStyle',PERIMETER_ELLIPSE:'ellipsePerimeter',PERIMETER_RECTANGLE:'rectanglePerimeter',PERIMETER_RHOMBUS:'rhombusPerimeter',PERIMETER_TRIANGLE:'trianglePerimeter'};function mxEventObject(name){this.name=name;this.properties=[];for(var i=1;i<arguments.length;i+=2){if(arguments[i+1]!=null){this.properties[arguments[i]]=arguments[i+1];}}};mxEventObject.prototype.name=null;mxEventObject.prototype.properties=null;mxEventObject.prototype.consumed=false;mxEventObject.prototype.getName=function(){return this.name;};mxEventObject.prototype.getProperties=function(){return this.properties;};mxEventObject.prototype.getProperty=function(key){return this.properties[key];};mxEventObject.prototype.isConsumed=function(){return this.consumed;};mxEventObject.prototype.consume=function(){this.consumed=true;};function mxMouseEvent(evt,state){this.evt=evt;this.state=state;};mxMouseEvent.prototype.consumed=false;mxMouseEvent.prototype.evt=null;mxMouseEvent.prototype.graphX=null;mxMouseEvent.prototype.graphY=null;mxMouseEvent.prototype.state=null;mxMouseEvent.prototype.getEvent=function(){return this.evt;};mxMouseEvent.prototype.getSource=function(){return mxEvent.getSource(this.evt);};mxMouseEvent.prototype.isSource=function(shape){if(shape!=null){var source=this.getSource();while(source!=null){if(source==shape.node){return true;}source=source.parentNode;}}return false;};mxMouseEvent.prototype.getX=function(){return mxEvent.getClientX(this.getEvent());};mxMouseEvent.prototype.getY=function(){return mxEvent.getClientY(this.getEvent());};mxMouseEvent.prototype.getGraphX=function(){return this.graphX;};mxMouseEvent.prototype.getGraphY=function(){return this.graphY;};mxMouseEvent.prototype.getState=function(){return this.state;};mxMouseEvent.prototype.getCell=function(){var state=this.getState();if(state!=null){return state.cell;}return null;};mxMouseEvent.prototype.isPopupTrigger=function(){return mxEvent.isPopupTrigger(this.getEvent());};mxMouseEvent.prototype.isConsumed=function(){return this.consumed;};mxMouseEvent.prototype.consume=function(preventDefault){preventDefault=(preventDefault!=null)?preventDefault:true;if(preventDefault&&this.evt.preventDefault){this.evt.preventDefault();}this.evt.returnValue=false;this.consumed=true;};function mxEventSource(eventSource){this.setEventSource(eventSource);};mxEventSource.prototype.eventListeners=null;mxEventSource.prototype.eventsEnabled=true;mxEventSource.prototype.eventSource=null;mxEventSource.prototype.isEventsEnabled=function(){return this.eventsEnabled;};mxEventSource.prototype.setEventsEnabled=function(value){this.eventsEnabled=value;};mxEventSource.prototype.getEventSource=function(){return this.eventSource;};mxEventSource.prototype.setEventSource=function(value){this.eventSource=value;};mxEventSource.prototype.addListener=function(name,funct){if(this.eventListeners==null){this.eventListeners=[];}this.eventListeners.push(name);this.eventListeners.push(funct);};mxEventSource.prototype.removeListener=function(funct){if(this.eventListeners!=null){var i=0;while(i<this.eventListeners.length){if(this.eventListeners[i+1]==funct){this.eventListeners.splice(i,2);}else{i+=2;}}}};mxEventSource.prototype.fireEvent=function(evt,sender){if(this.eventListeners!=null&&this.isEventsEnabled()){if(evt==null){evt=new mxEventObject();}if(sender==null){sender=this.getEventSource();}if(sender==null){sender=this;}var args=[sender,evt];for(var i=0;i<this.eventListeners.length;i+=2){var listen=this.eventListeners[i];if(listen==null||listen==evt.getName()){this.eventListeners[i+1].apply(this,args);}}}};var mxEvent={objects:[],addListener:function(){var updateListenerList=function(element,eventName,funct){if(element.mxListenerList==null){element.mxListenerList=[];mxEvent.objects.push(element);}var entry={name:eventName,f:funct};element.mxListenerList.push(entry);};if(window.addEventListener){return function(element,eventName,funct){element.addEventListener(eventName,funct,false);updateListenerList(element,eventName,funct);};}else{return function(element,eventName,funct){element.attachEvent("on"+eventName,funct);updateListenerList(element,eventName,funct);};}}(),removeListener:function(){var updateListener=function(element,eventName,funct){if(element.mxListenerList!=null){var listenerCount=element.mxListenerList.length;for(var i=0;i<listenerCount;i++){var entry=element.mxListenerList[i];if(entry.f==funct){element.mxListenerList.splice(i,1);break;}}if(element.mxListenerList.length==0){element.mxListenerList=null;}}};if(window.removeEventListener){return function(element,eventName,funct){element.removeEventListener(eventName,funct,false);updateListener(element,eventName,funct);};}else{return function(element,eventName,funct){element.detachEvent("on"+eventName,funct);updateListener(element,eventName,funct);};}}(),removeAllListeners:function(element){var list=element.mxListenerList;if(list!=null){while(list.length>0){var entry=list[0];mxEvent.removeListener(element,entry.name,entry.f);}}},redirectMouseEvents:function(node,graph,state,down,move,up,dblClick){var getState=function(evt){return(typeof(state)=='function')?state(evt):state;};var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.addListener(node,md,function(evt){if(down!=null){down(evt);}else if(!mxEvent.isConsumed(evt)){graph.fireMouseEvent(mxEvent.MOUSE_DOWN,new mxMouseEvent(evt,getState(evt)));}});mxEvent.addListener(node,mm,function(evt){if(move!=null){move(evt);}else if(!mxEvent.isConsumed(evt)){graph.fireMouseEvent(mxEvent.MOUSE_MOVE,new mxMouseEvent(evt,getState(evt)));}});mxEvent.addListener(node,mu,function(evt){if(up!=null){up(evt);}else if(!mxEvent.isConsumed(evt)){graph.fireMouseEvent(mxEvent.MOUSE_UP,new mxMouseEvent(evt,getState(evt)));}});mxEvent.addListener(node,'dblclick',function(evt){if(dblClick!=null){dblClick(evt);}else if(!mxEvent.isConsumed(evt)){var tmp=getState(evt);graph.dblClick(evt,(tmp!=null)?tmp.cell:null);}});},release:function(element){if(element!=null){mxEvent.removeAllListeners(element);var children=element.childNodes;if(children!=null){var childCount=children.length;for(var i=0;i<childCount;i+=1){mxEvent.release(children[i]);}}}},addMouseWheelListener:function(funct){if(funct!=null){var wheelHandler=function(evt){if(evt==null){evt=window.event;}var delta=0;if(mxClient.IS_NS&&!mxClient.IS_SF&&!mxClient.IS_GC){delta=-evt.detail/2;}else{delta=evt.wheelDelta/120;}if(delta!=0){funct(evt,delta>0);}};if(mxClient.IS_NS){var eventName=(mxClient.IS_SF||mxClient.IS_GC)?'mousewheel':'DOMMouseScroll';mxEvent.addListener(window,eventName,wheelHandler);}else{mxEvent.addListener(document,'mousewheel',wheelHandler);}}},disableContextMenu:function(){if(mxClient.IS_IE&&(typeof(document.documentMode)==='undefined'||document.documentMode<9)){return function(element){mxEvent.addListener(element,'contextmenu',function(){return false;});};}else{return function(element){element.setAttribute('oncontextmenu','return false;');};}}(),getSource:function(evt){return(evt.srcElement!=null)?evt.srcElement:evt.target;},isConsumed:function(evt){return evt.isConsumed!=null&&evt.isConsumed;},isLeftMouseButton:function(evt){return evt.button==((mxClient.IS_IE&&(typeof(document.documentMode)==='undefined'||document.documentMode<9))?1:0);},isRightMouseButton:function(evt){return evt.button==2;},isPopupTrigger:function(evt){return mxEvent.isRightMouseButton(evt)||(mxEvent.isShiftDown(evt)&&!mxEvent.isControlDown(evt));},isShiftDown:function(evt){return(evt!=null)?evt.shiftKey:false;},isAltDown:function(evt){return(evt!=null)?evt.altKey:false;},isControlDown:function(evt){return(evt!=null)?evt.ctrlKey:false;},isMetaDown:function(evt){return(evt!=null)?evt.metaKey:false;},getMainEvent:function(e){if((e.type=='touchstart'||e.type=='touchmove')&&e.touches!=null&&e.touches[0]!=null){e=e.touches[0];}else if(e.type=='touchend'&&e.changedTouches!=null&&e.changedTouches[0]!=null){e=e.changedTouches[0];}return e;},getClientX:function(e){return mxEvent.getMainEvent(e).clientX;},getClientY:function(e){return mxEvent.getMainEvent(e).clientY;},consume:function(evt,preventDefault,stopPropagation){preventDefault=(preventDefault!=null)?preventDefault:true;stopPropagation=(stopPropagation!=null)?stopPropagation:true;if(preventDefault){if(evt.preventDefault){if(stopPropagation){evt.stopPropagation();}evt.preventDefault();}else if(stopPropagation){evt.cancelBubble=true;}}evt.isConsumed=true;evt.returnValue=false;},LABEL_HANDLE:-1,MOUSE_DOWN:'mouseDown',MOUSE_MOVE:'mouseMove',MOUSE_UP:'mouseUp',ACTIVATE:'activate',RESIZE_START:'resizeStart',RESIZE:'resize',RESIZE_END:'resizeEnd',MOVE_START:'moveStart',MOVE:'move',MOVE_END:'moveEnd',PAN_START:'panStart',PAN:'pan',PAN_END:'panEnd',MINIMIZE:'minimize',NORMALIZE:'normalize',MAXIMIZE:'maximize',HIDE:'hide',SHOW:'show',CLOSE:'close',DESTROY:'destroy',REFRESH:'refresh',SIZE:'size',SELECT:'select',FIRED:'fired',GET:'get',RECEIVE:'receive',CONNECT:'connect',DISCONNECT:'disconnect',SUSPEND:'suspend',RESUME:'resume',MARK:'mark',SESSION:'session',ROOT:'root',POST:'post',OPEN:'open',SAVE:'save',BEFORE_ADD_VERTEX:'beforeAddVertex',ADD_VERTEX:'addVertex',AFTER_ADD_VERTEX:'afterAddVertex',DONE:'done',EXECUTE:'execute',BEGIN_UPDATE:'beginUpdate',END_UPDATE:'endUpdate',BEFORE_UNDO:'beforeUndo',UNDO:'undo',REDO:'redo',CHANGE:'change',NOTIFY:'notify',LAYOUT_CELLS:'layoutCells',CLICK:'click',SCALE:'scale',TRANSLATE:'translate',SCALE_AND_TRANSLATE:'scaleAndTranslate',UP:'up',DOWN:'down',ADD:'add',CLEAR:'clear',ADD_CELLS:'addCells',CELLS_ADDED:'cellsAdded',MOVE_CELLS:'moveCells',CELLS_MOVED:'cellsMoved',RESIZE_CELLS:'resizeCells',CELLS_RESIZED:'cellsResized',TOGGLE_CELLS:'toggleCells',CELLS_TOGGLED:'cellsToggled',ORDER_CELLS:'orderCells',CELLS_ORDERED:'cellsOrdered',REMOVE_CELLS:'removeCells',CELLS_REMOVED:'cellsRemoved',GROUP_CELLS:'groupCells',UNGROUP_CELLS:'ungroupCells',REMOVE_CELLS_FROM_PARENT:'removeCellsFromParent',FOLD_CELLS:'foldCells',CELLS_FOLDED:'cellsFolded',ALIGN_CELLS:'alignCells',LABEL_CHANGED:'labelChanged',CONNECT_CELL:'connectCell',CELL_CONNECTED:'cellConnected',SPLIT_EDGE:'splitEdge',FLIP_EDGE:'flipEdge',START_EDITING:'startEditing',ADD_OVERLAY:'addOverlay',REMOVE_OVERLAY:'removeOverlay',UPDATE_CELL_SIZE:'updateCellSize',ESCAPE:'escape',CLICK:'click',DOUBLE_CLICK:'doubleClick'};function mxXmlRequest(url,params,method,async,username,password){this.url=url;this.params=params;this.method=method||'POST';this.async=(async!=null)?async:true;this.username=username;this.password=password;};mxXmlRequest.prototype.url=null;mxXmlRequest.prototype.params=null;mxXmlRequest.prototype.method=null;mxXmlRequest.prototype.async=null;mxXmlRequest.prototype.binary=false;mxXmlRequest.prototype.username=null;mxXmlRequest.prototype.password=null;mxXmlRequest.prototype.request=null;mxXmlRequest.prototype.isBinary=function(){return this.binary;};mxXmlRequest.prototype.setBinary=function(value){this.binary=value;};mxXmlRequest.prototype.getText=function(){return this.request.responseText;};mxXmlRequest.prototype.isReady=function(){return this.request.readyState==4;};mxXmlRequest.prototype.getDocumentElement=function(){var doc=this.getXml();if(doc!=null){return doc.documentElement;}return null;};mxXmlRequest.prototype.getXml=function(){var xml=this.request.responseXML;if(document.documentMode>=9||xml==null||xml.documentElement==null){xml=mxUtils.parseXml(this.request.responseText);}return xml;};mxXmlRequest.prototype.getText=function(){return this.request.responseText;};mxXmlRequest.prototype.getStatus=function(){return this.request.status;};mxXmlRequest.prototype.create=function(){if(window.XMLHttpRequest){return function(){var req=new XMLHttpRequest();if(this.isBinary()&&req.overrideMimeType){req.overrideMimeType('text/plain; charset=x-user-defined');}return req;};}else if(typeof(ActiveXObject)!="undefined"){return function(){return new ActiveXObject("Microsoft.XMLHTTP");};}}();mxXmlRequest.prototype.send=function(onload,onerror){this.request=this.create();if(this.request!=null){if(onload!=null){this.request.onreadystatechange=mxUtils.bind(this,function(){if(this.isReady()){onload(this);this.onreadystatechaange=null;}});}this.request.open(this.method,this.url,this.async,this.username,this.password);this.setRequestHeaders(this.request,this.params);this.request.send(this.params);}};mxXmlRequest.prototype.setRequestHeaders=function(request,params){if(params!=null){request.setRequestHeader('Content-Type','application/x-www-form-urlencoded');}};mxXmlRequest.prototype.simulate=function(doc,target){doc=doc||document;var old=null;if(doc==document){old=window.onbeforeunload;window.onbeforeunload=null;}var form=doc.createElement('form');form.setAttribute('method',this.method);form.setAttribute('action',this.url);if(target!=null){form.setAttribute('target',target);}form.style.display='none';form.style.visibility='hidden';var pars=(this.params.indexOf('&')>0)?this.params.split('&'):this.params.split();for(var i=0;i<pars.length;i++){var pos=pars[i].indexOf('=');if(pos>0){var name=pars[i].substring(0,pos);var value=pars[i].substring(pos+1);var textarea=doc.createElement('textarea');textarea.setAttribute('name',name);value=value.replace(/\n/g,'&#xa;');var content=doc.createTextNode(value);textarea.appendChild(content);form.appendChild(textarea);}}doc.body.appendChild(form);form.submit();doc.body.removeChild(form);if(old!=null){window.onbeforeunload=old;}};var mxClipboard={STEPSIZE:10,insertCount:1,cells:null,isEmpty:function(){return mxClipboard.cells==null;},cut:function(graph,cells){cells=mxClipboard.copy(graph,cells);mxClipboard.insertCount=0;mxClipboard.removeCells(graph,cells);return cells;},removeCells:function(graph,cells){graph.removeCells(cells);},copy:function(graph,cells){cells=cells||graph.getSelectionCells();var result=graph.getExportableCells(cells);mxClipboard.insertCount=1;mxClipboard.cells=graph.cloneCells(result);return result;},paste:function(graph){if(mxClipboard.cells!=null){var cells=graph.getImportableCells(mxClipboard.cells);var delta=mxClipboard.insertCount*mxClipboard.STEPSIZE;var parent=graph.getDefaultParent();cells=graph.importCells(cells,delta,delta,parent);mxClipboard.insertCount++;graph.setSelectionCells(cells);}}};function mxWindow(title,content,x,y,width,height,minimizable,movable,replaceNode,style){if(content!=null){minimizable=(minimizable!=null)?minimizable:true;this.content=content;this.init(x,y,width,height,style);this.installMaximizeHandler();this.installMinimizeHandler();this.installCloseHandler();this.setMinimizable(minimizable);this.setTitle(title);if(movable==null||movable){this.installMoveHandler();}if(replaceNode!=null&&replaceNode.parentNode!=null){replaceNode.parentNode.replaceChild(this.div,replaceNode);}else{document.body.appendChild(this.div);}}};mxWindow.prototype=new mxEventSource();mxWindow.prototype.constructor=mxWindow;mxWindow.prototype.closeImage=mxClient.imageBasePath+'/close.gif';mxWindow.prototype.minimizeImage=mxClient.imageBasePath+'/minimize.gif';mxWindow.prototype.normalizeImage=mxClient.imageBasePath+'/normalize.gif';mxWindow.prototype.maximizeImage=mxClient.imageBasePath+'/maximize.gif';mxWindow.prototype.resizeImage=mxClient.imageBasePath+'/resize.gif';mxWindow.prototype.visible=false;mxWindow.prototype.content=false;mxWindow.prototype.minimumSize=new mxRectangle(0,0,50,40);mxWindow.prototype.title=false;mxWindow.prototype.content=false;mxWindow.prototype.destroyOnClose=true;mxWindow.prototype.init=function(x,y,width,height,style){style=(style!=null)?style:'mxWindow';this.div=document.createElement('div');this.div.className=style;this.div.style.left=x+'px';this.div.style.top=y+'px';this.table=document.createElement('table');this.table.className=style;if(width!=null){if(!mxClient.IS_IE){this.div.style.width=width+'px';}this.table.style.width=width+'px';}if(height!=null){if(!mxClient.IS_IE){this.div.style.height=height+'px';}this.table.style.height=height+'px';}var tbody=document.createElement('tbody');var tr=document.createElement('tr');this.title=document.createElement('td');this.title.className=style+'Title';tr.appendChild(this.title);tbody.appendChild(tr);tr=document.createElement('tr');this.td=document.createElement('td');this.td.className=style+'Pane';this.contentWrapper=document.createElement('div');this.contentWrapper.className=style+'Pane';this.contentWrapper.style.width='100%';this.contentWrapper.appendChild(this.content);if(mxClient.IS_IE||this.content.nodeName.toUpperCase()!='DIV'){this.contentWrapper.style.height='100%';}this.td.appendChild(this.contentWrapper);tr.appendChild(this.td);tbody.appendChild(tr);this.table.appendChild(tbody);this.div.appendChild(this.table);var activator=mxUtils.bind(this,function(evt){this.activate();});var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';mxEvent.addListener(this.title,md,activator);mxEvent.addListener(this.table,md,activator);this.hide();};mxWindow.prototype.setTitle=function(title){var child=this.title.firstChild;while(child!=null){var next=child.nextSibling;if(child.nodeType==mxConstants.NODETYPE_TEXT){child.parentNode.removeChild(child);}child=next;}mxUtils.write(this.title,title||'');};mxWindow.prototype.setScrollable=function(scrollable){if(navigator.userAgent.indexOf('Presto/2.5')<0){if(scrollable){this.contentWrapper.style.overflow='auto';}else{this.contentWrapper.style.overflow='hidden';}}};mxWindow.prototype.activate=function(){if(mxWindow.activeWindow!=this){var style=mxUtils.getCurrentStyle(this.getElement());var index=(style!=null)?style.zIndex:3;if(mxWindow.activeWindow){var elt=mxWindow.activeWindow.getElement();if(elt!=null&&elt.style!=null){elt.style.zIndex=index;}}var previousWindow=mxWindow.activeWindow;this.getElement().style.zIndex=parseInt(index)+1;mxWindow.activeWindow=this;this.fireEvent(new mxEventObject(mxEvent.ACTIVATE,'previousWindow',previousWindow));}};mxWindow.prototype.getElement=function(){return this.div;};mxWindow.prototype.fit=function(){mxUtils.fit(this.div);};mxWindow.prototype.isResizable=function(){if(this.resize!=null){return this.resize.style.display!='none';}return false;};mxWindow.prototype.setResizable=function(resizable){if(resizable){if(this.resize==null){this.resize=document.createElement('img');this.resize.style.position='absolute';this.resize.style.bottom='2px';this.resize.style.right='2px';this.resize.setAttribute('src',mxClient.imageBasePath+'/resize.gif');this.resize.style.cursor='nw-resize';var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.addListener(this.resize,md,mxUtils.bind(this,function(evt){this.activate();var startX=mxEvent.getClientX(evt);var startY=mxEvent.getClientY(evt);var width=this.div.offsetWidth;var height=this.div.offsetHeight;var dragHandler=mxUtils.bind(this,function(evt){var dx=mxEvent.getClientX(evt)-startX;var dy=mxEvent.getClientY(evt)-startY;this.setSize(width+dx,height+dy);this.fireEvent(new mxEventObject(mxEvent.RESIZE,'event',evt));mxEvent.consume(evt);});var dropHandler=mxUtils.bind(this,function(evt){mxEvent.removeListener(document,mm,dragHandler);mxEvent.removeListener(document,mu,dropHandler);this.fireEvent(new mxEventObject(mxEvent.RESIZE_END,'event',evt));mxEvent.consume(evt);});mxEvent.addListener(document,mm,dragHandler);mxEvent.addListener(document,mu,dropHandler);this.fireEvent(new mxEventObject(mxEvent.RESIZE_START,'event',evt));mxEvent.consume(evt);}));this.div.appendChild(this.resize);}else{this.resize.style.display='inline';}}else if(this.resize!=null){this.resize.style.display='none';}};mxWindow.prototype.setSize=function(width,height){width=Math.max(this.minimumSize.width,width);height=Math.max(this.minimumSize.height,height);if(!mxClient.IS_IE){this.div.style.width=width+'px';this.div.style.height=height+'px';}this.table.style.width=width+'px';this.table.style.height=height+'px';if(!mxClient.IS_IE){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+'px';}};mxWindow.prototype.setMinimizable=function(minimizable){this.minimize.style.display=(minimizable)?'':'none';};mxWindow.prototype.getMinimumSize=function(){return new mxRectangle(0,0,0,this.title.offsetHeight);};mxWindow.prototype.installMinimizeHandler=function(){this.minimize=document.createElement('img');this.minimize.setAttribute('src',this.minimizeImage);this.minimize.setAttribute('align','right');this.minimize.setAttribute('title','Minimize');this.minimize.style.cursor='pointer';this.minimize.style.marginRight='1px';this.minimize.style.display='none';this.title.appendChild(this.minimize);var minimized=false;var maxDisplay=null;var height=null;var funct=mxUtils.bind(this,function(evt){this.activate();if(!minimized){minimized=true;this.minimize.setAttribute('src',this.normalizeImage);this.minimize.setAttribute('title','Normalize');this.contentWrapper.style.display='none';maxDisplay=this.maximize.style.display;this.maximize.style.display='none';height=this.table.style.height;var minSize=this.getMinimumSize();if(minSize.height>0){if(!mxClient.IS_IE){this.div.style.height=minSize.height+'px';}this.table.style.height=minSize.height+'px';}if(minSize.width>0){if(!mxClient.IS_IE){this.div.style.width=minSize.width+'px';}this.table.style.width=minSize.width+'px';}if(this.resize!=null){this.resize.style.visibility='hidden';}this.fireEvent(new mxEventObject(mxEvent.MINIMIZE,'event',evt));}else{minimized=false;this.minimize.setAttribute('src',this.minimizeImage);this.minimize.setAttribute('title','Minimize');this.contentWrapper.style.display='';this.maximize.style.display=maxDisplay;if(!mxClient.IS_IE){this.div.style.height=height;}this.table.style.height=height;if(this.resize!=null){this.resize.style.visibility='';}this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,'event',evt));}mxEvent.consume(evt);});var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';mxEvent.addListener(this.minimize,md,funct);};mxWindow.prototype.setMaximizable=function(maximizable){this.maximize.style.display=(maximizable)?'':'none';};mxWindow.prototype.installMaximizeHandler=function(){this.maximize=document.createElement('img');this.maximize.setAttribute('src',this.maximizeImage);this.maximize.setAttribute('align','right');this.maximize.setAttribute('title','Maximize');this.maximize.style.cursor='default';this.maximize.style.marginLeft='1px';this.maximize.style.cursor='pointer';this.maximize.style.display='none';this.title.appendChild(this.maximize);var maximized=false;var x=null;var y=null;var height=null;var width=null;var funct=mxUtils.bind(this,function(evt){this.activate();if(this.maximize.style.display!='none'){if(!maximized){maximized=true;this.maximize.setAttribute('src',this.normalizeImage);this.maximize.setAttribute('title','Normalize');this.contentWrapper.style.display='';this.minimize.style.visibility='hidden';x=parseInt(this.div.style.left);y=parseInt(this.div.style.top);height=this.table.style.height;width=this.table.style.width;this.div.style.left='0px';this.div.style.top='0px';if(!mxClient.IS_IE){this.div.style.height=(document.body.clientHeight-2)+'px';this.div.style.width=(document.body.clientWidth-2)+'px';}this.table.style.width=(document.body.clientWidth-2)+'px';this.table.style.height=(document.body.clientHeight-2)+'px';if(this.resize!=null){this.resize.style.visibility='hidden';}if(!mxClient.IS_IE){var style=mxUtils.getCurrentStyle(this.contentWrapper);if(style.overflow=='auto'||this.resize!=null){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+'px';}}this.fireEvent(new mxEventObject(mxEvent.MAXIMIZE,'event',evt));}else{maximized=false;this.maximize.setAttribute('src',this.maximizeImage);this.maximize.setAttribute('title','Maximize');this.contentWrapper.style.display='';this.minimize.style.visibility='';this.div.style.left=x+'px';this.div.style.top=y+'px';if(!mxClient.IS_IE){this.div.style.height=height;this.div.style.width=width;var style=mxUtils.getCurrentStyle(this.contentWrapper);if(style.overflow=='auto'||this.resize!=null){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+'px';}}this.table.style.height=height;this.table.style.width=width;if(this.resize!=null){this.resize.style.visibility='';}this.fireEvent(new mxEventObject(mxEvent.NORMALIZE,'event',evt));}mxEvent.consume(evt);}});var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';mxEvent.addListener(this.maximize,md,funct);mxEvent.addListener(this.title,'dblclick',funct);};mxWindow.prototype.installMoveHandler=function(){this.title.style.cursor='move';var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.addListener(this.title,md,mxUtils.bind(this,function(evt){var startX=mxEvent.getClientX(evt);var startY=mxEvent.getClientY(evt);var x=this.getX();var y=this.getY();var dragHandler=mxUtils.bind(this,function(evt){var dx=mxEvent.getClientX(evt)-startX;var dy=mxEvent.getClientY(evt)-startY;this.setLocation(x+dx,y+dy);this.fireEvent(new mxEventObject(mxEvent.MOVE,'event',evt));mxEvent.consume(evt);});var dropHandler=mxUtils.bind(this,function(evt){mxEvent.removeListener(document,mm,dragHandler);mxEvent.removeListener(document,mu,dropHandler);this.fireEvent(new mxEventObject(mxEvent.MOVE_END,'event',evt));mxEvent.consume(evt);});mxEvent.addListener(document,mm,dragHandler);mxEvent.addListener(document,mu,dropHandler);this.fireEvent(new mxEventObject(mxEvent.MOVE_START,'event',evt));mxEvent.consume(evt);}));};mxWindow.prototype.setLocation=function(x,y){this.div.style.left=x+'px';this.div.style.top=y+'px';};mxWindow.prototype.getX=function(){return parseInt(this.div.style.left);};mxWindow.prototype.getY=function(){return parseInt(this.div.style.top);};mxWindow.prototype.installCloseHandler=function(){this.closeImg=document.createElement('img');this.closeImg.setAttribute('src',this.closeImage);this.closeImg.setAttribute('align','right');this.closeImg.setAttribute('title','Close');this.closeImg.style.marginLeft='2px';this.closeImg.style.cursor='pointer';this.closeImg.style.display='none';this.title.insertBefore(this.closeImg,this.title.firstChild);var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';mxEvent.addListener(this.closeImg,md,mxUtils.bind(this,function(evt){this.fireEvent(new mxEventObject(mxEvent.CLOSE,'event',evt));if(this.destroyOnClose){this.destroy();}else{this.setVisible(false);}mxEvent.consume(evt);}));};mxWindow.prototype.setImage=function(image){this.image=document.createElement('img');this.image.setAttribute('src',image);this.image.setAttribute('align','left');this.image.style.marginRight='4px';this.image.style.marginLeft='0px';this.image.style.marginTop='-2px';this.title.insertBefore(this.image,this.title.firstChild);};mxWindow.prototype.setClosable=function(closable){this.closeImg.style.display=(closable)?'':'none';};mxWindow.prototype.isVisible=function(){if(this.div!=null){return this.div.style.visibility!='hidden';}return false;};mxWindow.prototype.setVisible=function(visible){if(this.div!=null&&this.isVisible()!=visible){if(visible){this.show();}else{this.hide();}}};mxWindow.prototype.show=function(){this.div.style.visibility='';this.activate();var style=mxUtils.getCurrentStyle(this.contentWrapper);if(!mxClient.IS_IE&&(style.overflow=='auto'||this.resize!=null)){this.contentWrapper.style.height=(this.div.offsetHeight-this.title.offsetHeight-2)+'px';}this.fireEvent(new mxEventObject(mxEvent.SHOW));};mxWindow.prototype.hide=function(){this.div.style.visibility='hidden';this.fireEvent(new mxEventObject(mxEvent.HIDE));};mxWindow.prototype.destroy=function(){this.fireEvent(new mxEventObject(mxEvent.DESTROY));if(this.div!=null){mxEvent.release(this.div);this.div.parentNode.removeChild(this.div);this.div=null;}this.title=null;this.content=null;this.contentWrapper=null;};function mxForm(className){this.table=document.createElement('table');this.table.className=className;this.body=document.createElement('tbody');this.table.appendChild(this.body);};mxForm.prototype.table=null;mxForm.prototype.body=false;mxForm.prototype.getTable=function(){return this.table;};mxForm.prototype.addButtons=function(okFunct,cancelFunct){var tr=document.createElement('tr');var td=document.createElement('td');tr.appendChild(td);td=document.createElement('td');var button=document.createElement('button');mxUtils.write(button,mxResources.get('ok')||'OK');td.appendChild(button);mxEvent.addListener(button,'click',function(){okFunct();});button=document.createElement('button');mxUtils.write(button,mxResources.get('cancel')||'Cancel');td.appendChild(button);mxEvent.addListener(button,'click',function(){cancelFunct();});tr.appendChild(td);this.body.appendChild(tr);};mxForm.prototype.addText=function(name,value){var input=document.createElement('input');input.setAttribute('type','text');input.value=value;return this.addField(name,input);};mxForm.prototype.addCheckbox=function(name,value){var input=document.createElement('input');input.setAttribute('type','checkbox');this.addField(name,input);if(value){input.checked=true;}return input;};mxForm.prototype.addTextarea=function(name,value,rows){var input=document.createElement('textarea');if(mxClient.IS_NS){rows--;}input.setAttribute('rows',rows||2);input.value=value;return this.addField(name,input);};mxForm.prototype.addCombo=function(name,isMultiSelect,size){var select=document.createElement('select');if(size!=null){select.setAttribute('size',size);}if(isMultiSelect){select.setAttribute('multiple','true');}return this.addField(name,select);};mxForm.prototype.addOption=function(combo,label,value,isSelected){var option=document.createElement('option');mxUtils.writeln(option,label);option.setAttribute('value',value);if(isSelected){option.setAttribute('selected',isSelected);}combo.appendChild(option);};mxForm.prototype.addField=function(name,input){var tr=document.createElement('tr');var td=document.createElement('td');mxUtils.write(td,name);tr.appendChild(td);td=document.createElement('td');td.appendChild(input);tr.appendChild(td);this.body.appendChild(tr);return input;};function mxImage(src,width,height){this.src=src;this.width=width;this.height=height;};mxImage.prototype.src=null;mxImage.prototype.width=null;mxImage.prototype.height=null;function mxDivResizer(div,container){if(div.nodeName.toLowerCase()=='div'){if(container==null){container=window;}this.div=div;var style=mxUtils.getCurrentStyle(div);if(style!=null){this.resizeWidth=style.width=='auto';this.resizeHeight=style.height=='auto';}mxEvent.addListener(container,'resize',mxUtils.bind(this,function(evt){if(!this.handlingResize){this.handlingResize=true;this.resize();this.handlingResize=false;}}));this.resize();}};mxDivResizer.prototype.resizeWidth=true;mxDivResizer.prototype.resizeHeight=true;mxDivResizer.prototype.handlingResize=false;mxDivResizer.prototype.resize=function(){var w=this.getDocumentWidth();var h=this.getDocumentHeight();var l=parseInt(this.div.style.left);var r=parseInt(this.div.style.right);var t=parseInt(this.div.style.top);var b=parseInt(this.div.style.bottom);if(this.resizeWidth&&!isNaN(l)&&!isNaN(r)&&l>=0&&r>=0&&w-r-l>0){this.div.style.width=(w-r-l)+'px';}if(this.resizeHeight&&!isNaN(t)&&!isNaN(b)&&t>=0&&b>=0&&h-t-b>0){this.div.style.height=(h-t-b)+'px';}};mxDivResizer.prototype.getDocumentWidth=function(){return document.body.clientWidth;};mxDivResizer.prototype.getDocumentHeight=function(){return document.body.clientHeight;};function mxDragSource(element,dropHandler){this.element=element;this.dropHandler=dropHandler;var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';mxEvent.addListener(element,md,mxUtils.bind(this,this.mouseDown));};mxDragSource.prototype.element=null;mxDragSource.prototype.dropHandler=null;mxDragSource.prototype.dragOffset=null;mxDragSource.prototype.dragElement=null;mxDragSource.prototype.previewElement=null;mxDragSource.prototype.enabled=true;mxDragSource.prototype.currentGraph=null;mxDragSource.prototype.currentDropTarget=null;mxDragSource.prototype.currentPoint=null;mxDragSource.prototype.currentGuide=null;mxDragSource.prototype.currentHighlight=null;mxDragSource.prototype.autoscroll=true;mxDragSource.prototype.guidesEnabled=true;mxDragSource.prototype.gridEnabled=true;mxDragSource.prototype.highlightDropTargets=true;mxDragSource.prototype.isEnabled=function(){return this.enabled;};mxDragSource.prototype.setEnabled=function(value){this.enabled=value;};mxDragSource.prototype.isGuidesEnabled=function(){return this.guidesEnabled;};mxDragSource.prototype.setGuidesEnabled=function(value){this.guidesEnabled=value;};mxDragSource.prototype.isGridEnabled=function(){return this.gridEnabled;};mxDragSource.prototype.setGridEnabled=function(value){this.gridEnabled=value;};mxDragSource.prototype.getGraphForEvent=function(evt){return null;};mxDragSource.prototype.getDropTarget=function(graph,x,y){return graph.getCellAt(x,y);};mxDragSource.prototype.createDragElement=function(evt){return this.element.cloneNode(true);};mxDragSource.prototype.createPreviewElement=function(graph){return null;};mxDragSource.prototype.mouseDown=function(evt){if(this.enabled&&!mxEvent.isConsumed(evt)){this.startDrag(evt);var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';this.mouseMoveHandler=mxUtils.bind(this,this.mouseMove);mxEvent.addListener(document,mm,this.mouseMoveHandler);this.mouseUpHandler=mxUtils.bind(this,this.mouseUp);mxEvent.addListener(document,mu,this.mouseUpHandler);mxEvent.consume(evt,true,false);}};mxDragSource.prototype.startDrag=function(evt){this.dragElement=this.createDragElement(evt);this.dragElement.style.position='absolute';this.dragElement.style.zIndex='3';mxUtils.setOpacity(this.dragElement,70);};mxDragSource.prototype.stopDrag=function(evt){if(this.dragElement!=null){if(this.dragElement.parentNode!=null){this.dragElement.parentNode.removeChild(this.dragElement);}this.dragElement=null;}};mxDragSource.prototype.graphContainsEvent=function(graph,evt){var x=mxEvent.getClientX(evt);var y=mxEvent.getClientY(evt);var offset=mxUtils.getOffset(graph.container);var origin=mxUtils.getScrollOrigin();return x>=offset.x-origin.x&&y>=offset.y-origin.y&&x<=offset.x-origin.x+graph.container.offsetWidth&&y<=offset.y-origin.y+graph.container.offsetHeight;};mxDragSource.prototype.mouseMove=function(evt){var graph=this.getGraphForEvent(evt);if(graph!=null&&!this.graphContainsEvent(graph,evt)){graph=null;}if(graph!=this.currentGraph){if(this.currentGraph!=null){this.dragExit(this.currentGraph);}this.currentGraph=graph;if(this.currentGraph!=null){this.dragEnter(this.currentGraph);}}if(this.currentGraph!=null){this.dragOver(this.currentGraph,evt);}if(this.dragElement!=null&&(this.previewElement==null||this.previewElement.style.visibility!='visible')){var x=mxEvent.getClientX(evt);var y=mxEvent.getClientY(evt);if(this.dragElement.parentNode==null){document.body.appendChild(this.dragElement);}this.dragElement.style.visibility='visible';if(this.dragOffset!=null){x+=this.dragOffset.x;y+=this.dragOffset.y;}x+=document.body.scrollLeft||document.documentElement.scrollLeft;y+=document.body.scrollTop||document.documentElement.scrollTop;this.dragElement.style.left=x+'px';this.dragElement.style.top=y+'px';}else if(this.dragElement!=null){this.dragElement.style.visibility='hidden';}mxEvent.consume(evt);};mxDragSource.prototype.mouseUp=function(evt){if(this.currentGraph!=null){if(this.currentPoint!=null&&(this.previewElement==null||this.previewElement.style.visibility!='hidden')){var scale=this.currentGraph.view.scale;var tr=this.currentGraph.view.translate;var x=this.currentPoint.x/scale-tr.x;var y=this.currentPoint.y/scale-tr.y;this.drop(this.currentGraph,evt,this.currentDropTarget,x,y);}this.dragExit(this.currentGraph);}this.stopDrag(evt);this.currentGraph=null;if(this.mouseMoveHandler!=null){var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';mxEvent.removeListener(document,mm,this.mouseMoveHandler);this.mouseMoveHandler=null;}if(this.mouseUpHandler!=null){var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.removeListener(document,mu,this.mouseUpHandler);this.mouseUpHandler=null;}mxEvent.consume(evt);};mxDragSource.prototype.dragEnter=function(graph){graph.isMouseDown=true;this.previewElement=this.createPreviewElement(graph);if(this.isGuidesEnabled()&&this.previewElement!=null){this.currentGuide=new mxGuide(graph,graph.graphHandler.getGuideStates());}if(this.highlightDropTargets){this.currentHighlight=new mxCellHighlight(graph,mxConstants.DROP_TARGET_COLOR);}};mxDragSource.prototype.dragExit=function(graph){this.currentDropTarget=null;this.currentPoint=null;graph.isMouseDown=false;if(this.previewElement!=null){if(this.previewElement.parentNode!=null){this.previewElement.parentNode.removeChild(this.previewElement);}this.previewElement=null;}if(this.currentGuide!=null){this.currentGuide.destroy();this.currentGuide=null;}if(this.currentHighlight!=null){this.currentHighlight.destroy();this.currentHighlight=null;}};mxDragSource.prototype.dragOver=function(graph,evt){var offset=mxUtils.getOffset(graph.container);var origin=mxUtils.getScrollOrigin(graph.container);var x=mxEvent.getClientX(evt)-offset.x+origin.x;var y=mxEvent.getClientY(evt)-offset.y+origin.y;if(graph.autoScroll&&(this.autoscroll==null||this.autoscroll)){graph.scrollPointToVisible(x,y,graph.autoExtend);}if(this.currentHighlight!=null&&graph.isDropEnabled()){this.currentDropTarget=this.getDropTarget(graph,x,y);var state=graph.getView().getState(this.currentDropTarget);this.currentHighlight.highlight(state);}if(this.previewElement!=null){if(this.previewElement.parentNode==null){graph.container.appendChild(this.previewElement);this.previewElement.style.zIndex='3';this.previewElement.style.position='absolute';}var gridEnabled=this.isGridEnabled()&&graph.isGridEnabledEvent(evt);var hideGuide=true;if(this.currentGuide!=null&&this.currentGuide.isEnabledForEvent(evt)){var w=parseInt(this.previewElement.style.width);var h=parseInt(this.previewElement.style.height);var bounds=new mxRectangle(0,0,w,h);var delta=new mxPoint(x,y);delta=this.currentGuide.move(bounds,delta,gridEnabled);hideGuide=false;x=delta.x;y=delta.y;}else if(gridEnabled){var scale=graph.view.scale;var tr=graph.view.translate;var off=graph.gridSize/2;x=(graph.snap(x/scale-tr.x-off)+tr.x)*scale;y=(graph.snap(y/scale-tr.y-off)+tr.y)*scale;}if(this.currentGuide!=null&&hideGuide){this.currentGuide.hide();}if(this.previewOffset!=null){x+=this.previewOffset.x;y+=this.previewOffset.y;}this.previewElement.style.left=Math.round(x)+'px';this.previewElement.style.top=Math.round(y)+'px';this.previewElement.style.visibility='visible';}this.currentPoint=new mxPoint(x,y);};mxDragSource.prototype.drop=function(graph,evt,dropTarget,x,y){this.dropHandler(graph,evt,dropTarget,x,y);graph.container.focus();};function mxToolbar(container){this.container=container;};mxToolbar.prototype=new mxEventSource();mxToolbar.prototype.constructor=mxToolbar;mxToolbar.prototype.container=null;mxToolbar.prototype.enabled=true;mxToolbar.prototype.noReset=false;mxToolbar.prototype.updateDefaultMode=true;mxToolbar.prototype.addItem=function(title,icon,funct,pressedIcon,style,factoryMethod){var img=document.createElement((icon!=null)?'img':'button');var initialClassName=style||((factoryMethod!=null)?'mxToolbarMode':'mxToolbarItem');img.className=initialClassName;img.setAttribute('src',icon);if(title!=null){if(icon!=null){img.setAttribute('title',title);}else{mxUtils.write(img,title);}}this.container.appendChild(img);if(funct!=null){mxEvent.addListener(img,(mxClient.IS_TOUCH)?'touchend':'click',funct);}var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.addListener(img,md,mxUtils.bind(this,function(evt){if(pressedIcon!=null){img.setAttribute('src',pressedIcon);}else{img.style.backgroundColor='gray';}if(factoryMethod!=null){if(this.menu==null){this.menu=new mxPopupMenu();this.menu.init();}var last=this.currentImg;if(this.menu.isMenuShowing()){this.menu.hideMenu();}if(last!=img){this.currentImg=img;this.menu.factoryMethod=factoryMethod;var point=new mxPoint(img.offsetLeft,img.offsetTop+img.offsetHeight);this.menu.popup(point.x,point.y,null,evt);if(this.menu.isMenuShowing()){img.className=initialClassName+'Selected';this.menu.hideMenu=function(){mxPopupMenu.prototype.hideMenu.apply(this);img.className=initialClassName;this.currentImg=null;};}}}}));var mouseHandler=mxUtils.bind(this,function(evt){if(pressedIcon!=null){img.setAttribute('src',icon);}else{img.style.backgroundColor='';}});mxEvent.addListener(img,mu,mouseHandler);mxEvent.addListener(img,'mouseout',mouseHandler);return img;};mxToolbar.prototype.addCombo=function(style){var div=document.createElement('div');div.style.display='inline';div.className='mxToolbarComboContainer';var select=document.createElement('select');select.className=style||'mxToolbarCombo';div.appendChild(select);this.container.appendChild(div);return select;};mxToolbar.prototype.addActionCombo=function(title,style){var select=document.createElement('select');select.className=style||'mxToolbarCombo';this.addOption(select,title,null);mxEvent.addListener(select,'change',function(evt){var value=select.options[select.selectedIndex];select.selectedIndex=0;if(value.funct!=null){value.funct(evt);}});this.container.appendChild(select);return select;};mxToolbar.prototype.addOption=function(combo,title,value){var option=document.createElement('option');mxUtils.writeln(option,title);if(typeof(value)=='function'){option.funct=value;}else{option.setAttribute('value',value);}combo.appendChild(option);return option;};mxToolbar.prototype.addSwitchMode=function(title,icon,funct,pressedIcon,style){var img=document.createElement('img');img.initialClassName=style||'mxToolbarMode';img.className=img.initialClassName;img.setAttribute('src',icon);img.altIcon=pressedIcon;if(title!=null){img.setAttribute('title',title);}mxEvent.addListener(img,'click',mxUtils.bind(this,function(evt){var tmp=this.selectedMode.altIcon;if(tmp!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute('src');this.selectedMode.setAttribute('src',tmp);}else{this.selectedMode.className=this.selectedMode.initialClassName;}if(this.updateDefaultMode){this.defaultMode=img;}this.selectedMode=img;var tmp=img.altIcon;if(tmp!=null){img.altIcon=img.getAttribute('src');img.setAttribute('src',tmp);}else{img.className=img.initialClassName+'Selected';}this.fireEvent(new mxEventObject(mxEvent.SELECT));funct();}));this.container.appendChild(img);if(this.defaultMode==null){this.defaultMode=img;this.selectedMode=img;var tmp=img.altIcon;if(tmp!=null){img.altIcon=img.getAttribute('src');img.setAttribute('src',tmp);}else{img.className=img.initialClassName+'Selected';}funct();}return img;};mxToolbar.prototype.addMode=function(title,icon,funct,pressedIcon,style,toggle){toggle=(toggle!=null)?toggle:true;var img=document.createElement((icon!=null)?'img':'button');img.initialClassName=style||'mxToolbarMode';img.className=img.initialClassName;img.setAttribute('src',icon);img.altIcon=pressedIcon;if(title!=null){img.setAttribute('title',title);}if(this.enabled&&toggle){mxEvent.addListener(img,'click',mxUtils.bind(this,function(evt){this.selectMode(img,funct);this.noReset=false;}));mxEvent.addListener(img,'dblclick',mxUtils.bind(this,function(evt){this.selectMode(img,funct);this.noReset=true;}));if(this.defaultMode==null){this.defaultMode=img;this.selectedMode=img;var tmp=img.altIcon;if(tmp!=null){img.altIcon=img.getAttribute('src');img.setAttribute('src',tmp);}else{img.className=img.initialClassName+'Selected';}}}this.container.appendChild(img);return img;};mxToolbar.prototype.selectMode=function(domNode,funct){if(this.selectedMode!=domNode){var tmp=this.selectedMode.altIcon;if(tmp!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute('src');this.selectedMode.setAttribute('src',tmp);}else{this.selectedMode.className=this.selectedMode.initialClassName;}this.selectedMode=domNode;var tmp=this.selectedMode.altIcon;if(tmp!=null){this.selectedMode.altIcon=this.selectedMode.getAttribute('src');this.selectedMode.setAttribute('src',tmp);}else{this.selectedMode.className=this.selectedMode.initialClassName+'Selected';}this.fireEvent(new mxEventObject(mxEvent.SELECT,"function",funct));}};mxToolbar.prototype.resetMode=function(forced){if((forced||!this.noReset)&&this.selectedMode!=this.defaultMode){this.selectMode(this.defaultMode,null);}};mxToolbar.prototype.addSeparator=function(icon){return this.addItem(null,icon,null);};mxToolbar.prototype.addBreak=function(){mxUtils.br(this.container);};mxToolbar.prototype.addLine=function(){var hr=document.createElement('hr');hr.style.marginRight='6px';hr.setAttribute('size','1');this.container.appendChild(hr);};mxToolbar.prototype.destroy=function(){mxEvent.release(this.container);this.container=null;this.defaultMode=null;this.selectedMode=null;if(this.menu!=null){this.menu.destroy();}};function mxSession(model,urlInit,urlPoll,urlNotify){this.model=model;this.urlInit=urlInit;this.urlPoll=urlPoll;this.urlNotify=urlNotify;if(model!=null){this.codec=new mxCodec();this.codec.lookup=function(id){return model.getCell(id);};}model.addListener(mxEvent.NOTIFY,mxUtils.bind(this,function(sender,evt){var edit=evt.getProperty('edit');if(edit!=null&&this.debug||(this.connected&&!this.suspended)){this.notify('<edit>'+this.encodeChanges(edit.changes,edit.undone)+'</edit>');}}));};mxSession.prototype=new mxEventSource();mxSession.prototype.constructor=mxSession;mxSession.prototype.model=null;mxSession.prototype.urlInit=null;mxSession.prototype.urlPoll=null;mxSession.prototype.urlNotify=null;mxSession.prototype.codec=null;mxSession.prototype.linefeed='&#xa;';mxSession.prototype.escapePostData=true;mxSession.prototype.significantRemoteChanges=true;mxSession.prototype.sent=0;mxSession.prototype.received=0;mxSession.prototype.debug=false;mxSession.prototype.connected=false;mxSession.prototype.suspended=false;mxSession.prototype.polling=false;mxSession.prototype.start=function(){if(this.debug){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));}else if(!this.connected){this.get(this.urlInit,mxUtils.bind(this,function(req){this.connected=true;this.fireEvent(new mxEventObject(mxEvent.CONNECT));this.poll();}));}};mxSession.prototype.suspend=function(){if(this.connected&&!this.suspended){this.suspended=true;this.fireEvent(new mxEventObject(mxEvent.SUSPEND));}};mxSession.prototype.resume=function(type,attr,value){if(this.connected&&this.suspended){this.suspended=false;this.fireEvent(new mxEventObject(mxEvent.RESUME));if(!this.polling){this.poll();}}};mxSession.prototype.stop=function(reason){if(this.connected){this.connected=false;}this.fireEvent(new mxEventObject(mxEvent.DISCONNECT,'reason',reason));};mxSession.prototype.poll=function(){if(this.connected&&!this.suspended&&this.urlPoll!=null){this.polling=true;this.get(this.urlPoll,mxUtils.bind(this,function(){this.poll();}));}else{this.polling=false;}};mxSession.prototype.notify=function(xml,onLoad,onError){if(xml!=null&&xml.length>0){if(this.urlNotify!=null){if(this.debug){mxLog.show();mxLog.debug('mxSession.notify: '+this.urlNotify+' xml='+xml);}else{xml='<message><delta>'+xml+'</delta></message>';if(this.escapePostData){xml=encodeURIComponent(xml);}mxUtils.post(this.urlNotify,'xml='+xml,onLoad,onError);}}this.sent+=xml.length;this.fireEvent(new mxEventObject(mxEvent.NOTIFY,'url',this.urlNotify,'xml',xml));}};mxSession.prototype.get=function(url,onLoad,onError){if(typeof(mxUtils)!='undefined'){var onErrorWrapper=mxUtils.bind(this,function(ex){if(onError!=null){onError(ex);}else{this.stop(ex);}});var req=mxUtils.get(url,mxUtils.bind(this,function(req){if(typeof(mxUtils)!='undefined'){{if(req.isReady()&&req.getStatus()!=404){this.received+=req.getText().length;this.fireEvent(new mxEventObject(mxEvent.GET,'url',url,'request',req));if(this.isValidResponse(req)){if(req.getText().length>0){var node=req.getDocumentElement();if(node==null){onErrorWrapper('Invalid response: '+req.getText());}else{this.receive(node);}}if(onLoad!=null){onLoad(req);}}}else{onErrorWrapper('Response not ready');}}}}),function(req){onErrorWrapper('Transmission error');});}};mxSession.prototype.isValidResponse=function(req){return req.getText().indexOf('<?php')<0;};mxSession.prototype.encodeChanges=function(changes,invert){var xml='';var step=(invert)?-1:1;var i0=(invert)?changes.length-1:0;for(var i=i0;i>=0&&i<changes.length;i+=step){var node=this.codec.encode(changes[i]);xml+=mxUtils.getXml(node,this.linefeed);}return xml;};mxSession.prototype.receive=function(node){if(node!=null&&node.nodeType==mxConstants.NODETYPE_ELEMENT){var ns=node.getAttribute('namespace');if(ns!=null){this.model.prefix=ns+'-';}var child=node.firstChild;while(child!=null){var name=child.nodeName.toLowerCase();if(name=='state'){this.processState(child);}else if(name=='delta'){this.processDelta(child);}child=child.nextSibling;}this.fireEvent(new mxEventObject(mxEvent.RECEIVE,'node',node));}};mxSession.prototype.processState=function(node){var dec=new mxCodec(node.ownerDocument);dec.decode(node.firstChild,this.model);};mxSession.prototype.processDelta=function(node){var edit=node.firstChild;while(edit!=null){if(edit.nodeName=='edit'){this.processEdit(edit);}edit=edit.nextSibling;}};mxSession.prototype.processEdit=function(node){var changes=this.decodeChanges(node);if(changes.length>0){var edit=this.createUndoableEdit(changes);this.model.fireEvent(new mxEventObject(mxEvent.CHANGE,'edit',edit,'changes',changes));this.model.fireEvent(new mxEventObject(mxEvent.UNDO,'edit',edit));this.fireEvent(new mxEventObject(mxEvent.FIRED,'edit',edit));}};mxSession.prototype.createUndoableEdit=function(changes){var edit=new mxUndoableEdit(this.model,this.significantRemoteChanges);edit.changes=changes;edit.notify=function(){edit.source.fireEvent(new mxEventObject(mxEvent.CHANGE,'edit',edit,'changes',edit.changes));edit.source.fireEvent(new mxEventObject(mxEvent.NOTIFY,'edit',edit,'changes',edit.changes));};return edit;};mxSession.prototype.decodeChanges=function(node){this.codec.document=node.ownerDocument;var changes=[];node=node.firstChild;while(node!=null){if(node.nodeType==mxConstants.NODETYPE_ELEMENT){var change=null;if(node.nodeName=='mxRootChange'){var tmp=new mxCodec(node.ownerDocument);change=tmp.decode(node);}else{change=this.codec.decode(node);}if(change!=null){change.model=this.model;change.execute();if(node.nodeName=='mxChildChange'&&change.parent==null){this.cellRemoved(change.child);}changes.push(change);}}node=node.nextSibling;}return changes;};mxSession.prototype.cellRemoved=function(cell,codec){this.codec.putObject(cell.getId(),cell);var childCount=this.model.getChildCount(cell);for(var i=0;i<childCount;i++){this.cellRemoved(this.model.getChildAt(cell,i));}};function mxUndoableEdit(source,significant){this.source=source;this.changes=[];this.significant=(significant!=null)?significant:true;};mxUndoableEdit.prototype.source=null;mxUndoableEdit.prototype.changes=null;mxUndoableEdit.prototype.significant=null;mxUndoableEdit.prototype.undone=false;mxUndoableEdit.prototype.redone=false;mxUndoableEdit.prototype.isEmpty=function(){return this.changes.length==0;};mxUndoableEdit.prototype.isSignificant=function(){return this.significant;};mxUndoableEdit.prototype.add=function(change){this.changes.push(change);};mxUndoableEdit.prototype.notify=function(){};mxUndoableEdit.prototype.die=function(){};mxUndoableEdit.prototype.undo=function(){if(!this.undone){var count=this.changes.length;for(var i=count-1;i>=0;i--){var change=this.changes[i];if(change.execute!=null){change.execute();}else if(change.undo!=null){change.undo();}}this.undone=true;this.redone=false;}this.notify();};mxUndoableEdit.prototype.redo=function(){if(!this.redone){var count=this.changes.length;for(var i=0;i<count;i++){var change=this.changes[i];if(change.execute!=null){change.execute();}else if(change.redo!=null){change.redo();}}this.undone=false;this.redone=true;}this.notify();};function mxUndoManager(size){this.size=(size!=null)?size:100;this.clear();};mxUndoManager.prototype=new mxEventSource();mxUndoManager.prototype.constructor=mxUndoManager;mxUndoManager.prototype.size=null;mxUndoManager.prototype.history=null;mxUndoManager.prototype.indexOfNextAdd=0;mxUndoManager.prototype.isEmpty=function(){return this.history.length==0;};mxUndoManager.prototype.clear=function(){this.history=[];this.indexOfNextAdd=0;this.fireEvent(new mxEventObject(mxEvent.CLEAR));};mxUndoManager.prototype.canUndo=function(){return this.indexOfNextAdd>0;};mxUndoManager.prototype.undo=function(){while(this.indexOfNextAdd>0){var edit=this.history[--this.indexOfNextAdd];edit.undo();if(edit.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.UNDO,'edit',edit));break;}}};mxUndoManager.prototype.canRedo=function(){return this.indexOfNextAdd<this.history.length;};mxUndoManager.prototype.redo=function(){var n=this.history.length;while(this.indexOfNextAdd<n){var edit=this.history[this.indexOfNextAdd++];edit.redo();if(edit.isSignificant()){this.fireEvent(new mxEventObject(mxEvent.REDO,'edit',edit));break;}}};mxUndoManager.prototype.undoableEditHappened=function(undoableEdit){this.trim();if(this.size>0&&this.size==this.history.length){this.history.shift();}this.history.push(undoableEdit);this.indexOfNextAdd=this.history.length;this.fireEvent(new mxEventObject(mxEvent.ADD,'edit',undoableEdit));};mxUndoManager.prototype.trim=function(){if(this.history.length>this.indexOfNextAdd){var edits=this.history.splice(this.indexOfNextAdd,this.history.length-this.indexOfNextAdd);for(var i=0;i<edits.length;i++){edits[i].die();}}};var mxUrlConverter=function(root){var enabled=true;var baseUrl=null;var updateBaseUrl=function(){baseUrl=document.URL;var tmp=baseUrl.lastIndexOf('/');if(tmp>0){baseUrl=baseUrl.substring(0,tmp+1);}};return{isEnabled:function(){return enabled;},setEnabled:function(value){enabled=value;},getBaseUrl:function(){return baseUrl;},setBaseUrl:function(value){baseUrl=value;},convert:function(url){if(enabled&&url.indexOf('http://')!=0&&url.indexOf('https://')!=0&&url.indexOf('data:image')!=0){if(baseUrl==null){updateBaseUrl();}url=baseUrl+url;}return url;}};};function mxPanningManager(graph){this.thread=null;this.active=false;this.tdx=0;this.tdy=0;this.t0x=0;this.t0y=0;this.dx=0;this.dy=0;this.mouseListener={mouseDown:function(sender,me){},mouseMove:function(sender,me){},mouseUp:mxUtils.bind(this,function(sender,me){if(this.active){this.stop();}})};graph.addMouseListener(this.mouseListener);var createThread=mxUtils.bind(this,function(){return window.setInterval(mxUtils.bind(this,function(){this.tdx-=this.dx;this.tdy-=this.dy;graph.panGraph(this.getDx(),this.getDy());}),this.delay);});this.isActive=function(){return active;};this.getDx=function(){return Math.round(this.tdx);};this.getDy=function(){return Math.round(this.tdy);};this.start=function(){this.t0x=graph.view.translate.x;this.t0y=graph.view.translate.y;this.active=true;};this.panTo=function(x,y,w,h){if(!this.active){this.start();}w=(w!=null)?w:0;h=(h!=null)?h:0;var c=graph.container;this.dx=x+w-c.scrollLeft-c.clientWidth;if(this.dx<0&&Math.abs(this.dx)<this.border){this.dx=this.border+this.dx;}else if(this.handleMouseOut){this.dx=Math.max(this.dx,0);}else{this.dx=0;}if(this.dx==0){this.dx=x-c.scrollLeft;if(this.dx>0&&this.dx<this.border){this.dx=this.dx-this.border;}else if(this.handleMouseOut){this.dx=Math.min(0,this.dx);}else{this.dx=0;}}this.dy=y+h-c.scrollTop-c.clientHeight;if(this.dy<0&&Math.abs(this.dy)<this.border){this.dy=this.border+this.dy;}else if(this.handleMouseOut){this.dy=Math.max(this.dy,0);}else{this.dy=0;}if(this.dy==0){this.dy=y-c.scrollTop;if(this.dy>0&&this.dy<this.border){this.dy=this.dy-this.border;}else if(this.handleMouseOut){this.dy=Math.min(0,this.dy);}else{this.dy=0;}}if(this.dx!=0||this.dy!=0){this.dx*=this.damper;this.dy*=this.damper;if(this.thread==null){this.thread=createThread();}}else if(this.thread!=null){window.clearInterval(this.thread);this.thread=null;}};this.stop=function(){if(this.active){this.active=false;var px=graph.panDx;var py=graph.panDy;if(this.thread!=null){window.clearInterval(this.thread);this.thread=null;}if(px!=0||py!=0){graph.panGraph(0,0);graph.view.setTranslate(this.t0x+px/graph.view.scale,this.t0y+py/graph.view.scale);this.tdx=0;this.tdy=0;}}};this.destroy=function(){graph.removeMouseListener(this.mouseListener);};};mxPanningManager.prototype.damper=1/6;mxPanningManager.prototype.delay=10;mxPanningManager.prototype.handleMouseOut=true;mxPanningManager.prototype.border=0;function mxPath(format){this.format=format;this.path=[];this.translate=new mxPoint(0,0);};mxPath.prototype.format=null;mxPath.prototype.translate=null;mxPath.prototype.scale=1;mxPath.prototype.path=null;mxPath.prototype.isVml=function(){return this.format=='vml';};mxPath.prototype.getPath=function(){return this.path.join('');};mxPath.prototype.setTranslate=function(x,y){this.translate=new mxPoint(x,y);};mxPath.prototype.moveTo=function(x,y){x+=this.translate.x;y+=this.translate.y;x*=this.scale;y*=this.scale;if(this.isVml()){this.path.push('m ',Math.round(x),' ',Math.round(y),' ');}else{this.path.push('M ',x,' ',y,' ');}};mxPath.prototype.lineTo=function(x,y){x+=this.translate.x;y+=this.translate.y;x*=this.scale;y*=this.scale;if(this.isVml()){this.path.push('l ',Math.round(x),' ',Math.round(y),' ');}else{this.path.push('L ',x,' ',y,' ');}};mxPath.prototype.quadTo=function(x1,y1,x,y){x1+=this.translate.x;y1+=this.translate.y;x1*=this.scale;y1*=this.scale;x+=this.translate.x;y+=this.translate.y;x*=this.scale;y*=this.scale;if(this.isVml()){this.path.push('c ',Math.round(x1),' ',Math.round(y1),' ',Math.round(x),' ',Math.round(y),' ',Math.round(x),' ',Math.round(y),' ');}else{this.path.push('Q ',x1,' ',y1,' ',x,' ',y,' ');}};mxPath.prototype.curveTo=function(x1,y1,x2,y2,x,y){x1+=this.translate.x;y1+=this.translate.y;x1*=this.scale;y1*=this.scale;x2+=this.translate.x;y2+=this.translate.y;x2*=this.scale;y2*=this.scale;x+=this.translate.x;y+=this.translate.y;x*=this.scale;y*=this.scale;if(this.isVml()){this.path.push('c ',Math.round(x1),' ',Math.round(y1),' ',Math.round(x2),' ',Math.round(y2),' ',Math.round(x),' ',Math.round(y),' ');}else{this.path.push('C ',x1,' ',y1,' ',x2,' ',y2,' ',x,' ',y,' ');}};mxPath.prototype.addPath=function(path){this.path=this.path.concat(path.path);};mxPath.prototype.write=function(string){this.path.push(string,' ');};mxPath.prototype.end=function(){if(this.format=='vml'){this.path.push('e');}};mxPath.prototype.close=function(){if(this.format=='vml'){this.path.push('x e');}else{this.path.push('Z');}};function mxPopupMenu(factoryMethod){this.factoryMethod=factoryMethod;if(factoryMethod!=null){this.init();}};mxPopupMenu.prototype=new mxEventSource();mxPopupMenu.prototype.constructor=mxPopupMenu;mxPopupMenu.prototype.submenuImage=mxClient.imageBasePath+'/submenu.gif';mxPopupMenu.prototype.zIndex=10006;mxPopupMenu.prototype.factoryMethod=null;mxPopupMenu.prototype.useLeftButtonForPopup=false;mxPopupMenu.prototype.enabled=true;mxPopupMenu.prototype.itemCount=0;mxPopupMenu.prototype.autoExpand=false;mxPopupMenu.prototype.smartSeparators=false;mxPopupMenu.prototype.labels=true;mxPopupMenu.prototype.init=function(){this.table=document.createElement('table');this.table.className='mxPopupMenu';this.tbody=document.createElement('tbody');this.table.appendChild(this.tbody);this.div=document.createElement('div');this.div.className='mxPopupMenu';this.div.style.display='inline';this.div.style.zIndex=this.zIndex;this.div.appendChild(this.table);mxEvent.disableContextMenu(this.div);};mxPopupMenu.prototype.isEnabled=function(){return this.enabled;};mxPopupMenu.prototype.setEnabled=function(enabled){this.enabled=enabled;};mxPopupMenu.prototype.isPopupTrigger=function(me){return me.isPopupTrigger()||(this.useLeftButtonForPopup&&mxEvent.isLeftMouseButton(me.getEvent()));};mxPopupMenu.prototype.addItem=function(title,image,funct,parent,iconCls,enabled){parent=parent||this;this.itemCount++;if(parent.willAddSeparator){if(parent.containsItems){this.addSeparator(parent,true);}parent.willAddSeparator=false;}parent.containsItems=true;var tr=document.createElement('tr');tr.className='mxPopupMenuItem';var col1=document.createElement('td');col1.className='mxPopupMenuIcon';if(image!=null){var img=document.createElement('img');img.src=image;col1.appendChild(img);}else if(iconCls!=null){var div=document.createElement('div');div.className=iconCls;col1.appendChild(div);}tr.appendChild(col1);if(this.labels){var col2=document.createElement('td');col2.className='mxPopupMenuItem'+((enabled!=null&&!enabled)?' disabled':'');mxUtils.write(col2,title);col2.align='left';tr.appendChild(col2);var col3=document.createElement('td');col3.className='mxPopupMenuItem'+((enabled!=null&&!enabled)?' disabled':'');col3.style.paddingRight='6px';col3.style.textAlign='right';tr.appendChild(col3);if(parent.div==null){this.createSubmenu(parent);}}parent.tbody.appendChild(tr);if(enabled==null||enabled){var md=(mxClient.IS_TOUCH)?'touchstart':'mousedown';var mm=(mxClient.IS_TOUCH)?'touchmove':'mousemove';var mu=(mxClient.IS_TOUCH)?'touchend':'mouseup';mxEvent.addListener(tr,md,mxUtils.bind(this,function(evt){this.eventReceiver=tr;if(parent.activeRow!=tr&&parent.activeRow!=parent){if(parent.activeRow!=null&&parent.activeRow.div.parentNode!=null){this.hideSubmenu(parent);}if(tr.div!=null){this.showSubmenu(parent,tr);parent.activeRow=tr;}}mxEvent.consume(evt);}));mxEvent.addListener(tr,mm,mxUtils.bind(this,function(evt){if(parent.activeRow!=tr&&parent.activeRow!=parent){if(parent.activeRow!=null&&parent.activeRow.div.parentNode!=null){this.hideSubmenu(parent);}if(this.autoExpand&&tr.div!=null){this.showSubmenu(parent,tr);parent.activeRow=tr;}}tr.className='mxPopupMenuItemHover';}));mxEvent.addListener(tr,mu,mxUtils.bind(this,function(evt){if(this.eventReceiver==tr){if(parent.activeRow!=tr){this.hideMenu();}if(funct!=null){funct(evt);}}this.eventReceiver=null;mxEvent.consume(evt);}));mxEvent.addListener(tr,'mouseout',mxUtils.bind(this,function(evt){tr.className='mxPopupMenuItem';}));}return tr;};mxPopupMenu.prototype.createSubmenu=function(parent){parent.table=document.createElement('table');parent.table.className='mxPopupMenu';parent.tbody=document.createElement('tbody');parent.table.appendChild(parent.tbody);parent.div=document.createElement('div');parent.div.className='mxPopupMenu';parent.div.style.position='absolute';parent.div.style.display='inline';parent.div.style.zIndex=this.zIndex;parent.div.appendChild(parent.table);var img=document.createElement('img');img.setAttribute('src',this.submenuImage);td=parent.firstChild.nextSibling.nextSibling;td.appendChild(img);};mxPopupMenu.prototype.showSubmenu=function(parent,row){if(row.div!=null){row.div.style.left=(parent.div.offsetLeft+row.offsetLeft+row.offsetWidth-1)+'px';row.div.style.top=(parent.div.offsetTop+row.offsetTop)+'px';document.body.appendChild(row.div);var left=parseInt(row.div.offsetLeft);var width=parseInt(row.div.offsetWidth);var b=document.body;var d=document.documentElement;var right=(b.scrollLeft||d.scrollLeft)+(b.clientWidth||d.clientWidth);if(left+width>right){row.div.style.left=(parent.div.offsetLeft-width+((mxClient.IS_IE)?6:-6))+'px';}mxUtils.fit(row.div);}};mxPopupMenu.prototype.addSeparator=function(parent,force){parent=parent||this;if(this.smartSeparators&&!force){parent.willAddSeparator=true;}else if(parent.tbody!=null){parent.willAddSeparator=false;var tr=document.createElement('tr');var col1=document.createElement('td');col1.className='mxPopupMenuIcon';col1.style.padding='0 0 0 0px';tr.appendChild(col1);var col2=document.createElement('td');col2.style.padding='0 0 0 0px';col2.setAttribute('colSpan','2');var hr=document.createElement('hr');hr.setAttribute('size','1');col2.appendChild(hr);tr.appendChild(col2);parent.tbody.appendChild(tr);}};mxPopupMenu.prototype.popup=function(x,y,cell,evt){if(this.div!=null&&this.tbody!=null&&this.factoryMethod!=null){this.div.style.left=x+'px';this.div.style.top=y+'px';while(this.tbody.firstChild!=null){mxEvent.release(this.tbody.firstChild);this.tbody.removeChild(this.tbody.firstChild);}this.itemCount=0;this.factoryMethod(this,cell,evt);if(this.itemCount>0){this.showMenu();this.fireEvent(new mxEventObject(mxEvent.SHOW));}}};mxPopupMenu.prototype.isMenuShowing=function(){return this.div!=null&&this.div.parentNode==document.body;};mxPopupMenu.prototype.showMenu=function(){if(document.documentMode>=9){this.div.style.filter='none';}document.body.appendChild(this.div);mxUtils.fit(this.div);};mxPopupMenu.prototype.hideMenu=function(){if(this.div!=null){if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div);}this.hideSubmenu(this);this.containsItems=false;}};mxPopupMenu.prototype.hideSubmenu=function(parent){if(parent.activeRow!=null){this.hideSubmenu(parent.activeRow);if(parent.activeRow.div.parentNode!=null){parent.activeRow.div.parentNode.removeChild(parent.activeRow.div);}parent.activeRow=null;}};mxPopupMenu.prototype.destroy=function(){if(this.div!=null){mxEvent.release(this.div);if(this.div.parentNode!=null){this.div.parentNode.removeChild(this.div);}this.div=null;}};function mxAutoSaveManager(graph){this.changeHandler=mxUtils.bind(this,function(sender,evt){if(this.isEnabled()){this.graphModelChanged(evt.getProperty('edit').changes);}});this.setGraph(graph);};mxAutoSaveManager.prototype=new mxEventSource();mxAutoSaveManager.prototype.constructor=mxAutoSaveManager;mxAutoSaveManager.prototype.graph=null;mxAutoSaveManager.prototype.autoSaveDelay=10;mxAutoSaveManager.prototype.autoSaveThrottle=2;mxAutoSaveManager.prototype.autoSaveThreshold=5;mxAutoSaveManager.prototype.ignoredChanges=0;mxAutoSaveManager.prototype.lastSnapshot=0;mxAutoSaveManager.prototype.enabled=true;mxAutoSaveManager.prototype.changeHandler=null;mxAutoSaveManager.prototype.isEnabled=function(){return this.enabled;};mxAutoSaveManager.prototype.setEnabled=function(value){this.enabled=value;};mxAutoSaveManager.prototype.setGraph=function(graph){if(this.graph!=null){this.graph.getModel().removeListener(this.changeHandler);}this.graph=graph;if(this.graph!=null){this.graph.getModel().addListener(mxEvent.CHANGE,this.changeHandler);}};mxAutoSaveManager.prototype.save=function(){};mxAutoSaveManager.prototype.graphModelChanged=function(changes){var now=new Date().getTime();var dt=(now-this.lastSnapshot)/1000;if(dt>this.autoSaveDelay||(this.ignoredChanges>=this.autoSaveThreshold&&dt>this.autoSaveThrottle)){this.save();this.reset();}else{this.ignoredChanges++;}};mxAutoSaveManager.prototype.reset=function(){this.lastSnapshot=new Date().getTime();this.ignoredChanges=0;};mxAutoSaveManager.prototype.destroy=function(){this.setGraph(null);};function mxAnimation(delay){this.delay=(delay!=null)?delay:20;};mxAnimation.prototype=new mxEventSource();mxAnimation.prototype.constructor=mxAnimation;mxAnimation.prototype.delay=null;mxAnimation.prototype.thread=null;mxAnimation.prototype.startAnimation=function(){if(this.thread==null){this.thread=window.setInterval(mxUtils.bind(this,this.updateAnimation),this.delay);}};mxAnimation.prototype.updateAnimation=function(){this.fireEvent(new mxEventObject(mxEvent.EXECUTE));};mxAnimation.prototype.stopAnimation=function(){if(this.thread!=null){window.clearInterval(this.thread);this.thread=null;this.fireEvent(new mxEventObject(mxEvent.DONE));}};function mxMorphing(graph,steps,ease,delay){mxAnimation.call(this,delay);this.graph=graph;this.steps=(steps!=null)?steps:6;this.ease=(ease!=null)?ease:1.5;};mxMorphing.prototype=new mxAnimation();mxMorphing.prototype.constructor=mxMorphing;mxMorphing.prototype.graph=null;mxMorphing.prototype.steps=null;mxMorphing.prototype.step=0;mxMorphing.prototype.ease=null;mxMorphing.prototype.cells=null;mxMorphing.prototype.updateAnimation=function(){var move=new mxCellStatePreview(this.graph);if(this.cells!=null){for(var i=0;i<this.cells.length;i++){this.animateCell(cells[i],move,false);}}else{this.animateCell(this.graph.getModel().getRoot(),move,true);}this.show(move);if(move.isEmpty()||this.step++>=this.steps){this.stopAnimation();}};mxMorphing.prototype.show=function(move){move.show();};mxMorphing.prototype.animateCell=function(cell,move,recurse){var state=this.graph.getView().getState(cell);var delta=null;if(state!=null){delta=this.getDelta(state);if(this.graph.getModel().isVertex(cell)&&(delta.x!=0||delta.y!=0)){var translate=this.graph.view.getTranslate();var scale=this.graph.view.getScale();delta.x+=translate.x*scale;delta.y+=translate.y*scale;move.moveState(state,-delta.x/this.ease,-delta.y/this.ease);}}if(recurse&&!this.stopRecursion(state,delta)){var childCount=this.graph.getModel().getChildCount(cell);for(var i=0;i<childCount;i++){this.animateCell(this.graph.getModel().getChildAt(cell,i),move,recurse);}}};mxMorphing.prototype.stopRecursion=function(state,delta){return delta!=null&&(delta.x!=0||delta.y!=0);};mxMorphing.prototype.getDelta=function(state){var origin=this.getOriginForCell(state.cell);var translate=this.graph.getView().getTranslate();var scale=this.graph.getView().getScale();var current=new mxPoint(state.x/scale-translate.x,state.y/scale-translate.y);return new mxPoint((origin.x-current.x)*scale,(origin.y-current.y)*scale);};mxMorphing.prototype.getOriginForCell=function(cell){var result=null;if(cell!=null){result=this.getOriginForCell(this.graph.getModel().getParent(cell));var geo=this.graph.getCellGeometry(cell);if(geo!=null){result.x+=geo.x;result.y+=geo.y;}}if(result==null){var t=this.graph.view.getTranslate();result=new mxPoint(-t.x,-t.y);}return result;};function mxImageBundle(alt){this.images=[];this.alt=(alt!=null)?alt:false;};mxImageBundle.prototype.images=null;mxImageBundle.prototype.images=null;mxImageBundle.prototype.putImage=function(key,value,fallback){this.images[key]={value:value,fallback:fallback};};mxImageBundle.prototype.getImage=function(key){var result=null;if(key!=null){var img=this.images[key];if(img!=null){result=(this.alt)?img.fallback:img.value;}}return result;};function mxImageExport(){this.initShapes();this.initMarkers();};mxImageExport.prototype.includeOverlays=false;mxImageExport.prototype.glassSize=0.4;mxImageExport.prototype.shapes=null;mxImageExport.prototype.markers=null;mxImageExport.prototype.drawState=function(state,canvas){if(state!=null){if(state.shape!=null){var shape=(state.shape.stencil!=null)?state.shape.stencil:this.shapes[state.style[mxConstants.STYLE_SHAPE]];if(shape==null){if(typeof(state.shape.redrawPath)=='function'){shape=this.createShape(state,canvas);}else if(state.view.graph.getModel().isVertex(state.cell)){shape=this.shapes['rectangle'];}}if(shape!=null){this.drawShape(state,canvas,shape);if(this.includeOverlays){this.drawOverlays(state,canvas);}}}var graph=state.view.graph;var childCount=graph.model.getChildCount(state.cell);for(var i=0;i<childCount;i++){var childState=graph.view.getState(graph.model.getChildAt(state.cell,i));this.drawState(childState,canvas);}}};mxImageExport.prototype.createShape=function(state,canvas){return{drawShape:function(canvas,state,bounds,background){var path={translate:new mxPoint(bounds.x,bounds.y),moveTo:function(x,y){canvas.moveTo(this.translate.x+x,this.translate.y+y);},lineTo:function(x,y){canvas.lineTo(this.translate.x+x,this.translate.y+y);},quadTo:function(x1,y1,x,y){canvas.quadTo(this.translate.x+x1,this.translate.y+y1,this.translate.x+x,this.translate.y+y);},curveTo:function(x1,y1,x2,y2,x,y){canvas.curveTo(this.translate.x+x1,this.translate.y+y1,this.translate.x+x2,this.translate.y+y2,this.translate.x+x,this.translate.y+y);},end:function(){},close:function(){canvas.close();}};if(!background){canvas.fillAndStroke();}canvas.begin();state.shape.redrawPath.call(state.shape,path,bounds.x,bounds.y,bounds.width,bounds.height,!background);if(!background){canvas.fillAndStroke();}return true;}};};mxImageExport.prototype.drawOverlays=function(state,canvas){if(state.overlays!=null){for(var i=0;i<state.overlays.length;i++){if(state.overlays[i].bounds!=null){var bounds=state.overlays[i].bounds;canvas.image(bounds.x,bounds.y,bounds.width,bounds.height,state.overlays[i].image);}}}};mxImageExport.prototype.drawShape=function(state,canvas,shape){var rotation=mxUtils.getNumber(state.style,mxConstants.STYLE_ROTATION,0);var direction=mxUtils.getValue(state.style,mxConstants.STYLE_DIRECTION,null);if(direction!=null){if(direction=='north'){rotation+=270;}else if(direction=='west'){rotation+=180;}else if(direction=='south'){rotation+=90;}}var flipH=state.style[mxConstants.STYLE_STENCIL_FLIPH];var flipV=state.style[mxConstants.STYLE_STENCIL_FLIPV];if(flipH&&flipV){rotation+=180;flipH=false;flipV=false;}canvas.save();rotation=rotation%360;if(rotation!=0||flipH||flipV){canvas.rotate(rotation,flipH,flipV,state.getCenterX(),state.getCenterY());}var scale=state.view.scale;var sw=mxUtils.getNumber(state.style,mxConstants.STYLE_STROKEWIDTH,1)*scale;canvas.setStrokeWidth(sw);var sw2=sw/2;var bg=this.getBackgroundBounds(state);if(state.shape.stencil==null&&(direction=='south'||direction=='north')){var dx=(bg.width-bg.height)/2;bg.x+=dx;bg.y+=-dx;var tmp=bg.width;bg.width=bg.height;bg.height=tmp;}var bb=new mxRectangle(bg.x-sw2,bg.y-sw2,bg.width+sw,bg.height+sw);var alpha=mxUtils.getValue(state.style,mxConstants.STYLE_OPACITY,100)/100;var shp=state.style[mxConstants.STYLE_SHAPE];var imageShape=shp==mxConstants.SHAPE_IMAGE;var gradientColor=(imageShape)?null:mxUtils.getValue(state.style,mxConstants.STYLE_GRADIENTCOLOR);if(gradientColor==mxConstants.NONE){gradientColor=null;}var fcKey=(imageShape)?mxConstants.STYLE_IMAGE_BACKGROUND:mxConstants.STYLE_FILLCOLOR;var fillColor=mxUtils.getValue(state.style,fcKey,null);if(fillColor==mxConstants.NONE){fillColor=null;}var scKey=(imageShape)?mxConstants.STYLE_IMAGE_BORDER:mxConstants.STYLE_STROKECOLOR;var strokeColor=mxUtils.getValue(state.style,scKey,null);if(strokeColor==mxConstants.NONE){strokeColor=null;}var glass=(fillColor!=null&&(shp==mxConstants.SHAPE_LABEL||shp==mxConstants.SHAPE_RECTANGLE));if(mxUtils.getValue(state.style,mxConstants.STYLE_SHADOW,false)){this.drawShadow(canvas,state,shape,rotation,flipH,flipV,bg,alpha,fillColor!=null);}canvas.setAlpha(alpha);if(mxUtils.getValue(state.style,mxConstants.STYLE_DASHED,'0')=='1'){canvas.setDashed(true);var dash=state.style['dashPattern'];if(dash!=null){canvas.setDashPattern(dash);}}if(strokeColor!=null||fillColor!=null){if(strokeColor!=null){canvas.setStrokeColor(strokeColor);}if(fillColor!=null){if(gradientColor!=null&&gradientColor!='transparent'){canvas.setGradient(fillColor,gradientColor,bg.x,bg.y,bg.width,bg.height,direction);}else{canvas.setFillColor(fillColor);}}glass=shape.drawShape(canvas,state,bg,true,false)&&glass;shape.drawShape(canvas,state,bg,false,false);}if(glass&&mxUtils.getValue(state.style,mxConstants.STYLE_GLASS,0)==1){this.drawGlass(state,canvas,bb,shape,this.glassSize);}if(imageShape||shp==mxConstants.SHAPE_LABEL){var src=state.view.graph.getImage(state);if(src!=null){var imgBounds=this.getImageBounds(state);if(imgBounds!=null){this.drawImage(state,canvas,imgBounds,src);}}}canvas.restore();var txt=state.text;var label=state.view.graph.getLabel(state.cell);if(txt!=null&&label!=null&&label.length>0){canvas.save();canvas.setAlpha(mxUtils.getValue(state.style,mxConstants.STYLE_TEXT_OPACITY,100)/100);var bounds=new mxRectangle(txt.boundingBox.x,txt.boundingBox.y,txt.boundingBox.width,txt.boundingBox.height);var vert=mxUtils.getValue(state.style,mxConstants.STYLE_HORIZONTAL,1)==0;bounds.y+=2;if(vert){if(txt.dialect!=mxConstants.DIALECT_SVG){var cx=bounds.x+bounds.width/2;var cy=bounds.y+bounds.height/2;var tmp=bounds.width;bounds.width=bounds.height;bounds.height=tmp;bounds.x=cx-bounds.width/2;bounds.y=cy-bounds.height/2;}else if(txt.dialect==mxConstants.DIALECT_SVG){var b=state.y+state.height;var cx=bounds.getCenterX()-state.x;var cy=bounds.getCenterY()-state.y;var y=b-cx-bounds.height/2;bounds.x=state.x+cy-bounds.width/2;bounds.y=y;}}this.drawLabelBackground(state,canvas,bounds,vert);this.drawLabel(state,canvas,bounds,vert,label);canvas.restore();}};mxImageExport.prototype.drawShadow=function(canvas,state,shape,rotation,flipH,flipV,bounds,alpha,filled){var rad=rotation*Math.PI/180;var cos=Math.cos(-rad);var sin=Math.sin(-rad);var offset=mxUtils.getRotatedPoint(new mxPoint(mxConstants.SHADOW_OFFSET_X,mxConstants.SHADOW_OFFSET_Y),cos,sin);if(flipH){offset.x*=-1;}if(flipV){offset.y*=-1;}canvas.translate(offset.x,offset.y);if(shape.drawShape(canvas,state,bounds,true,true)){canvas.setAlpha(mxConstants.SHADOW_OPACITY*alpha);canvas.shadow(mxConstants.SHADOWCOLOR,filled);}canvas.translate(-offset.x,-offset.y);};mxImageExport.prototype.drawGlass=function(state,canvas,bounds,shape,size){if(shape.drawShape(canvas,state,bounds,true,false)){canvas.save();canvas.clip();canvas.setGlassGradient(bounds.x,bounds.y,bounds.width,bounds.height);canvas.begin();canvas.moveTo(bounds.x,bounds.y);canvas.lineTo(bounds.x,(bounds.y+bounds.height*size));canvas.quadTo((bounds.x+bounds.width*0.5),(bounds.y+bounds.height*0.7),bounds.x+bounds.width,(bounds.y+bounds.height*size));canvas.lineTo(bounds.x+bounds.width,bounds.y);canvas.close();canvas.fill();canvas.restore();}};mxImageExport.prototype.drawImage=function(state,canvas,bounds,image){var aspect=mxUtils.getValue(state.style,mxConstants.STYLE_IMAGE_ASPECT,1)==1;var flipH=mxUtils.getValue(state.style,mxConstants.STYLE_IMAGE_FLIPH,0)==1;var flipV=mxUtils.getValue(state.style,mxConstants.STYLE_IMAGE_FLIPV,0)==1;canvas.image(bounds.x,bounds.y,bounds.width,bounds.height,image,aspect,flipH,flipV);};mxImageExport.prototype.drawLabelBackground=function(state,canvas,bounds,vert){var stroke=mxUtils.getValue(state.style,mxConstants.STYLE_LABEL_BORDERCOLOR);var fill=mxUtils.getValue(state.style,mxConstants.STYLE_LABEL_BACKGROUNDCOLOR);if(stroke==mxConstants.NONE){stroke=null;}if(fill==mxConstants.NONE){fill=null;}if(stroke!=null||fill!=null){var x=bounds.x;var y=bounds.y-mxUtils.getValue(state.style,mxConstants.STYLE_LABEL_PADDING,0);var w=bounds.width;var h=bounds.height;if(vert){x+=(w-h)/2;y+=(h-w)/2;var tmp=w;w=h;h=tmp;}if(fill!=null){canvas.setFillColor(fill);}if(stroke!=null){canvas.setStrokeColor(stroke);canvas.setStrokeWidth(1);canvas.setDashed(false);}canvas.rect(x,y,w,h);if(fill!=null&&stroke!=null){canvas.fillAndStroke();}else if(fill!=null){canvas.fill();}else if(stroke!=null){canvas.stroke();}}};mxImageExport.prototype.drawLabel=function(state,canvas,bounds,vert,str){var scale=state.view.scale;canvas.setFontColor(mxUtils.getValue(state.style,mxConstants.STYLE_FONTCOLOR,'#000000'));canvas.setFontFamily(mxUtils.getValue(state.style,mxConstants.STYLE_FONTFAMILY,mxConstants.DEFAULT_FONTFAMILY));canvas.setFontStyle(mxUtils.getValue(state.style,mxConstants.STYLE_FONTSTYLE,0));canvas.setFontSize(mxUtils.getValue(state.style,mxConstants.STYLE_FONTSIZE,mxConstants.DEFAULT_FONTSIZE)*scale);var align=mxUtils.getValue(state.style,mxConstants.STYLE_ALIGN,mxConstants.ALIGN_LEFT);if(align=='left'){align=null;}var y=bounds.y-mxUtils.getValue(state.style,mxConstants.STYLE_LABEL_PADDING,0);var wrap=state.view.graph.isWrapping(state.cell);var html=state.view.graph.isHtmlLabel(state.cell);if(html&&mxText.prototype.replaceLinefeeds){str=str.replace(/\n/g,'<br/>');}canvas.text(bounds.x,y,bounds.width,bounds.height,str,align,null,vert,wrap,(html)?'html':'');};mxImageExport.prototype.getBackgroundBounds=function(state){if(state.style[mxConstants.STYLE_SHAPE]==mxConstants.SHAPE_SWIMLANE){var scale=state.view.scale;var start=mxUtils.getValue(state.style,mxConstants.STYLE_STARTSIZE,mxConstants.DEFAULT_STARTSIZE)*scale;var w=state.width;var h=state.height;if(mxUtils.getValue(state.style,mxConstants.STYLE_HORIZONTAL,true)){h=start;}else{w=start;}return new mxRectangle(state.x,state.y,Math.min(state.width,w),Math.min(state.height,h));}else{return new mxRectangle(state.x,state.y,state.width,state.height);}};mxImageExport.prototype.getImageBounds=function(state){var bounds=new mxRectangle(state.x,state.y,state.width,state.height);var style=state.style;if(mxUtils.getValue(style,mxConstants.STYLE_SHAPE)!=mxConstants.SHAPE_IMAGE){var imgAlign=mxUtils.getValue(style,mxConstants.STYLE_IMAGE_ALIGN,mxConstants.ALIGN_LEFT);var imgValign=mxUtils.getValue(style,mxConstants.STYLE_IMAGE_VERTICAL_ALIGN,mxConstants.ALIGN_MIDDLE);var imgWidth=mxUtils.getValue(style,mxConstants.STYLE_IMAGE_WIDTH,mxConstants.DEFAULT_IMAGESIZE);var imgHeight=mxUtils.getValue(style,mxConstants.STYLE_IMAGE_HEIGHT,mxConstants.DEFAULT_IMAGESIZE);var spacing=mxUtils.getValue(style,mxConstants.STYLE_SPACING,2);if(imgAlign==mxConstants.ALIGN_CENTER){bounds.x+=(bounds.width-imgWidth)/2;}else if(imgAlign==mxConstants.ALIGN_RIGHT){bounds.x+=bounds.width-imgWidth-spacing-2;}else {bounds.x+=spacing+4;}if(imgValign==mxConstants.ALIGN_TOP){bounds.y+=spacing;}else if(imgValign==mxConstants.ALIGN_BOTTOM){bounds.y+=bounds.height-imgHeight-spacing;}else {bounds.y+=(bounds.height-imgHeight)/2;}bounds.width=imgWidth;bounds.height=imgHeight;}return bounds;};mxImageExport.prototype.drawMarker=function(canvas,state,source){var offset=null;var pts=state.absolutePoints;var n=pts.length;var p0=(source)?pts[1]:pts[n-2];var pe=(source)?pts[0]:pts[n-1];var dx=pe.x-p0.x;var dy=pe.y-p0.y;var dist=Math.max(1,Math.sqrt(dx*dx+dy*dy));var unitX=dx/dist;var unitY=dy/dist;var size=mxUtils.getValue(state.style,(source)?mxConstants.STYLE_STARTSIZE:mxConstants.STYLE_ENDSIZE,mxConstants.DEFAULT_MARKERSIZE);var sw=mxUtils.getValue(state.style,mxConstants.STYLE_STROKEWIDTH,1);pe=pe.clone();var type=mxUtils.getValue(state.style,(source)?mxConstants.STYLE_STARTARROW:mxConstants.STYLE_ENDARROW);var f=this.markers[type];if(f!=null){offset=f(canvas,state,type,pe,unitX,unitY,size,source,sw);}return offset;};mxImageExport.prototype.initShapes=function(){this.shapes=[];this.shapes['rectangle']={drawShape:function(canvas,state,bounds,background){if(background){if(mxUtils.getValue(state.style,mxConstants.STYLE_ROUNDED,false)){var f=mxUtils.getValue(state.style,mxConstants.STYLE_ARCSIZE,mxConstants.RECTANGLE_ROUNDING_FACTOR*100)/100;var r=Math.min(bounds.width*f,bounds.height*f);canvas.roundrect(bounds.x,bounds.y,bounds.width,bounds.height,r,r);}else{canvas.rect(bounds.x,bounds.y,bounds.width,bounds.height);}return true;}else{canvas.fillAndStroke();}}};this.shapes['swimlane']={drawShape:function(canvas,state,bounds,background){if(background){if(mxUtils.getValue(state.style,mxConstants.STYLE_ROUNDED,false)){var r=Math.min(bounds.width*mxConstants.RECTANGLE_ROUNDING_FACTOR,bounds.height*mxConstants.RECTANGLE_ROUNDING_FACTOR);canvas.roundrect(bounds.x,bounds.y,bounds.width,bounds.height,r,r);}else{canvas.rect(bounds.x,bounds.y,bounds.width,bounds.height);}return true;}else{canvas.fillAndStroke();var x=state.x;var y=state.y;var w=state.width;var h=state.height;if(mxUtils.getValue(state.style,mxConstants.STYLE_HORIZONTAL,1)==0){x+=bounds.width;w-=bounds.width;}else{y+=bounds.height;h-=bounds.height;}canvas.begin();canvas.moveTo(x,y);canvas.lineTo(x,y+h);canvas.lineTo(x+w,y+h);canvas.lineTo(x+w,y);canvas.stroke();}}};this.shapes['image']=this.shapes['rectangle'];this.shapes['label']=this.shapes['rectangle'];var imageExport=this;this.shapes['connector']={translatePoint:function(points,index,offset){if(offset!=null){var pt=points[index].clone();pt.x+=offset.x;pt.y+=offset.y;points[index]=pt;}},drawShape:function(canvas,state,bounds,background,shadow){if(background){var rounded=mxUtils.getValue(state.style,mxConstants.STYLE_ROUNDED,false);var arcSize=mxConstants.LINE_ARCSIZE/2;canvas.setFillColor((shadow)?mxConstants.NONE:mxUtils.getValue(state.style,mxConstants.STYLE_STROKECOLOR,"#000000"));canvas.setDashed(false);var pts=state.absolutePoints.slice();this.translatePoint(pts,0,imageExport.drawMarker(canvas,state,true));this.translatePoint(pts,pts.length-1,imageExport.drawMarker(canvas,state,false));canvas.setDashed(mxUtils.getValue(state.style,mxConstants.STYLE_DASHED,'0')=='1');var pt=pts[0];var pe=pts[pts.length-1];canvas.begin();canvas.moveTo(pt.x,pt.y);for(var i=1;i<pts.length-1;i++){var tmp=pts[i];var dx=pt.x-tmp.x;var dy=pt.y-tmp.y;if((rounded&&i<pts.length-1)&&(dx!=0||dy!=0)){var dist=Math.sqrt(dx*dx+dy*dy);var nx1=dx*Math.min(arcSize,dist/2)/dist;var ny1=dy*Math.min(arcSize,dist/2)/dist;var x1=tmp.x+nx1;var y1=tmp.y+ny1;canvas.lineTo(x1,y1);var next=pts[i+1];dx=next.x-tmp.x;dy=next.y-tmp.y;dist=Math.max(1,Math.sqrt(dx*dx+dy*dy));var nx2=dx*Math.min(arcSize,dist/2)/dist;var ny2=dy*Math.min(arcSize,dist/2)/dist;var x2=tmp.x+nx2;var y2=tmp.y+ny2;canvas.curveTo(tmp.x,tmp.y,tmp.x,tmp.y,x2,y2);tmp=new mxPoint(x2,y2);}else{canvas.lineTo(tmp.x,tmp.y);}pt=tmp;}canvas.lineTo(pe.x,pe.y);canvas.stroke();return true;}else{}}};this.shapes['arrow']={drawShape:function(canvas,state,bounds,background){if(background){var spacing=mxConstants.ARROW_SPACING;var width=mxConstants.ARROW_WIDTH;var arrow=mxConstants.ARROW_SIZE;var pts=state.absolutePoints;var p0=pts[0];var pe=pts[pts.length-1];var dx=pe.x-p0.x;var dy=pe.y-p0.y;var dist=Math.sqrt(dx*dx+dy*dy);var length=dist-2*spacing-arrow;var nx=dx/dist;var ny=dy/dist;var basex=length*nx;var basey=length*ny;var floorx=width*ny/3;var floory=-width*nx/3;var p0x=p0.x-floorx/2+spacing*nx;var p0y=p0.y-floory/2+spacing*ny;var p1x=p0x+floorx;var p1y=p0y+floory;var p2x=p1x+basex;var p2y=p1y+basey;var p3x=p2x+floorx;var p3y=p2y+floory;var p5x=p3x-3*floorx;var p5y=p3y-3*floory;canvas.begin();canvas.moveTo(p0x,p0y);canvas.lineTo(p1x,p1y);canvas.lineTo(p2x,p2y);canvas.lineTo(p3x,p3y);canvas.lineTo(pe.x-spacing*nx,pe.y-spacing*ny);canvas.lineTo(p5x,p5y);canvas.lineTo(p5x+floorx,p5y+floory);canvas.close();return true;}else{canvas.fillAndStroke();}}};this.shapes['cylinder']={drawShape:function(canvas,state,bounds,background){if(background){return false;}else{var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;var dy=Math.min(mxCylinder.prototype.maxHeight,Math.floor(h/5));canvas.begin();canvas.moveTo(x,y+dy);canvas.curveTo(x,y-dy/3,x+w,y-dy/3,x+w,y+dy);canvas.lineTo(x+w,y+h-dy);canvas.curveTo(x+w,y+h+dy/3,x,y+h+dy/3,x,y+h-dy);canvas.close();canvas.fillAndStroke();canvas.begin();canvas.moveTo(x,y+dy);canvas.curveTo(x,y+2*dy,x+w,y+2*dy,x+w,y+dy);canvas.stroke();}}};this.shapes['line']={drawShape:function(canvas,state,bounds,background){if(background){return false;}else{canvas.begin();var mid=state.getCenterY();canvas.moveTo(bounds.x,mid);canvas.lineTo(bounds.x+bounds.width,mid);canvas.stroke();}}};this.shapes['ellipse']={drawShape:function(canvas,state,bounds,background){if(background){canvas.ellipse(bounds.x,bounds.y,bounds.width,bounds.height);return true;}else{canvas.fillAndStroke();}}};this.shapes['doubleEllipse']={drawShape:function(canvas,state,bounds,background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;if(background){canvas.ellipse(x,y,w,h);return true;}else{canvas.fillAndStroke();var inset=Math.min(4,Math.min(w/5,h/5));x+=inset;y+=inset;w-=2*inset;h-=2*inset;if(w>0&&h>0){canvas.ellipse(x,y,w,h);}canvas.stroke();}}};this.shapes['triangle']={drawShape:function(canvas,state,bounds,background){if(background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;canvas.begin();canvas.moveTo(x,y);canvas.lineTo(x+w,y+h/2);canvas.lineTo(x,y+h);canvas.close();return true;}else{canvas.fillAndStroke();}}};this.shapes['rhombus']={drawShape:function(canvas,state,bounds,background){if(background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;var hw=w/2;var hh=h/2;canvas.begin();canvas.moveTo(x+hw,y);canvas.lineTo(x+w,y+hh);canvas.lineTo(x+hw,y+h);canvas.lineTo(x,y+hh);canvas.close();return true;}else{canvas.fillAndStroke();}}};this.shapes['hexagon']={drawShape:function(canvas,state,bounds,background){if(background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;canvas.begin();canvas.moveTo(x+0.25*w,y);canvas.lineTo(x+0.75*w,y);canvas.lineTo(x+w,y+0.5*h);canvas.lineTo(x+0.75*w,y+h);canvas.lineTo(x+0.25*w,y+h);canvas.lineTo(x,y+0.5*h);canvas.close();return true;}else{canvas.fillAndStroke();}}};this.shapes['actor']={drawShape:function(canvas,state,bounds,background){if(background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;var width=w*2/6;canvas.begin();canvas.moveTo(x,y+h);canvas.curveTo(x,y+3*h/5,x,y+2*h/5,x+w/2,y+2*h/5);canvas.curveTo(x+w/2-width,y+2*h/5,x+w/2-width,y,x+w/2,y);canvas.curveTo(x+w/2+width,y,x+w/2+width,y+2*h/5,x+w/2,y+2*h/5);canvas.curveTo(x+w,y+2*h/5,x+w,y+3*h/5,x+w,y+h);canvas.close();return true;}else{canvas.fillAndStroke();}}};this.shapes['cloud']={drawShape:function(canvas,state,bounds,background){if(background){var x=bounds.x;var y=bounds.y;var w=bounds.width;var h=bounds.height;canvas.begin();canvas.moveTo(x+0.25*w,y+0.25*h);canvas.curveTo(x+0.05*w,y+0.25*h,x,y+0.5*h,x+0.16*w,y+0.55*h);canvas.curveTo(x,y+0.66*h,x+0.18*w,y+0.9*h,x+0.31*w,y+0.8*h);canvas.curveTo(x+0.4*w,y+h,x+0.7*w,y+h,x+0.8*w,y+0.8*h);canvas.curveTo(x+w,y+0.8*h,x+w,y+0.6*h,x+0.875*w,y+0.5*h);canvas.curveTo(x+w,y+0.3*h,x+0.8*w,y+0.1*h,x+0.625*w,y+0.2*h);canvas.curveTo(x+0.5*w,y+0.05*h,x+0.3*w,y+0.05*h,x+0.25*w,y+0.25*h);canvas.close();return true;}else{canvas.fillAndStroke();}}};};mxImageExport.prototype.initMarkers=function(){this.markers=[];var tmp=function(canvas,state,type,pe,unitX,unitY,size,source,sw){var endOffsetX=unitX*sw*1.118;var endOffsetY=unitY*sw*1.118;pe.x-=endOffsetX;pe.y-=endOffsetY;unitX=unitX*(size+sw);unitY=unitY*(size+sw);canvas.begin();canvas.moveTo(pe.x,pe.y);canvas.lineTo(pe.x-unitX-unitY/2,pe.y-unitY+unitX/2);if(type==mxConstants.ARROW_CLASSIC){canvas.lineTo(pe.x-unitX*3/4,pe.y-unitY*3/4);}canvas.lineTo(pe.x+unitY/2-unitX,pe.y-unitY-unitX/2);canvas.close();var key=(source)?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL;if(state.style[key]==0){canvas.stroke();}else{canvas.fillAndStroke();}var f=(type!=mxConstants.ARROW_CLASSIC)?1:3/4;return new mxPoint(-unitX*f-endOffsetX,-unitY*f-endOffsetY);};this.markers['classic']=tmp;this.markers['block']=tmp;this.markers['open']=function(canvas,state,type,pe,unitX,unitY,size,source,sw){var endOffsetX=unitX*sw*1.118;var endOffsetY=unitY*sw*1.118;pe.x-=endOffsetX;pe.y-=endOffsetY;unitX=unitX*(size+sw);unitY=unitY*(size+sw);canvas.begin();canvas.moveTo(pe.x-unitX-unitY/2,pe.y-unitY+unitX/2);canvas.lineTo(pe.x,pe.y);canvas.lineTo(pe.x+unitY/2-unitX,pe.y-unitY-unitX/2);canvas.stroke();return new mxPoint(-endOffsetX*2,-endOffsetY*2);};this.markers['oval']=function(canvas,state,type,pe,unitX,unitY,size,source,sw){var a=size/2;canvas.ellipse(pe.x-a,pe.y-a,size,size);var key=(source)?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL;if(state.style[key]==0){canvas.stroke();}else{canvas.fillAndStroke();}return new mxPoint(-unitX/2,-unitY/2);};var tmp_diamond=function(canvas,state,type,pe,unitX,unitY,size,source,sw){var swFactor=(type==mxConstants.ARROW_DIAMOND)?0.7071:0.9862;var endOffsetX=unitX*sw*swFactor;var endOffsetY=unitY*sw*swFactor;unitX=unitX*(size+sw);unitY=unitY*(size+sw);pe.x-=endOffsetX;pe.y-=endOffsetY;var tk=((type==mxConstants.ARROW_DIAMOND)?2:3.4);canvas.begin();canvas.moveTo(pe.x,pe.y);canvas.lineTo(pe.x-unitX/2-unitY/tk,pe.y+unitX/tk-unitY/2);canvas.lineTo(pe.x-unitX,pe.y-unitY);canvas.lineTo(pe.x-unitX/2+unitY/tk,pe.y-unitY/2-unitX/tk);canvas.close();var key=(source)?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL;if(state.style[key]==0){canvas.stroke();}else{canvas.fillAndStroke();}return new mxPoint(-endOffsetX-unitX,-endOffsetY-unitY);};this.markers['diamond']=tmp_diamond;this.markers['diamondThin']=tmp_diamond;};var mxXmlCanvas2D=function(root){var converter=new mxUrlConverter();var compressed=true;var textEnabled=true;var doc=root.ownerDocument;var stack=[];var state={alpha:1,dashed:false,strokewidth:1,fontsize:mxConstants.DEFAULT_FONTSIZE,fontfamily:mxConstants.DEFAULT_FONTFAMILY,fontcolor:'#000000'};var f2=function(x){return Math.round(parseFloat(x)*100)/100;};return{getConverter:function(){return converter;},isCompressed:function(){return compressed;},setCompressed:function(value){compressed=value;},isTextEnabled:function(){return textEnabled;},setTextEnabled:function(value){textEnabled=value;},getDocument:function(){return doc;},save:function(){if(compressed){stack.push(state);state=mxUtils.clone(state);}root.appendChild(doc.createElement('save'));},restore:function(){if(compressed){state=stack.pop();}root.appendChild(doc.createElement('restore'));},scale:function(value){var elem=doc.createElement('scale');elem.setAttribute('scale',value);root.appendChild(elem);},translate:function(dx,dy){var elem=doc.createElement('translate');elem.setAttribute('dx',f2(dx));elem.setAttribute('dy',f2(dy));root.appendChild(elem);},rotate:function(theta,flipH,flipV,cx,cy){var elem=doc.createElement('rotate');elem.setAttribute('theta',f2(theta));elem.setAttribute('flipH',(flipH)?'1':'0');elem.setAttribute('flipV',(flipV)?'1':'0');elem.setAttribute('cx',f2(cx));elem.setAttribute('cy',f2(cy));root.appendChild(elem);},setStrokeWidth:function(value){if(compressed){if(state.strokewidth==value){return;}state.strokewidth=value;}var elem=doc.createElement('strokewidth');elem.setAttribute('width',f2(value));root.appendChild(elem);},setStrokeColor:function(value){var elem=doc.createElement('strokecolor');elem.setAttribute('color',value);root.appendChild(elem);},setDashed:function(value){if(compressed){if(state.dashed==value){return;}state.dashed=value;}var elem=doc.createElement('dashed');elem.setAttribute('dashed',(value)?'1':'0');root.appendChild(elem);},setDashPattern:function(value){var elem=doc.createElement('dashpattern');elem.setAttribute('pattern',value);root.appendChild(elem);},setLineCap:function(value){var elem=doc.createElement('linecap');elem.setAttribute('cap',value);root.appendChild(elem);},setLineJoin:function(value){var elem=doc.createElement('linejoin');elem.setAttribute('join',value);root.appendChild(elem);},setMiterLimit:function(value){var elem=doc.createElement('miterlimit');elem.setAttribute('limit',value);root.appendChild(elem);},setFontSize:function(value){if(textEnabled){if(compressed){if(state.fontsize==value){return;}state.fontsize=value;}var elem=doc.createElement('fontsize');elem.setAttribute('size',value);root.appendChild(elem);}},setFontColor:function(value){if(textEnabled){if(compressed){if(state.fontcolor==value){return;}state.fontcolor=value;}var elem=doc.createElement('fontcolor');elem.setAttribute('color',value);root.appendChild(elem);}},setFontFamily:function(value){if(textEnabled){if(compressed){if(state.fontfamily==value){return;}state.fontfamily=value;}var elem=doc.createElement('fontfamily');elem.setAttribute('family',value);root.appendChild(elem);}},setFontStyle:function(value){if(textEnabled){var elem=doc.createElement('fontstyle');elem.setAttribute('style',value);root.appendChild(elem);}},setAlpha:function(alpha){if(compressed){if(state.alpha==alpha){return;}state.alpha=alpha;}var elem=doc.createElement('alpha');elem.setAttribute('alpha',f2(alpha));root.appendChild(elem);},setFillColor:function(value){var elem=doc.createElement('fillcolor');elem.setAttribute('color',value);root.appendChild(elem);},setGradient:function(color1,color2,x,y,w,h,direction){var elem=doc.createElement('gradient');elem.setAttribute('c1',color1);elem.setAttribute('c2',color2);elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));if(direction!=null){elem.setAttribute('direction',direction);}root.appendChild(elem);},setGlassGradient:function(x,y,w,h){var elem=doc.createElement('glass');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));root.appendChild(elem);},rect:function(x,y,w,h){var elem=doc.createElement('rect');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));root.appendChild(elem);},roundrect:function(x,y,w,h,dx,dy){var elem=doc.createElement('roundrect');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));elem.setAttribute('dx',f2(dx));elem.setAttribute('dy',f2(dy));root.appendChild(elem);},ellipse:function(x,y,w,h){var elem=doc.createElement('ellipse');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));root.appendChild(elem);},image:function(x,y,w,h,src,aspect,flipH,flipV){src=converter.convert(src);var elem=doc.createElement('image');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));elem.setAttribute('src',src);elem.setAttribute('aspect',(aspect)?'1':'0');elem.setAttribute('flipH',(flipH)?'1':'0');elem.setAttribute('flipV',(flipV)?'1':'0');root.appendChild(elem);},text:function(x,y,w,h,str,align,valign,vertical,wrap,format){if(textEnabled){var elem=doc.createElement('text');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));elem.setAttribute('w',f2(w));elem.setAttribute('h',f2(h));elem.setAttribute('str',str);if(align!=null){elem.setAttribute('align',align);}if(valign!=null){elem.setAttribute('valign',valign);}elem.setAttribute('vertical',(vertical)?'1':'0');elem.setAttribute('wrap',(wrap)?'1':'0');elem.setAttribute('format',format);root.appendChild(elem);}},begin:function(){root.appendChild(doc.createElement('begin'));},moveTo:function(x,y){var elem=doc.createElement('move');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));root.appendChild(elem);},lineTo:function(x,y){var elem=doc.createElement('line');elem.setAttribute('x',f2(x));elem.setAttribute('y',f2(y));root.appendChild(elem);},quadTo:function(x1,y1,x2,y2){var elem=doc.createElement('quad');elem.setAttribute('x1',f2(x1));elem.setAttribute('y1',f2(y1));elem.setAttribute('x2',f2(x2));elem.setAttribute('y2',f2(y2));root.appendChild(elem);},curveTo:function(x1,y1,x2,y2,x3,y3){var elem=doc.createElement('curve');elem.setAttribute('x1',f2(x1));elem.setAttribute('y1',f2(y1));elem.setAttribute('x2',f2(x2));elem.setAttribute('y2',f2(y2));elem.setAttribute('x3',f2(x3));elem.setAttribute('y3',f2(y3));root.appendChild(elem);},close:function(){root.appendChild(doc.createElement('close'));},stroke:function(){root.appendChild(doc.createElement('stroke'));},fill:function(){root.appendChild(doc.createElement('fill'));},fillAndStroke:function(){root.appendChild(doc.createElement('fillstroke'));},shadow:function(value,filled){var elem=doc.createElement('shadow');elem.setAttribute('value',value);if(filled!=null){elem.setAttribute('filled',(filled)?'1':'0');}root.appendChild(elem);},clip:function(){root.appendChild(doc.createElement('clip'));}};};var mxSvgCanvas2D=function(root,styleEnabled){styleEnabled=(styleEnabled!=null)?styleEnabled:false;var converter=new mxUrlConverter();var autoAntiAlias=true;var textEnabled=true;var foEnabled=true;var create=function(tagName,namespace){if(root.ownerDocument.createElementNS!=null){return root.ownerDocument.createElementNS(namespace||mxConstants.NS_SVG,tagName);}else{var elt=root.ownerDocument.createElement(tagName);if(namespace!=null){elt.setAttribute('xmlns',namespace);}return elt;}};var defs=create('defs');if(styleEnabled){var style=create('style');style.setAttribute('type','text/css');mxUtils.write(style,'svg{font-family:'+mxConstants.DEFAULT_FONTFAMILY+';font-size:'+mxConstants.DEFAULT_FONTSIZE+';fill:none;stroke-miterlimit:10}');if(autoAntiAlias){mxUtils.write(style,'rect{shape-rendering:crispEdges}');}defs.appendChild(style);}root.appendChild(defs);var currentState={dx:0,dy:0,scale:1,transform:'',fill:null,gradient:null,stroke:null,strokeWidth:1,dashed:false,dashpattern:'3 3',alpha:1,linecap:'flat',linejoin:'miter',miterlimit:10,fontColor:'#000000',fontSize:mxConstants.DEFAULT_FONTSIZE,fontFamily:mxConstants.DEFAULT_FONTFAMILY,fontStyle:0};var currentPathIsOrthogonal=true;var glassGradient=null;var currentNode=null;var currentPath=null;var lastPoint=null;var gradients=[];var refCount=0;var stack=[];var createGradientId=function(start,end,direction){if(start.charAt(0)=='#'){start=start.substring(1);}if(end.charAt(0)=='#'){end=end.substring(1);}start=start.toLowerCase();end=end.toLowerCase();var dir=null;if(direction==null||direction==mxConstants.DIRECTION_SOUTH){dir='s';}else if(direction==mxConstants.DIRECTION_EAST){dir='e';}else{var tmp=start;start=end;end=tmp;if(direction==mxConstants.DIRECTION_NORTH){dir='s';}else if(direction==mxConstants.DIRECTION_WEST){dir='e';}}return start+'-'+end+'-'+dir;};var createHtmlBody=function(str,align,valign){var style='margin:0px;font-size:'+Math.floor(currentState.fontSize)+'px;'+'font-family:'+currentState.fontFamily+';color:'+currentState.fontColor+';';if((currentState.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){style+='font-weight:bold;';}if((currentState.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){style+='font-style:italic;';}if((currentState.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){style+='font-decoration:underline;';}if(align==mxConstants.ALIGN_CENTER){style+='text-align:center;';}else if(align==mxConstants.ALIGN_RIGHT){style+='text-align:right;';}var body=create('body','http://www.w3.org/1999/xhtml');body.setAttribute('style',style);var node=mxUtils.parseXml('<div xmlns="http://www.w3.org/1999/xhtml">'+str+'</div>').documentElement;if(body.ownerDocument.importNode!=null){node=body.ownerDocument.importNode(node,true);}body.appendChild(node);return body;};var getSvgGradient=function(start,end,direction){var id=createGradientId(start,end,direction);var gradient=gradients[id];if(gradient==null){gradient=create('linearGradient');gradient.setAttribute('id',++refCount);gradient.setAttribute('x1','0%');gradient.setAttribute('y1','0%');gradient.setAttribute('x2','0%');gradient.setAttribute('y2','0%');if(direction==null||direction==mxConstants.DIRECTION_SOUTH){gradient.setAttribute('y2','100%');}else if(direction==mxConstants.DIRECTION_EAST){gradient.setAttribute('x2','100%');}else if(direction==mxConstants.DIRECTION_NORTH){gradient.setAttribute('y1','100%');}else if(direction==mxConstants.DIRECTION_WEST){gradient.setAttribute('x1','100%');}var stop=create('stop');stop.setAttribute('offset','0%');stop.setAttribute('style','stop-color:'+start);gradient.appendChild(stop);stop=create('stop');stop.setAttribute('offset','100%');stop.setAttribute('style','stop-color:'+end);gradient.appendChild(stop);defs.appendChild(gradient);gradients[id]=gradient;}return gradient.getAttribute('id');};var appendNode=function(node,state,filled,stroked){if(node!=null){if(state.clip!=null){node.setAttribute('clip-path','url(#'+state.clip+')');state.clip=null;}if(currentPath!=null){node.setAttribute('d',currentPath.join(' '));currentPath=null;if(autoAntiAlias&&currentPathIsOrthogonal){node.setAttribute('shape-rendering','crispEdges');state.strokeWidth=Math.max(1,state.strokeWidth);}}if(state.alpha<1){node.setAttribute('opacity',state.alpha);}if(filled&&(state.fill!=null||state.gradient!=null)){if(state.gradient!=null){node.setAttribute('fill','url(#'+state.gradient+')');}else{node.setAttribute('fill',state.fill.toLowerCase());}}else if(!styleEnabled){node.setAttribute('fill','none');}if(stroked&&state.stroke!=null){node.setAttribute('stroke',state.stroke.toLowerCase());if(state.strokeWidth!=1){if(node.nodeName=='rect'&&autoAntiAlias){state.strokeWidth=Math.max(1,state.strokeWidth);}node.setAttribute('stroke-width',state.strokeWidth);}if(node.nodeName=='path'){if(state.linejoin!=null&&state.linejoin!='miter'){node.setAttribute('stroke-linejoin',state.linejoin);}if(state.linecap!=null){var value=state.linecap;if(value=='flat'){value='butt';}if(value!='butt'){node.setAttribute('stroke-linecap',value);}}if(state.miterlimit!=null&&(!styleEnabled||state.miterlimit!=10)){node.setAttribute('stroke-miterlimit',state.miterlimit);}}if(state.dashed){var dash=state.dashpattern.split(' ');if(dash.length>0){var pat=[];for(var i=0;i<dash.length;i++){pat[i]=Number(dash[i])*currentState.strokeWidth;}node.setAttribute('stroke-dasharray',pat.join(' '));}}}if(state.transform.length>0){node.setAttribute('transform',state.transform);}root.appendChild(node);}};var f2=function(x){return Math.round(parseFloat(x)*100)/100;};return{getConverter:function(){return converter;},isAutoAntiAlias:function(){return autoAntiAlias;},setAutoAntiAlias:function(value){autoAntiAlias=value;},isTextEnabled:function(){return textEnabled;},setTextEnabled:function(value){textEnabled=value;},isFoEnabled:function(){return foEnabled;},setFoEnabled:function(value){foEnabled=value;},save:function(){stack.push(currentState);currentState=mxUtils.clone(currentState);},restore:function(){currentState=stack.pop();},scale:function(value){currentState.scale*=value;currentState.strokeWidth*=value;},translate:function(dx,dy){currentState.dx+=dx;currentState.dy+=dy;},rotate:function(theta,flipH,flipV,cx,cy){cx+=currentState.dx;cy+=currentState.dy;cx*=currentState.scale;cy*=currentState.scale;if(flipH^flipV){var tx=(flipH)?cx:0;var sx=(flipH)?-1:1;var ty=(flipV)?cy:0;var sy=(flipV)?-1:1;currentState.transform+='translate('+f2(tx)+','+f2(ty)+')';currentState.transform+='scale('+f2(sx)+','+f2(sy)+')';currentState.transform+='translate('+f2(-tx)+' '+f2(-ty)+')';}currentState.transform+='rotate('+f2(theta)+','+f2(cx)+','+f2(cy)+')';},setStrokeWidth:function(value){currentState.strokeWidth=value*currentState.scale;},setStrokeColor:function(value){currentState.stroke=value;},setDashed:function(value){currentState.dashed=value;},setDashPattern:function(value){currentState.dashpattern=value;},setLineCap:function(value){currentState.linecap=value;},setLineJoin:function(value){currentState.linejoin=value;},setMiterLimit:function(value){currentState.miterlimit=value;},setFontSize:function(value){currentState.fontSize=value;},setFontColor:function(value){currentState.fontColor=value;},setFontFamily:function(value){currentState.fontFamily=value;},setFontStyle:function(value){currentState.fontStyle=value;},setAlpha:function(alpha){currentState.alpha=alpha;},setFillColor:function(value){currentState.fill=value;currentState.gradient=null;},setGradient:function(color1,color2,x,y,w,h,direction){if(color1!=null&&color2!=null){currentState.gradient=getSvgGradient(color1,color2,direction);currentState.fill=color1;}},setGlassGradient:function(x,y,w,h){if(glassGradient==null){glassGradient=create('linearGradient');glassGradient.setAttribute('id','0');glassGradient.setAttribute('x1','0%');glassGradient.setAttribute('y1','0%');glassGradient.setAttribute('x2','0%');glassGradient.setAttribute('y2','100%');var stop1=create('stop');stop1.setAttribute('offset','0%');stop1.setAttribute('style','stop-color:#ffffff;stop-opacity:0.9');glassGradient.appendChild(stop1);var stop2=create('stop');stop2.setAttribute('offset','100%');stop2.setAttribute('style','stop-color:#ffffff;stop-opacity:0.1');glassGradient.appendChild(stop2);if(defs.firstChild.nextSibling!=null){defs.insertBefore(glassGradient,defs.firstChild.nextSibling);}else{defs.appendChild(glassGradient);}}currentState.gradient='0';},rect:function(x,y,w,h){x+=currentState.dx;y+=currentState.dy;currentNode=create('rect');currentNode.setAttribute('x',f2(x*currentState.scale));currentNode.setAttribute('y',f2(y*currentState.scale));currentNode.setAttribute('width',f2(w*currentState.scale));currentNode.setAttribute('height',f2(h*currentState.scale));if(!styleEnabled&&autoAntiAlias){currentNode.setAttribute('shape-rendering','crispEdges');}},roundrect:function(x,y,w,h,dx,dy){x+=currentState.dx;y+=currentState.dy;currentNode=create('rect');currentNode.setAttribute('x',f2(x*currentState.scale));currentNode.setAttribute('y',f2(y*currentState.scale));currentNode.setAttribute('width',f2(w*currentState.scale));currentNode.setAttribute('height',f2(h*currentState.scale));if(dx>0){currentNode.setAttribute('rx',f2(dx*currentState.scale));}if(dy>0){currentNode.setAttribute('ry',f2(dy*currentState.scale));}if(!styleEnabled&&autoAntiAlias){currentNode.setAttribute('shape-rendering','crispEdges');}},ellipse:function(x,y,w,h){x+=currentState.dx;y+=currentState.dy;currentNode=create('ellipse');currentNode.setAttribute('cx',f2((x+w/2)*currentState.scale));currentNode.setAttribute('cy',f2((y+h/2)*currentState.scale));currentNode.setAttribute('rx',f2(w/2*currentState.scale));currentNode.setAttribute('ry',f2(h/2*currentState.scale));},image:function(x,y,w,h,src,aspect,flipH,flipV){src=converter.convert(src);aspect=(aspect!=null)?aspect:true;flipH=(flipH!=null)?flipH:false;flipV=(flipV!=null)?flipV:false;x+=currentState.dx;y+=currentState.dy;var node=create('image');node.setAttribute('x',f2(x*currentState.scale));node.setAttribute('y',f2(y*currentState.scale));node.setAttribute('width',f2(w*currentState.scale));node.setAttribute('height',f2(h*currentState.scale));if(mxClient.IS_VML){node.setAttribute('xlink:href',src);}else{node.setAttributeNS(mxConstants.NS_XLINK,'xlink:href',src);}if(!aspect){node.setAttribute('preserveAspectRatio','none');}if(currentState.alpha<1){node.setAttribute('opacity',currentState.alpha);}var tr=currentState.transform;if(flipH||flipV){var sx=1;var sy=1;var dx=0;var dy=0;if(flipH){sx=-1;dx=-w-2*x;}if(flipV){sy=-1;dy=-h-2*y;}tr+='scale('+sx+','+sy+')translate('+dx+','+dy+')';}if(tr.length>0){node.setAttribute('transform',tr);}root.appendChild(node);},text:function(x,y,w,h,str,align,valign,vertical,wrap,format){if(textEnabled){x+=currentState.dx;y+=currentState.dy;if(foEnabled&&format=='html'){var node=create('g');node.setAttribute('transform',currentState.transform+'scale('+currentState.scale+','+currentState.scale+')');if(currentState.alpha<1){node.setAttribute('opacity',currentState.alpha);}var fo=create('foreignObject');fo.setAttribute('x',Math.round(x));fo.setAttribute('y',Math.round(y));fo.setAttribute('width',Math.round(w));fo.setAttribute('height',Math.round(h));fo.appendChild(createHtmlBody(str,align,valign));node.appendChild(fo);root.appendChild(node);}else{var size=Math.floor(currentState.fontSize);var node=create('g');var tr=currentState.transform;if(vertical){var cx=x+w/2;var cy=y+h/2;tr+='rotate(-90,'+f2(cx*currentState.scale)+','+f2(cy*currentState.scale)+')';}if(tr.length>0){node.setAttribute('transform',tr);}if(currentState.alpha<1){node.setAttribute('opacity',currentState.alpha);}var anchor=(align==mxConstants.ALIGN_RIGHT)?'end':(align==mxConstants.ALIGN_CENTER)?'middle':'start';if(anchor=='end'){x+=Math.max(0,w-2);}else if(anchor=='middle'){x+=w/2;}else{x+=(w>0)?2:0;}if((currentState.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){node.setAttribute('font-weight','bold');}if((currentState.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){node.setAttribute('font-style','italic');}if((currentState.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){node.setAttribute('text-decoration','underline');}if(anchor!='start'){node.setAttribute('text-anchor',anchor);}if(!styleEnabled||size!=mxConstants.DEFAULT_FONTSIZE){node.setAttribute('font-size',Math.floor(size*currentState.scale)+'px');}if(!styleEnabled||currentState.fontFamily!=mxConstants.DEFAULT_FONTFAMILY){node.setAttribute('font-family',currentState.fontFamily);}node.setAttribute('fill',currentState.fontColor);var lines=str.split('\n');var lineHeight=size*1.25;var textHeight=(h>0)?size+(lines.length-1)*lineHeight:lines.length*lineHeight-1;var dy=h-textHeight;if(valign==null||valign==mxConstants.ALIGN_TOP){y=Math.max(y-3*currentState.scale,y+dy/2+((h>0)?lineHeight/2-8:0));}else if(valign==mxConstants.ALIGN_MIDDLE){y=y+dy/2;}else if(valign==mxConstants.ALIGN_BOTTOM){y=Math.min(y,y+dy+2*currentState.scale);}y+=size;for(var i=0;i<lines.length;i++){var text=create('text');text.setAttribute('x',f2(x*currentState.scale));text.setAttribute('y',f2(y*currentState.scale));mxUtils.write(text,lines[i]);node.appendChild(text);y+=size*1.3;}root.appendChild(node);}}},begin:function(){currentNode=create('path');currentPath=[];lastPoint=null;currentPathIsOrthogonal=true;},moveTo:function(x,y){if(currentPath!=null){x+=currentState.dx;y+=currentState.dy;currentPath.push('M '+f2(x*currentState.scale)+' '+f2(y*currentState.scale));if(autoAntiAlias){lastPoint=new mxPoint(x,y);}}},lineTo:function(x,y){if(currentPath!=null){x+=currentState.dx;y+=currentState.dy;currentPath.push('L '+f2(x*currentState.scale)+' '+f2(y*currentState.scale));if(autoAntiAlias){if(lastPoint!=null&&currentPathIsOrthogonal&&x!=lastPoint.x&&y!=lastPoint.y){currentPathIsOrthogonal=false;}lastPoint=new mxPoint(x,y);}}},quadTo:function(x1,y1,x2,y2){if(currentPath!=null){x1+=currentState.dx;y1+=currentState.dy;x2+=currentState.dx;y2+=currentState.dy;currentPath.push('Q '+f2(x1*currentState.scale)+' '+f2(y1*currentState.scale)+' '+f2(x2*currentState.scale)+' '+f2(y2*currentState.scale));currentPathIsOrthogonal=false;}},curveTo:function(x1,y1,x2,y2,x3,y3){if(currentPath!=null){x1+=currentState.dx;y1+=currentState.dy;x2+=currentState.dx;y2+=currentState.dy;x3+=currentState.dx;y3+=currentState.dy;currentPath.push('C '+f2(x1*currentState.scale)+' '+f2(y1*currentState.scale)+' '+f2(x2*currentState.scale)+' '+f2(y2*currentState.scale)+' '+f2(x3*currentState.scale)+' '+f2(y3*currentState.scale));currentPathIsOrthogonal=false;}},close:function(){if(currentPath!=null){currentPath.push('Z');}},stroke:function(){appendNode(currentNode,currentState,false,true);},fill:function(){appendNode(currentNode,currentState,true,false);},fillAndStroke:function(){appendNode(currentNode,currentState,true,true);},shadow:function(value,filled){this.save();this.setStrokeColor(value);if(filled){this.setFillColor(value);this.fillAndStroke();}else{this.stroke();}this.restore();},clip:function(){if(currentNode!=null){if(currentPath!=null){currentNode.setAttribute('d',currentPath.join(' '));currentPath=null;}var id=++refCount;var clip=create('clipPath');clip.setAttribute('id',id);clip.appendChild(currentNode);defs.appendChild(clip);currentState.clip=id;}}};};function mxGuide(graph,states){this.graph=graph;this.setStates(states);};mxGuide.prototype.graph=null;mxGuide.prototype.states=null;mxGuide.prototype.horizontal=true;mxGuide.prototype.vertical=true;mxGuide.prototype.guideX=null;mxGuide.prototype.guideY=null;mxGuide.prototype.crisp=true;mxGuide.prototype.setStates=function(states){this.states=states;};mxGuide.prototype.isEnabledForEvent=function(evt){return true;};mxGuide.prototype.getGuideTolerance=function(){return this.graph.gridSize*this.graph.view.scale/2;};mxGuide.prototype.createGuideShape=function(horizontal){var guide=new mxPolyline([],mxConstants.GUIDE_COLOR,mxConstants.GUIDE_STROKEWIDTH);guide.crisp=this.crisp;guide.isDashed=true;return guide;};mxGuide.prototype.move=function(bounds,delta,gridEnabled){if(this.states!=null&&(this.horizontal||this.vertical)&&bounds!=null&&delta!=null){var trx=this.graph.getView().translate;var scale=this.graph.getView().scale;var dx=delta.x;var dy=delta.y;var overrideX=false;var overrideY=false;var tt=this.getGuideTolerance();var ttX=tt;var ttY=tt;var b=bounds.clone();b.x+=delta.x;b.y+=delta.y;var left=b.x;var right=b.x+b.width;var center=b.getCenterX();var top=b.y;var bottom=b.y+b.height;var middle=b.getCenterY();function snapX(x){x+=this.graph.panDx;var override=false;if(Math.abs(x-center)<ttX){dx=x-bounds.getCenterX();ttX=Math.abs(x-center);override=true;}else if(Math.abs(x-left)<ttX){dx=x-bounds.x;ttX=Math.abs(x-left);override=true;}else if(Math.abs(x-right)<ttX){dx=x-bounds.x-bounds.width;ttX=Math.abs(x-right);override=true;}if(override){if(this.guideX==null){this.guideX=this.createGuideShape(true);this.guideX.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.guideX.init(this.graph.getView().getOverlayPane());if(this.graph.dialect==mxConstants.DIALECT_SVG){this.guideX.node.setAttribute('pointer-events','none');this.guideX.pipe.setAttribute('pointer-events','none');}}var c=this.graph.container;x-=this.graph.panDx;this.guideX.points=[new mxPoint(x,-this.graph.panDy),new mxPoint(x,c.scrollHeight-3-this.graph.panDy)];}overrideX=overrideX||override;};function snapY(y){y+=this.graph.panDy;var override=false;if(Math.abs(y-middle)<ttY){dy=y-bounds.getCenterY();ttY=Math.abs(y-middle);override=true;}else if(Math.abs(y-top)<ttY){dy=y-bounds.y;ttY=Math.abs(y-top);override=true;}else if(Math.abs(y-bottom)<ttY){dy=y-bounds.y-bounds.height;ttY=Math.abs(y-bottom);override=true;}if(override){if(this.guideY==null){this.guideY=this.createGuideShape(false);this.guideY.dialect=(this.graph.dialect!=mxConstants.DIALECT_SVG)?mxConstants.DIALECT_VML:mxConstants.DIALECT_SVG;this.guideY.init(this.graph.getView().getOverlayPane());if(this.graph.dialect==mxConstants.DIALECT_SVG){this.guideY.node.setAttribute('pointer-events','none');this.guideY.pipe.setAttribute('pointer-events','none');}}var c=this.graph.container;y-=this.graph.panDy;this.guideY.points=[new mxPoint(-this.graph.panDx,y),new mxPoint(c.scrollWidth-3-this.graph.panDx,y)];}overrideY=overrideY||override;};for(var i=0;i<this.states.length;i++){var state=this.states[i];if(state!=null){if(this.horizontal){snapX.call(this,state.getCenterX());snapX.call(this,state.x);snapX.call(this,state.x+state.width);}if(this.vertical){snapY.call(this,state.getCenterY());snapY.call(this,state.y);snapY.call(this,state.y+state.height);}}}if(!overrideX&&this.guideX!=null){this.guideX.node.style.visibility='hidden';}else if(this.guideX!=null){this.guideX.node.style.visibility='visible';this.guideX.redraw();}if(!overrideY&&this.guideY!=null){this.guideY.node.style.visibility='hidden';}else if(this.guideY!=null){this.guideY.node.style.visibility='visible';this.guideY.redraw();}if(gridEnabled){if(!overrideX){var tx=bounds.x-(this.graph.snap(bounds.x/scale-trx.x)+trx.x)*scale;dx=this.graph.snap(dx/scale)*scale-tx;}if(!overrideY){var ty=bounds.y-(this.graph.snap(bounds.y/scale-trx.y)+trx.y)*scale;dy=this.graph.snap(dy/scale)*scale-ty;}}delta=new mxPoint(dx,dy);}return delta;};mxGuide.prototype.hide=function(){if(this.guideX!=null){this.guideX.node.style.visibility='hidden';}if(this.guideY!=null){this.guideY.node.style.visibility='hidden';}};mxGuide.prototype.destroy=function(){if(this.guideX!=null){this.guideX.destroy();this.guideX=null;}if(this.guideY!=null){this.guideY.destroy();this.guideY=null;}};function mxShape(){};mxShape.prototype.SVG_STROKE_TOLERANCE=8;mxShape.prototype.scale=1;mxShape.prototype.dialect=null;mxShape.prototype.crisp=false;mxShape.prototype.roundedCrispSvg=true;mxShape.prototype.mixedModeHtml=true;mxShape.prototype.preferModeHtml=true;mxShape.prototype.bounds=null;mxShape.prototype.points=null;mxShape.prototype.node=null;mxShape.prototype.label=null;mxShape.prototype.innerNode=null;mxShape.prototype.style=null;mxShape.prototype.startOffset=null;mxShape.prototype.endOffset=null;mxShape.prototype.boundingBox=null;mxShape.prototype.vmlNodes=['node','strokeNode','fillNode','shadowNode'];mxShape.prototype.vmlScale=1;mxShape.prototype.setCursor=function(cursor){if(cursor==null){cursor='';}this.cursor=cursor;if(this.innerNode!=null){this.innerNode.style.cursor=cursor;}if(this.node!=null){this.node.style.cursor=cursor;}if(this.pipe!=null){this.pipe.style.cursor=cursor;}};mxShape.prototype.getCursor=function(){return this.cursor;};mxShape.prototype.init=function(container){if(this.node==null){this.node=this.create(container);if(container!=null){var vmlFix=document.documentMode==8&&mxUtils.isVml(this.node);if(vmlFix){for(var i=0;i<this.vmlNodes.length;i++){if(this[this.vmlNodes[i]]!=null){this[this.vmlNodes[i]].setAttribute('id','mxTemporaryReference-'+this.vmlNodes[i]);}}container.insertAdjacentHTML('beforeEnd',this.node.outerHTML);for(var i=0;i<this.vmlNodes.length;i++){if(this[this.vmlNodes[i]]!=null){this[this.vmlNodes[i]]=container.ownerDocument.getElementById('mxTemporaryReference-'+this.vmlNodes[i]);this[this.vmlNodes[i]].removeAttribute('id');}}}else{container.appendChild(this.node);}}}if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null;}};mxShape.prototype.insertGradient=function(node){if(node!=null){var count=0;var id=node.getAttribute('id');var gradient=document.getElementById(id);while(gradient!=null&&gradient.ownerSVGElement!=this.node.ownerSVGElement){count++;id=node.getAttribute('id')+'-'+count;gradient=document.getElementById(id);}if(gradient==null){node.setAttribute('id',id);this.node.ownerSVGElement.appendChild(node);gradient=node;}if(gradient!=null){var ref='url(#'+id+')';var tmp=(this.innerNode!=null)?this.innerNode:this.node;if(tmp!=null&&tmp.getAttribute('fill')!=ref){tmp.setAttribute('fill',ref);}}}};mxShape.prototype.isMixedModeHtml=function(){return this.mixedModeHtml&&!this.isRounded&&!this.isShadow&&this.gradient==null&&mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,0)==0;};mxShape.prototype.create=function(container){var node=null;if(this.dialect==mxConstants.DIALECT_SVG){node=this.createSvg();}else if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.preferModeHtml&&this.dialect==mxConstants.DIALECT_PREFERHTML)||(this.isMixedModeHtml()&&this.dialect==mxConstants.DIALECT_MIXEDHTML)){node=this.createHtml();}else{node=this.createVml();}return node;};mxShape.prototype.createHtml=function(){var node=document.createElement('DIV');this.configureHtmlShape(node);return node;};mxShape.prototype.destroy=function(){if(this.node!=null){mxEvent.release(this.node);if(this.node.parentNode!=null){this.node.parentNode.removeChild(this.node);}if(this.node.glassOverlay){this.node.glassOverlay.parentNode.removeChild(this.node.glassOverlay);this.node.glassOverlay=null;}this.node=null;}};mxShape.prototype.apply=function(state){var style=state.style;this.style=style;if(style!=null){this.fill=mxUtils.getValue(style,mxConstants.STYLE_FILLCOLOR,this.fill);this.gradient=mxUtils.getValue(style,mxConstants.STYLE_GRADIENTCOLOR,this.gradient);this.gradientDirection=mxUtils.getValue(style,mxConstants.STYLE_GRADIENT_DIRECTION,this.gradientDirection);this.opacity=mxUtils.getValue(style,mxConstants.STYLE_OPACITY,this.opacity);this.stroke=mxUtils.getValue(style,mxConstants.STYLE_STROKECOLOR,this.stroke);this.strokewidth=mxUtils.getNumber(style,mxConstants.STYLE_STROKEWIDTH,this.strokewidth);this.isShadow=mxUtils.getValue(style,mxConstants.STYLE_SHADOW,this.isShadow);this.isDashed=mxUtils.getValue(style,mxConstants.STYLE_DASHED,this.isDashed);this.spacing=mxUtils.getValue(style,mxConstants.STYLE_SPACING,this.spacing);this.startSize=mxUtils.getNumber(style,mxConstants.STYLE_STARTSIZE,this.startSize);this.endSize=mxUtils.getNumber(style,mxConstants.STYLE_ENDSIZE,this.endSize);this.isRounded=mxUtils.getValue(style,mxConstants.STYLE_ROUNDED,this.isRounded);this.startArrow=mxUtils.getValue(style,mxConstants.STYLE_STARTARROW,this.startArrow);this.endArrow=mxUtils.getValue(style,mxConstants.STYLE_ENDARROW,this.endArrow);this.rotation=mxUtils.getValue(style,mxConstants.STYLE_ROTATION,this.rotation);this.direction=mxUtils.getValue(style,mxConstants.STYLE_DIRECTION,this.direction);if(this.fill=='none'){this.fill=null;}if(this.gradient=='none'){this.gradient=null;}if(this.stroke=='none'){this.stroke=null;}}};mxShape.prototype.createSvgGroup=function(shape){var g=document.createElementNS(mxConstants.NS_SVG,'g');this.innerNode=document.createElementNS(mxConstants.NS_SVG,shape);this.configureSvgShape(this.innerNode);if(shape=='rect'&&this.strokewidth*this.scale>=1&&!this.isRounded){this.innerNode.setAttribute('shape-rendering','optimizeSpeed');}this.shadowNode=this.createSvgShadow(this.innerNode);if(this.shadowNode!=null){g.appendChild(this.shadowNode);}g.appendChild(this.innerNode);return g;};mxShape.prototype.createSvgShadow=function(node){if(this.isShadow){var shadow=node.cloneNode(true);shadow.setAttribute('opacity',mxConstants.SHADOW_OPACITY);if(this.fill!=null&&this.fill!=mxConstants.NONE){shadow.setAttribute('fill',mxConstants.SHADOWCOLOR);}if(this.stroke!=null&&this.stroke!=mxConstants.NONE){shadow.setAttribute('stroke',mxConstants.SHADOWCOLOR);}return shadow;}return null;};mxShape.prototype.configureHtmlShape=function(node){if(mxUtils.isVml(node)){this.configureVmlShape(node);}else{node.style.position='absolute';node.style.overflow='hidden';var color=this.stroke;if(color!=null&&color!=mxConstants.NONE){node.style.borderColor=color;if(this.isDashed){node.style.borderStyle='dashed';}else if(this.strokewidth>0){node.style.borderStyle='solid';}node.style.borderWidth=Math.ceil(this.strokewidth*this.scale)+'px';}else{node.style.borderWidth='0px';}color=this.fill;node.style.background='';if(color!=null&&color!=mxConstants.NONE){node.style.backgroundColor=color;}else if(this.points==null){this.configureTransparentBackground(node);}if(this.opacity!=null){mxUtils.setOpacity(node,this.opacity);}}};mxShape.prototype.updateVmlFill=function(node,c1,c2,dir,alpha){node.color=c1;if(alpha!=null&&alpha!=100){node.opacity=alpha+'%';if(c2!=null){node.setAttribute('o:opacity2',alpha+'%');}}if(c2!=null){node.type='gradient';node.color2=c2;var angle='180';if(this.gradientDirection==mxConstants.DIRECTION_EAST){angle='270';}else if(this.gradientDirection==mxConstants.DIRECTION_WEST){angle='90';}else if(this.gradientDirection==mxConstants.DIRECTION_NORTH){angle='0';}node.angle=angle;}};mxShape.prototype.updateVmlStrokeNode=function(parent){if(this.strokeNode==null){this.strokeNode=document.createElement('v:stroke');this.strokeNode.joinstyle='miter';this.strokeNode.miterlimit=4;parent.appendChild(this.strokeNode);}if(this.opacity!=null){this.strokeNode.opacity=this.opacity+'%';}this.updateVmlDashStyle();};mxShape.prototype.updateVmlStrokeColor=function(node){var color=this.stroke;if(color!=null&&color!=mxConstants.NONE){node.stroked='true';node.strokecolor=color;}else{node.stroked='false';}};mxShape.prototype.configureVmlShape=function(node){node.style.position='absolute';this.updateVmlStrokeColor(node);node.style.background='';var color=this.fill;if(color!=null&&color!=mxConstants.NONE){if(this.fillNode==null){this.fillNode=document.createElement('v:fill');node.appendChild(this.fillNode);}this.updateVmlFill(this.fillNode,color,this.gradient,this.gradientDirection,this.opacity);}else{node.filled='false';if(this.points==null){this.configureTransparentBackground(node);}}this.updateVmlStrokeNode(node);if(this.isShadow){this.createVmlShadow(node);}if(node.nodeName=='roundrect'){try{var f=mxConstants.RECTANGLE_ROUNDING_FACTOR*100;if(this.style!=null){f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,f);}node.setAttribute('arcsize',String(f)+'%');}catch(e){}}};mxShape.prototype.createVmlShadow=function(node){if(this.shadowNode==null){this.shadowNode=document.createElement('v:shadow');this.shadowNode.on='true';this.shadowNode.color=mxConstants.SHADOWCOLOR;this.shadowNode.opacity=(mxConstants.SHADOW_OPACITY*100)+'%';this.shadowStrokeNode=document.createElement('v:stroke');this.shadowNode.appendChild(this.shadowStrokeNode);node.appendChild(this.shadowNode);}};mxShape.prototype.configureTransparentBackground=function(node){node.style.background='url(\''+mxClient.imageBasePath+'/transparent.gif\')';};mxShape.prototype.configureSvgShape=function(node){var color=this.stroke;if(color!=null&&color!=mxConstants.NONE){node.setAttribute('stroke',color);}else{node.setAttribute('stroke','none');}color=this.fill;if(color!=null&&color!=mxConstants.NONE){if(this.gradient!=null){var id=this.getGradientId(color,this.gradient);if(this.gradientNode!=null&&this.gradientNode.getAttribute('id')!=id){this.gradientNode=null;node.setAttribute('fill','');}if(this.gradientNode==null){this.gradientNode=this.createSvgGradient(id,color,this.gradient,node);node.setAttribute('fill','url(#'+id+')');}}else{this.gradientNode=null;node.setAttribute('fill',color);}}else{node.setAttribute('fill','none');}if(this.opacity!=null){node.setAttribute('fill-opacity',this.opacity/100);node.setAttribute('stroke-opacity',this.opacity/100);}};mxShape.prototype.getGradientId=function(start,end){if(start.charAt(0)=='#'){start=start.substring(1);}if(end.charAt(0)=='#'){end=end.substring(1);}start=start.toLowerCase();end=end.toLowerCase();var dir=null;if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){dir='south';}else if(this.gradientDirection==mxConstants.DIRECTION_EAST){dir='east';}else{var tmp=start;start=end;end=tmp;if(this.gradientDirection==mxConstants.DIRECTION_NORTH){dir='south';}else if(this.gradientDirection==mxConstants.DIRECTION_WEST){dir='east';}}return 'mx-gradient-'+start+'-'+end+'-'+dir;};mxShape.prototype.createSvgPipe=function(id,start,end,node){var pipe=document.createElementNS(mxConstants.NS_SVG,'path');pipe.setAttribute('pointer-events','stroke');pipe.setAttribute('fill','none');pipe.setAttribute('visibility','hidden');pipe.setAttribute('stroke',(mxClient.IS_OP)?'none':'white');return pipe;};mxShape.prototype.createSvgGradient=function(id,start,end,node){var gradient=this.insertGradientNode;if(gradient==null){gradient=document.createElementNS(mxConstants.NS_SVG,'linearGradient');gradient.setAttribute('id',id);gradient.setAttribute('x1','0%');gradient.setAttribute('y1','0%');gradient.setAttribute('x2','0%');gradient.setAttribute('y2','0%');if(this.gradientDirection==null||this.gradientDirection==mxConstants.DIRECTION_SOUTH){gradient.setAttribute('y2','100%');}else if(this.gradientDirection==mxConstants.DIRECTION_EAST){gradient.setAttribute('x2','100%');}else if(this.gradientDirection==mxConstants.DIRECTION_NORTH){gradient.setAttribute('y1','100%');}else if(this.gradientDirection==mxConstants.DIRECTION_WEST){gradient.setAttribute('x1','100%');}var stop=document.createElementNS(mxConstants.NS_SVG,'stop');stop.setAttribute('offset','0%');stop.setAttribute('style','stop-color:'+start);gradient.appendChild(stop);stop=document.createElementNS(mxConstants.NS_SVG,'stop');stop.setAttribute('offset','100%');stop.setAttribute('style','stop-color:'+end);gradient.appendChild(stop);}this.insertGradientNode=gradient;return gradient;};mxShape.prototype.createPoints=function(moveCmd,lineCmd,curveCmd,isRelative){var offsetX=(isRelative)?this.bounds.x:0;var offsetY=(isRelative)?this.bounds.y:0;var crisp=(this.crisp&&this.dialect==mxConstants.DIALECT_SVG&&mxClient.IS_IE)?0.5:0;if(isNaN(this.points[0].x)||isNaN(this.points[0].y)){return null;}var size=mxConstants.LINE_ARCSIZE*this.scale;var p0=this.points[0];if(this.startOffset!=null){p0=p0.clone();p0.x+=this.startOffset.x;p0.y+=this.startOffset.y;}var points=moveCmd+' '+(Math.round(p0.x-offsetX)+crisp)+' '+(Math.round(p0.y-offsetY)+crisp)+' ';for(var i=1;i<this.points.length;i++){p0=this.points[i-1];var pt=this.points[i];if(isNaN(pt.x)||isNaN(pt.y)){return null;}if(i==this.points.length-1&&this.endOffset!=null){pt=pt.clone();pt.x+=this.endOffset.x;pt.y+=this.endOffset.y;}var dx=p0.x-pt.x;var dy=p0.y-pt.y;if((this.isRounded&&i<this.points.length-1)&&(dx!=0||dy!=0)&&this.scale>0.3){var dist=Math.sqrt(dx*dx+dy*dy);var nx1=dx*Math.min(size,dist/2)/dist;var ny1=dy*Math.min(size,dist/2)/dist;points+=lineCmd+' '+(Math.round(pt.x+nx1-offsetX)+crisp)+' '+(Math.round(pt.y+ny1-offsetY)+crisp)+' ';var pe=this.points[i+1];dx=pe.x-pt.x;dy=pe.y-pt.y;dist=Math.max(1,Math.sqrt(dx*dx+dy*dy));if(dist!=0){var nx2=dx*Math.min(size,dist/2)/dist;var ny2=dy*Math.min(size,dist/2)/dist;points+=curveCmd+' '+Math.round(pt.x-offsetX)+' '+Math.round(pt.y-offsetY)+' '+Math.round(pt.x-offsetX)+','+Math.round(pt.y-offsetY)+' '+(Math.round(pt.x+nx2-offsetX)+crisp)+' '+(Math.round(pt.y+ny2-offsetY)+crisp)+' ';}}else{points+=lineCmd+' '+(Math.round(pt.x-offsetX)+crisp)+' '+(Math.round(pt.y-offsetY)+crisp)+' ';}}return points;};mxShape.prototype.updateHtmlShape=function(node){if(node!=null){if(mxUtils.isVml(node)){this.updateVmlShape(node);}else{var sw=Math.ceil(this.strokewidth*this.scale);node.style.borderWidth=Math.max(1,sw)+'px';if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){node.style.left=Math.round(this.bounds.x-sw/2)+'px';node.style.top=Math.round(this.bounds.y-sw/2)+'px';if(document.compatMode=='CSS1Compat'){sw=-sw;}node.style.width=Math.round(Math.max(0,this.bounds.width+sw))+'px';node.style.height=Math.round(Math.max(0,this.bounds.height+sw))+'px';if(this.bounds.width==0||this.bounds.height==0){node.style.visibility='hidden';}else{node.style.visibility='visible';}}}if(this.points!=null&&this.bounds!=null&&!mxUtils.isVml(node)){if(this.divContainer==null){this.divContainer=node;}while(this.divContainer.firstChild!=null){mxEvent.release(this.divContainer.firstChild);this.divContainer.removeChild(this.divContainer.firstChild);}node.style.borderStyle='';node.style.background='';if(this.points.length==2){var p0=this.points[0];var pe=this.points[1];var dx=pe.x-p0.x;var dy=pe.y-p0.y;if(dx==0||dy==0){node.style.borderStyle='solid';}else{node.style.width=Math.round(this.bounds.width+1)+'px';node.style.height=Math.round(this.bounds.height+1)+'px';var length=Math.sqrt(dx*dx+dy*dy);var dotCount=1+(length/(8*this.scale));var nx=dx/dotCount;var ny=dy/dotCount;var x=p0.x-this.bounds.x;var y=p0.y-this.bounds.y;for(var i=0;i<dotCount;i++){var tmp=document.createElement('DIV');tmp.style.position='absolute';tmp.style.overflow='hidden';tmp.style.left=Math.round(x)+'px';tmp.style.top=Math.round(y)+'px';tmp.style.width=Math.max(1,2*this.scale)+'px';tmp.style.height=Math.max(1,2*this.scale)+'px';tmp.style.backgroundColor=this.stroke;this.divContainer.appendChild(tmp);x+=nx;y+=ny;}}}else if(this.points.length==3){var mid=this.points[1];var n='0';var s='1';var w='0';var e='1';if(mid.x==this.bounds.x){e='0';w='1';}if(mid.y==this.bounds.y){n='1';s='0';}node.style.borderStyle='solid';node.style.borderWidth=n+' '+e+' '+s+' '+w+'px';}else{node.style.width=Math.round(this.bounds.width+1)+'px';node.style.height=Math.round(this.bounds.height+1)+'px';var last=this.points[0];for(var i=1;i<this.points.length;i++){var next=this.points[i];var tmp=document.createElement('DIV');tmp.style.position='absolute';tmp.style.overflow='hidden';tmp.style.borderColor=this.stroke;tmp.style.borderStyle='solid';tmp.style.borderWidth='1 0 0 1px';var x=Math.min(next.x,last.x)-this.bounds.x;var y=Math.min(next.y,last.y)-this.bounds.y;var w=Math.max(1,Math.abs(next.x-last.x));var h=Math.max(1,Math.abs(next.y-last.y));tmp.style.left=x+'px';tmp.style.top=y+'px';tmp.style.width=w+'px';tmp.style.height=h+'px';this.divContainer.appendChild(tmp);last=next;}}}}};mxShape.prototype.updateVmlDashStyle=function(){if(this.isDashed){if(this.strokeNode.dashstyle!='dash'){this.strokeNode.dashstyle='dash';}}else if(this.strokeNode.dashstyle!='solid'){this.strokeNode.dashstyle='solid';}};mxShape.prototype.updateVmlShape=function(node){node.strokeweight=(this.strokewidth*this.scale)+'px';if(this.strokeNode!=null){this.updateVmlDashStyle();}if(this.shadowNode!=null){var dx=Math.round(mxConstants.SHADOW_OFFSET_X*this.scale);var dy=Math.round(mxConstants.SHADOW_OFFSET_Y*this.scale);this.shadowNode.offset=dx+'px,'+dy+'px';}if(this.bounds!=null&&!isNaN(this.bounds.x)&&!isNaN(this.bounds.y)&&!isNaN(this.bounds.width)&&!isNaN(this.bounds.height)){var f=1;var w=Math.max(0,Math.round(this.bounds.width));var h=Math.max(0,Math.round(this.bounds.height));if(this.points!=null||node.nodeName=='shape'||node.nodeName=='group'){var tmp=(node.parentNode.nodeName=='group')?1:this.vmlScale;node.coordsize=(w*tmp)+','+(h*tmp);}else if(node.parentNode.nodeName=='group'){f=this.vmlScale;}if(node.parentNode!=this.node){node.style.left=Math.round(this.bounds.x*f)+'px';node.style.top=Math.round(this.bounds.y*f)+'px';if(this.points==null){if(this.rotation!=null&&this.rotation!=0){node.style.rotation=this.rotation;}else if(node.style.rotation!=null){node.style.rotation='';}}}node.style.width=(w*f)+'px';node.style.height=(h*f)+'px';}if(this.points!=null&&node.nodeName!='group'){if(node.nodeName=='polyline'&&node.points!=null){var points='';for(var i=0;i<this.points.length;i++){points+=this.points[i].x+','+this.points[i].y+' ';}node.points.value=points;node.style.left=null;node.style.top=null;node.style.width=null;node.style.height=null;}else if(this.bounds!=null){var points=this.createPoints('m','l','c',true);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){var pts=this.points;var n=pts.length;if(n>3){var x0=this.bounds.x;var y0=this.bounds.y;points='m '+Math.round(pts[0].x-x0)+' '+Math.round(pts[0].y-y0)+' qb';for(var i=1;i<n-1;i++){points+=' '+Math.round(pts[i].x-x0)+' '+Math.round(pts[i].y-y0);}points+=' nf l '+Math.round(pts[n-1].x-x0)+' '+Math.round(pts[n-1].y-y0);}}node.path=points+' e';}}};mxShape.prototype.updateSvgBounds=function(node){var w=this.bounds.width;var h=this.bounds.height;if(this.isRounded&&!(this.crisp&&mxClient.IS_IE)){node.setAttribute('x',this.bounds.x);node.setAttribute('y',this.bounds.y);node.setAttribute('width',w);node.setAttribute('height',h);}else{var dd=(this.crisp&&mxClient.IS_IE)?0.5:0;node.setAttribute('x',Math.round(this.bounds.x)+dd);node.setAttribute('y',Math.round(this.bounds.y)+dd);w=Math.round(w);h=Math.round(h);node.setAttribute('width',w);node.setAttribute('height',h);}if(this.isRounded){var f=mxConstants.RECTANGLE_ROUNDING_FACTOR*100;if(this.style!=null){f=mxUtils.getValue(this.style,mxConstants.STYLE_ARCSIZE,f)/100;}var r=Math.min(w*f,h*f);node.setAttribute('rx',r);node.setAttribute('ry',r);}this.updateSvgTransform(node,node==this.shadowNode);};mxShape.prototype.updateSvgPath=function(node){var d=this.createPoints('M','L','C',false);if(d!=null){node.setAttribute('d',d);if(this.style!=null&&this.style[mxConstants.STYLE_SMOOTH]){var pts=this.points;var n=pts.length;if(n>3){var points='M '+pts[0].x+' '+pts[0].y+' ';points+=' Q '+pts[1].x+' '+pts[1].y+' '+' '+pts[2].x+' '+pts[2].y;for(var i=3;i<n;i++){points+=' T '+pts[i].x+' '+pts[i].y;}node.setAttribute('d',points);}}node.removeAttribute('x');node.removeAttribute('y');node.removeAttribute('width');node.removeAttribute('height');}};mxShape.prototype.updateSvgScale=function(node){node.setAttribute('stroke-width',Math.round(Math.max(1,this.strokewidth*this.scale)));if(this.isDashed){var phase=Math.max(1,Math.round(3*this.scale*this.strokewidth));node.setAttribute('stroke-dasharray',phase+' '+phase);}if(this.crisp&&(this.roundedCrispSvg||this.isRounded!=true)){node.setAttribute('shape-rendering','crispEdges');}else{node.removeAttribute('shape-rendering');}};mxShape.prototype.updateSvgShape=function(node){if(this.points!=null&&this.points[0]!=null){this.updateSvgPath(node);}else if(this.bounds!=null){this.updateSvgBounds(node);}this.updateSvgScale(node);};mxShape.prototype.getSvgShadowTransform=function(node,shadow){var dx=mxConstants.SHADOW_OFFSET_X*this.scale;var dy=mxConstants.SHADOW_OFFSET_Y*this.scale;return 'translate('+dx+' '+dy+')';};mxShape.prototype.updateSvgTransform=function(node,shadow){var st=(shadow)?this.getSvgShadowTransform():'';if(this.rotation!=null&&this.rotation!=0){var cx=this.bounds.x+this.bounds.width/2;var cy=this.bounds.y+this.bounds.height/2;node.setAttribute('transform','rotate('+this.rotation+','+cx+','+cy+') '+st);}else{if(shadow){node.setAttribute('transform',st);}else{node.removeAttribute('transform');}}};mxShape.prototype.reconfigure=function(){if(this.dialect==mxConstants.DIALECT_SVG){if(this.innerNode!=null){this.configureSvgShape(this.innerNode);}else{this.configureSvgShape(this.node);}if(this.insertGradientNode!=null){this.insertGradient(this.insertGradientNode);this.insertGradientNode=null;}}else if(mxUtils.isVml(this.node)){this.node.style.visibility='hidden';this.configureVmlShape(this.node);this.node.style.visibility='visible';}else{this.node.style.visibility='hidden';this.configureHtmlShape(this.node);this.node.style.visibility='visible';}};mxShape.prototype.redraw=function(){this.updateBoundingBox();if(this.dialect==mxConstants.DIALECT_SVG){this.redrawSvg();}else if(mxUtils.isVml(this.node)){this.node.style.visibility='hidden';this.redrawVml();this.node.style.visibility='visible';}else{this.redrawHtml();}};mxShape.prototype.updateBoundingBox=function(){if(this.bounds!=null){var bbox=this.createBoundingBox();this.augmentBoundingBox(bbox);bbox.x=Math.floor(bbox.x);bbox.y=Math.floor(bbox.y);bbox.width=Math.ceil(bbox.width);bbox.height=Math.ceil(bbox.height);this.boundingBox=bbox;}};mxShape.prototype.createBoundingBox=function(){return this.bounds.clone();};mxShape.prototype.augmentBoundingBox=function(bbox){if(this.isShadow){bbox.width+=Math.ceil(mxConstants.SHADOW_OFFSET_X*this.scale);bbox.height+=Math.ceil(mxConstants.SHADOW_OFFSET_Y*this.scale);}var sw=Math.ceil(this.strokewidth*this.scale);bbox.grow(Math.floor(sw/2));};mxShape.prototype.redrawSvg=function(){if(this.innerNode!=null){this.updateSvgShape(this.innerNode);if(this.shadowNode!=null){this.updateSvgShape(this.shadowNode);}}else{this.updateSvgShape(this.node);if(this.shadowNode!=null){this.shadowNode.setAttribute('transform',this.getSvgShadowTransform());}}this.updateSvgGlassPane();};mxShape.prototype.updateVmlGlassPane=function(){if(this.bounds!=null&&this.node.nodeName=='group'&&this.style!=null&&mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,0)==1){if(this.node.glassOverlay==null){this.node.glassOverlay=document.createElement('v:shape');this.node.glassOverlay.setAttribute('filled','true');this.node.glassOverlay.setAttribute('fillcolor','white');this.node.glassOverlay.setAttribute('stroked','false');var fillNode=document.createElement('v:fill');fillNode.setAttribute('type','gradient');fillNode.setAttribute('color','white');fillNode.setAttribute('color2','white');fillNode.setAttribute('opacity','90%');fillNode.setAttribute('o:opacity2','15%');fillNode.setAttribute('angle','180');this.node.glassOverlay.appendChild(fillNode);this.node.appendChild(this.node.glassOverlay);}var size=0.4;var b=this.bounds;var sw=Math.ceil(this.strokewidth*this.scale/2+1);var d='m '+(-sw)+' '+(-sw)+' l '+(-sw)+' '+Math.round(b.height*size)+' c '+Math.round(b.width*0.3)+' '+Math.round(b.height*0.6)+' '+Math.round(b.width*0.7)+' '+Math.round(b.height*0.6)+' '+Math.round(b.width+sw)+' '+Math.round(b.height*size)+' l '+Math.round(b.width+sw)+' '+(-sw)+' x e';this.node.glassOverlay.style.position='absolute';this.node.glassOverlay.style.width=b.width+'px';this.node.glassOverlay.style.height=b.height+'px';this.node.glassOverlay.setAttribute('coordsize',Math.round(this.bounds.width)+','+Math.round(this.bounds.height));this.node.glassOverlay.setAttribute('path',d);}else if(this.node.glassOverlay!=null){this.node.glassOverlay.parentNode.removeChild(this.node.glassOverlay);this.node.glassOverlay=null;}};mxShape.prototype.updateSvgGlassPane=function(){if(this.node.nodeName=='g'&&this.style!=null&&mxUtils.getValue(this.style,mxConstants.STYLE_GLASS,0)==1){if(this.node.glassOverlay==null){if(this.node.ownerSVGElement.glassGradient==null){var glassGradient=document.createElementNS(mxConstants.NS_SVG,'linearGradient');glassGradient.setAttribute('x1','0%');glassGradient.setAttribute('y1','0%');glassGradient.setAttribute('x2','0%');glassGradient.setAttribute('y2','100%');var stop1=document.createElementNS(mxConstants.NS_SVG,'stop');stop1.setAttribute('offset','0%');stop1.setAttribute('style','stop-color:#ffffff;stop-opacity:0.9');glassGradient.appendChild(stop1);var stop2=document.createElementNS(mxConstants.NS_SVG,'stop');stop2.setAttribute('offset','100%');stop2.setAttribute('style','stop-color:#ffffff;stop-opacity:0.1');glassGradient.appendChild(stop2);var prefix='mx-glass-gradient-';var counter=0;while(document.getElementById(prefix+counter)!=null){counter++;}glassGradient.setAttribute('id',prefix+counter);this.node.ownerSVGElement.appendChild(glassGradient);this.node.ownerSVGElement.glassGradient=glassGradient;}this.node.glassOverlay=document.createElementNS(mxConstants.NS_SVG,'path');var id=this.node.ownerSVGElement.glassGradient.getAttribute('id');this.node.glassOverlay.setAttribute('style','fill:url(#'+id+');');this.node.appendChild(this.node.glassOverlay);}var size=0.4;var b=this.bounds;var sw=Math.ceil(this.strokewidth*this.scale/2);var d='m '+(b.x-sw)+','+(b.y-sw)+' L '+(b.x-sw)+','+(b.y+b.height*size)+' Q '+(b.x+b.width*0.5)+','+(b.y+b.height*0.7)+' '+(b.x+b.width+sw)+','+(b.y+b.height*size)+' L '+(b.x+b.width+sw)+','+(b.y-sw)+' z';this.node.glassOverlay.setAttribute('d',d);}else if(this.node.glassOverlay!=null){this.node.glassOverlay.parentNode.removeChild(this.node.glassOverlay);this.node.glassOverlay=null;}};mxShape.prototype.redrawVml=function(){this.node.style.visibility='hidden';this.updateVmlShape(this.node);this.updateVmlGlassPane();this.node.style.visibility='visible';};mxShape.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);};mxShape.prototype.getRotation=function(){var rot=this.rotation||0;if(this.direction!=null){if(this.direction=='north'){rot+=270;}else if(this.direction=='west'){rot+=180;}else if(this.direction=='south'){rot+=90;}}return rot;};mxShape.prototype.createPath=function(arg){var x=this.bounds.x;var y=this.bounds.y;var w=this.bounds.width;var h=this.bounds.height;var dx=0;var dy=0;if(this.direction=='north'||this.direction=='south'){dx=(w-h)/2;dy=(h-w)/2;x+=dx;y+=dy;var tmp=w;w=h;h=tmp;}var rotation=this.getRotation();var path=null;if(this.dialect==mxConstants.DIALECT_SVG){path=new mxPath('svg');path.setTranslate(x,y);if(rotation!=0){var cx=this.bounds.getCenterX();var cy=this.bounds.getCenterY();var transform='rotate('+rotation+' '+cx+' '+cy+')';if(this.innerNode!=null){this.innerNode.setAttribute('transform',transform);}if(this.foreground!=null){this.foreground.setAttribute('transform',transform);}if(this.shadowNode!=null){this.shadowNode.setAttribute('transform',this.getSvgShadowTransform()+' '+transform);}}}else{path=new mxPath('vml');path.setTranslate(dx,-dx);path.scale=this.vmlScale;if(rotation!=0){this.node.style.rotation=rotation;}}this.redrawPath(path,x,y,w,h,arg);return path.getPath();};mxShape.prototype.redrawPath=function(path,x,y,w,h){};function mxStencil(desc){this.desc=desc;this.parseDescription();this.parseConstraints();};mxStencil.prototype.desc=null;mxStencil.prototype.constraints=null;mxStencil.prototype.aspect=null;mxStencil.prototype.w0=null;mxStencil.prototype.h0=null;mxStencil.prototype.bgNode=null;mxStencil.prototype.fgNode=null;mxStencil.prototype.strokewidth=null;mxStencil.prototype.parseDescription=function(){this.fgNode=this.desc.getElementsByTagName('foreground')[0];this.bgNode=this.desc.getElementsByTagName('background')[0];this.w0=Number(this.desc.getAttribute('w')||100);this.h0=Number(this.desc.getAttribute('h')||100);var aspect=this.desc.getAttribute('aspect');this.aspect=(aspect!=null)?aspect:'variable';var sw=this.desc.getAttribute('strokewidth');this.strokewidth=(sw!=null)?sw:'1';};mxStencil.prototype.parseConstraints=function(){var conns=this.desc.getElementsByTagName('connections')[0];if(conns!=null){var tmp=mxUtils.getChildNodes(conns);if(tmp!=null&&tmp.length>0){this.constraints=[];for(var i=0;i<tmp.length;i++){this.constraints.push(this.parseConstraint(tmp[i]));}}}};mxStencil.prototype.parseConstraint=function(node){var x=Number(node.getAttribute('x'));var y=Number(node.getAttribute('y'));var perimeter=node.getAttribute('perimeter')=='1';return new mxConnectionConstraint(new mxPoint(x,y),perimeter);};mxStencil.prototype.evaluateAttribute=function(node,attribute,state){var result=node.getAttribute(attribute);if(result==null){var text=mxUtils.getTextContent(node);if(text!=null){var funct=mxUtils.eval(text);if(typeof(funct)=='function'){result=funct(state);}}}return result;};mxStencil.prototype.renderDom=function(shape,bounds,parentNode,state){var vml=shape.dialect!=mxConstants.DIALECT_SVG;var rotation=shape.rotation||0;var inverse=false;if(shape.direction!=null){if(shape.direction=='north'){rotation+=270;}else if(shape.direction=='west'){rotation+=180;}else if(shape.direction=='south'){rotation+=90;}inverse=(shape.direction=='north'||shape.direction=='south');}var flipH=shape.style[mxConstants.STYLE_STENCIL_FLIPH];var flipV=shape.style[mxConstants.STYLE_STENCIL_FLIPV];if(flipH&&flipV){rotation+=180;flipH=false;flipV=false;}var svgTransform='';if(vml){if(flipH){parentNode.style.flip='x';}else if(flipV){parentNode.style.flip='y';}if(rotation!=0){parentNode.style.rotation=rotation;}}else{if(flipH||flipV){var sx=1;var sy=1;var dx=0;var dy=0;if(flipH){sx=-1;dx=-bounds.width-2*bounds.x;}if(flipV){sy=-1;dy=-bounds.height-2*bounds.y;}svgTransform='scale('+sx+' '+sy+') translate('+dx+' '+dy+')';}if(rotation!=0){var cx=bounds.getCenterX();var cy=bounds.getCenterY();svgTransform+=' rotate('+rotation+' '+cx+' '+cy+')';}}var background=(state==null);if(this.bgNode!=null||this.fgNode!=null){var x0=(vml&&state==null)?0:bounds.x;var y0=(vml&&state==null)?0:bounds.y;var sx=bounds.width/this.w0;var sy=bounds.height/this.h0;this.lastMoveX=0;this.lastMoveY=0;if(inverse){sy=bounds.width/this.h0;sx=bounds.height/this.w0;var delta=(bounds.width-bounds.height)/2;var f=(vml)?shape.vmlScale:1;x0+=delta*f;y0-=delta*f;}if(this.aspect=='fixed'){sy=Math.min(sx,sy);sx=sy;if(inverse){x0+=(bounds.height-this.w0*sx)/2;y0+=(bounds.width-this.h0*sy)/2;}else{x0+=(bounds.width-this.w0*sx)/2;y0+=(bounds.height-this.h0*sy)/2;}}if(vml){sx*=shape.vmlScale;sy*=shape.vmlScale;}var minScale=Math.min(sx,sy);var stack=[];var currentState=(state!=null)?state:{fillColorAssigned:false,fill:shape.fill,stroke:shape.stroke,strokeWidth:(this.strokewidth=='inherit')?Number(shape.strokewidth)*shape.scale:Number(this.strokewidth)*minScale/((vml)?shape.vmlScale:1),dashed:shape.isDashed,dashpattern:[3,3],alpha:shape.opacity,linejoin:'miter',fontColor:'#000000',fontSize:mxConstants.DEFAULT_FONTSIZE,fontFamily:mxConstants.DEFAULT_FONTFAMILY,fontStyle:0};var currentPath=null;var currentPoints=null;var configurePath=function(path,state){var sw=Math.round(Math.max(1,state.strokeWidth));if(vml){path.strokeweight=sw+'px';if(state.fill!=null){var gradient=(!state.fillColorAssigned)?shape.gradient:null;var fill=document.createElement('v:fill');shape.updateVmlFill(fill,state.fill,gradient,shape.gradientDirection,state.alpha);path.appendChild(fill);}else{path.filled='false';}if(state.stroke!=null){path.stroked='true';path.strokecolor=state.stroke;}else{path.stroked='false';}path.style.position='absolute';}else{path.setAttribute('stroke-width',sw);if(state.fill!=null&&state.fillColorAssigned){path.setAttribute('fill',state.fill);}if(state.stroke!=null){path.setAttribute('stroke',state.stroke);}}};var addToParent=function(node){if(document.documentMode==8){parentNode.insertAdjacentHTML('beforeEnd',node.outerHTML);}else{parentNode.appendChild(node);}};var addToPath=function(s){if(currentPath!=null&&currentPoints!=null){currentPoints.push(s);}};var round=function(value){return(vml)?Math.round(value):value;};var renderNode=function(node){var name=node.nodeName;var fillOp=name=='fill';var strokeOp=name=='stroke';var fillStrokeOp=name=='fillstroke';if(name=='save'){stack.push(currentState);currentState=mxUtils.clone(currentState);}else if(name=='restore'){currentState=stack.pop();}else if(name=='path'){currentPoints=[];if(vml){currentPath=document.createElement('v:shape');configurePath.call(this,currentPath,currentState);var w=Math.round(bounds.width)*shape.vmlScale;var h=Math.round(bounds.height)*shape.vmlScale;currentPath.style.width=w+'px';currentPath.style.height=h+'px';currentPath.coordsize=w+','+h;}else{currentPath=document.createElementNS(mxConstants.NS_SVG,'path');configurePath.call(this,currentPath,currentState);if(svgTransform.length>0){currentPath.setAttribute('transform',svgTransform);}if(node.getAttribute('crisp')=='1'){currentPath.setAttribute('shape-rendering','crispEdges');}}var childNode=node.firstChild;while(childNode!=null){if(childNode.nodeType==mxConstants.NODETYPE_ELEMENT){renderNode.call(this,childNode);}childNode=childNode.nextSibling;}if(vml){addToPath('e');currentPath.path=currentPoints.join('');}else{currentPath.setAttribute('d',currentPoints.join(''));}}else if(name=='move'){var op=(vml)?'m':'M';this.lastMoveX=round(x0+Number(node.getAttribute('x'))*sx);this.lastMoveY=round(y0+Number(node.getAttribute('y'))*sy);addToPath(op+' '+this.lastMoveX+' '+this.lastMoveY);}else if(name=='line'){var op=(vml)?'l':'L';this.lastMoveX=round(x0+Number(node.getAttribute('x'))*sx);this.lastMoveY=round(y0+Number(node.getAttribute('y'))*sy);addToPath(op+' '+this.lastMoveX+' '+this.lastMoveY);}else if(name=='quad'){if(vml){var cpx0=this.lastMoveX;var cpy0=this.lastMoveY;var qpx1=x0+Number(node.getAttribute('x1'))*sx;var qpy1=y0+Number(node.getAttribute('y1'))*sy;var cpx3=x0+Number(node.getAttribute('x2'))*sx;var cpy3=y0+Number(node.getAttribute('y2'))*sy;var cpx1=cpx0+2/3*(qpx1-cpx0);var cpy1=cpy0+2/3*(qpy1-cpy0);var cpx2=cpx3+2/3*(qpx1-cpx3);var cpy2=cpy3+2/3*(qpy1-cpy3);addToPath('c '+Math.round(cpx1)+' '+Math.round(cpy1)+' '+Math.round(cpx2)+' '+Math.round(cpy2)+' '+Math.round(cpx3)+' '+Math.round(cpy3));this.lastMoveX=cpx3;this.lastMoveY=cpy3;}else{this.lastMoveX=x0+Number(node.getAttribute('x2'))*sx;this.lastMoveY=y0+Number(node.getAttribute('y2'))*sy;addToPath('Q '+(x0+Number(node.getAttribute('x1'))*sx)+' '+(y0+Number(node.getAttribute('y1'))*sy)+' '+this.lastMoveX+' '+this.lastMoveY);}}else if(name=='curve'){var op=(vml)?'c':'C';this.lastMoveX=round(x0+Number(node.getAttribute('x3'))*sx);this.lastMoveY=round(y0+Number(node.getAttribute('y3'))*sy);addToPath(op+' '+round(x0+Number(node.getAttribute('x1'))*sx)+' '+round(y0+Number(node.getAttribute('y1'))*sy)+' '+round(x0+Number(node.getAttribute('x2'))*sx)+' '+round(y0+Number(node.getAttribute('y2'))*sy)+' '+this.lastMoveX+' '+this.lastMoveY);}else if(name=='close'){addToPath((vml)?'x':'Z');}else if(name=='rect'||name=='roundrect'){var rounded=name=='roundrect';var x=round(x0+Number(node.getAttribute('x'))*sx);var y=round(y0+Number(node.getAttribute('y'))*sy);var w=round(Number(node.getAttribute('w'))*sx);var h=round(Number(node.getAttribute('h'))*sy);var arcsize=node.getAttribute('arcsize');if(arcsize==0){arcsize=mxConstants.RECTANGLE_ROUNDING_FACTOR*100;}if(vml){currentPath=document.createElement((rounded)?'v:roundrect':'v:rect');currentPath.style.left=x+'px';currentPath.style.top=y+'px';currentPath.style.width=w+'px';currentPath.style.height=h+'px';if(rounded){currentPath.setAttribute('arcsize',String(arcsize)+'%');}}else{currentPath=document.createElementNS(mxConstants.NS_SVG,'rect');currentPath.setAttribute('x',x);currentPath.setAttribute('y',y);currentPath.setAttribute('width',w);currentPath.setAttribute('height',h);if(rounded){var factor=Number(arcsize)/100;var r=Math.min(w*factor,h*factor);currentPath.setAttribute('rx',r);currentPath.setAttribute('ry',r);}if(svgTransform.length>0){currentPath.setAttribute('transform',svgTransform);}if(node.getAttribute('crisp')=='1'){currentPath.setAttribute('shape-rendering','crispEdges');}}configurePath.call(this,currentPath,currentState);}else if(name=='ellipse'){var x=round(x0+Number(node.getAttribute('x'))*sx);var y=round(y0+Number(node.getAttribute('y'))*sy);var w=round(Number(node.getAttribute('w'))*sx);var h=round(Number(node.getAttribute('h'))*sy);if(vml){currentPath=document.createElement('v:arc');currentPath.startangle='0';currentPath.endangle='360';currentPath.style.left=x+'px';currentPath.style.top=y+'px';currentPath.style.width=w+'px';currentPath.style.height=h+'px';}else{currentPath=document.createElementNS(mxConstants.NS_SVG,'ellipse');currentPath.setAttribute('cx',x+w/2);currentPath.setAttribute('cy',y+h/2);currentPath.setAttribute('rx',w/2);currentPath.setAttribute('ry',h/2);if(svgTransform.length>0){currentPath.setAttribute('transform',svgTransform);}}configurePath.call(this,currentPath,currentState);}else if(name=='arc'){var r1=Number(node.getAttribute('rx'))*sx;var r2=Number(node.getAttribute('ry'))*sy;var angle=Number(node.getAttribute('x-axis-rotation'));var largeArcFlag=Number(node.getAttribute('large-arc-flag'));var sweepFlag=Number(node.getAttribute('sweep-flag'));var x=x0+Number(node.getAttribute('x'))*sx;var y=y0+Number(node.getAttribute('y'))*sy;if(vml){var curves=mxUtils.arcToCurves(this.lastMoveX,this.lastMoveY,r1,r2,angle,largeArcFlag,sweepFlag,x,y);for(var i=0;i<curves.length;i+=6){addToPath('c'+' '+Math.round(curves[i])+' '+Math.round(curves[i+1])+' '+Math.round(curves[i+2])+' '+Math.round(curves[i+3])+' '+Math.round(curves[i+4])+' '+Math.round(curves[i+5]));this.lastMoveX=curves[i+4];this.lastMoveY=curves[i+5];}}else{addToPath('A '+r1+','+r2+' '+angle+' '+largeArcFlag+','+sweepFlag+' '+x+','+y);this.lastMoveX=x0+x;this.lastMoveY=y0+y;}}else if(name=='image'){var src=this.evaluateAttribute(node,'src',shape.state);if(src!=null){var x=round(x0+Number(node.getAttribute('x'))*sx);var y=round(y0+Number(node.getAttribute('y'))*sy);var w=round(Number(node.getAttribute('w'))*sx);var h=round(Number(node.getAttribute('h'))*sy);var aspect=false;var flipH=node.getAttribute('flipH')=='1';var flipV=node.getAttribute('flipV')=='1';if(vml){currentPath=document.createElement('v:image');currentPath.style.filter='alpha(opacity='+currentState.alpha+')';currentPath.style.left=x+'px';currentPath.style.top=y+'px';currentPath.style.width=w+'px';currentPath.style.height=h+'px';currentPath.src=src;if(flipH&&flipV){currentPath.style.rotation='180';}else if(flipH){currentPath.style.flip='x';}else if(flipV){currentPath.style.flip='y';}}else{currentPath=document.createElementNS(mxConstants.NS_SVG,'image');currentPath.setAttributeNS(mxConstants.NS_XLINK,'xlink:href',src);currentPath.setAttribute('opacity',currentState.alpha/100);currentPath.setAttribute('x',x);currentPath.setAttribute('y',y);currentPath.setAttribute('width',w);currentPath.setAttribute('height',h);if(!aspect){currentPath.setAttribute('preserveAspectRatio','none');}if(flipH||flipV){var scx=1;var scy=1;var dx=0;var dy=0;if(flipH){scx=-1;dx=-w-2*x;}if(flipV){scy=-1;dy=-h-2*y;}currentPath.setAttribute('transform',svgTransform+'scale('+scx+' '+scy+')'+' translate('+dx+' '+dy+') ');}else{currentPath.setAttribute('transform',svgTransform);}}addToParent(currentPath);}}else if(name=='include-shape'){var stencil=mxStencilRegistry.getStencil(node.getAttribute('name'));if(stencil!=null){var x=x0+Number(node.getAttribute('x'))*sx;var y=y0+Number(node.getAttribute('y'))*sy;var w=Number(node.getAttribute('w'))*sx;var h=Number(node.getAttribute('h'))*sy;stencil.renderDom(shape,new mxRectangle(x,y,w,h),parentNode,currentState);}}else if(name=='text'){var str=this.evaluateAttribute(node,'str',shape.state);if(str!=null){var x=round(x0+Number(node.getAttribute('x'))*sx);var y=round(y0+Number(node.getAttribute('y'))*sy);var align=node.getAttribute('align')||'left';var valign=node.getAttribute('valign')||'top';if(vml){currentPath=document.createElement('v:line');currentPath.style.position='absolute';currentPath.style.width='1px';currentPath.style.height='1px';currentPath.to=(x+1)+' '+y;currentPath.from=x+' '+y;var fill=document.createElement('v:fill');fill.color=currentState.fontColor;fill.on='true';currentPath.appendChild(fill);var stroke=document.createElement('v:stroke');stroke.on='false';currentPath.appendChild(stroke);var path=document.createElement('v:path');path.textpathok='true';currentPath.appendChild(path);var tp=document.createElement('v:textpath');tp.style.cssText='v-text-align:'+align;tp.style.fontSize=(currentState.fontSize/shape.vmlScale)+'px';tp.style.fontFamily=currentState.fontFamily;tp.string=str;tp.on='true';if((currentState.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){tp.style.fontWeight='bold';}if((currentState.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){tp.style.fontStyle='italic';}if((currentState.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){tp.style.textDecoration='underline';}if(valign=='top'){currentPath.style.top=(currentState.fontSize/2)+'px';}else if(valign=='bottom'){currentPath.style.top=-(currentState.fontSize/3)+'px';}currentPath.appendChild(tp);}else{currentPath=document.createElementNS(mxConstants.NS_SVG,'text');currentPath.setAttribute('fill',currentState.fontColor);currentPath.setAttribute('font-family',currentState.fontFamily);currentPath.setAttribute('font-size',currentState.fontSize);currentPath.setAttribute('stroke','none');currentPath.setAttribute('x',x);currentPath.appendChild(document.createTextNode(str));if((currentState.fontStyle&mxConstants.FONT_BOLD)==mxConstants.FONT_BOLD){currentPath.setAttribute('font-weight','bold');}if((currentState.fontStyle&mxConstants.FONT_ITALIC)==mxConstants.FONT_ITALIC){currentPath.setAttribute('font-style','italic');}if((currentState.fontStyle&mxConstants.FONT_UNDERLINE)==mxConstants.FONT_UNDERLINE){currentPath.setAttribute('text-decoration',uline);}if(align=='left'){align='start';}else if(align=='center'){align='middle';}else if(align=='right'){align='end';}currentPath.setAttribute('text-anchor',align);if(valign=='top'){currentPath.setAttribute('y',y+currentState.fontSize/5);currentPath.setAttribute('dy','1ex');}else if(valign=='middle'){currentPath.setAttribute('y',y+currentState.fontSize/8);currentPath.setAttribute('dy','0.5ex');}else{currentPath.setAttribute('y',y);}if(svgTransform.length>0){currentPath.setAttribute('transform',svgTransform);}}addToParent(currentPath);}}else if(fillOp||strokeOp||fillStrokeOp){if(currentPath!=null){var pattern=null;if(currentState.dashed){var f=(vml)?minScale:Number(currentPath.getAttribute('stroke-width'));var pat=[];for(var i=0;i<currentState.dashpattern.length;i++){pat.push(Math.max(1,Math.round(Number(currentState.dashpattern[i])*f)));}pattern=pat.join(' ');}if(strokeOp||fillStrokeOp){if(vml){var stroke=document.createElement('v:stroke');stroke.endcap=currentState.linecap||'flat';stroke.joinstyle=currentState.linejoin||'miter';stroke.miterlimit=currentState.miterlimit||'10';currentPath.appendChild(stroke);if(pattern!=null){stroke.dashstyle=pattern;}}else{if(currentState.linejoin!=null){currentPath.setAttribute('stroke-linejoin',currentState.linejoin);}if(currentState.linecap!=null){var value=currentState.linecap;if(value=='flat'){value='butt';}currentPath.setAttribute('stroke-linecap',value);}if(currentState.miterlimit!=null){currentPath.setAttribute('stroke-miterlimit',currentState.miterlimit);}if(pattern!=null){currentPath.setAttribute('stroke-dasharray',pattern);}}}if(background&&shape.isShadow){var dx=mxConstants.SHADOW_OFFSET_X*shape.scale;var dy=mxConstants.SHADOW_OFFSET_Y*shape.scale;if(vml){var shadow=document.createElement('v:shadow');shadow.setAttribute('on','true');shadow.setAttribute('color',mxConstants.SHADOWCOLOR);shadow.setAttribute('offset',Math.round(dx)+'px,'+Math.round(dy)+'px');shadow.setAttribute('opacity',(mxConstants.SHADOW_OPACITY*100)+'%');var stroke=document.createElement('v:stroke');stroke.endcap=currentState.linecap||'flat';stroke.joinstyle=currentState.linejoin||'miter';stroke.miterlimit=currentState.miterlimit||'10';if(pattern!=null){stroke.dashstyle=pattern;}shadow.appendChild(stroke);currentPath.appendChild(shadow);}else{var shadow=currentPath.cloneNode(true);shadow.setAttribute('stroke',mxConstants.SHADOWCOLOR);if(currentState.fill!=null&&(fillOp||fillStrokeOp)){shadow.setAttribute('fill',mxConstants.SHADOWCOLOR);}else{shadow.setAttribute('fill','none');}shadow.setAttribute('transform','translate('+dx+' '+dy+') '+(shadow.getAttribute('transform')||''));shadow.setAttribute('opacity',mxConstants.SHADOW_OPACITY);parentNode.appendChild(shadow);}}if(fillOp){if(vml){currentPath.stroked='false';}else{currentPath.setAttribute('stroke','none');}}else if(strokeOp){if(vml){currentPath.filled='false';}else{currentPath.setAttribute('fill','none');}}addToParent(currentPath);}if(background){background=false;}}else if(name=='linecap'){currentState.linecap=node.getAttribute('cap');}else if(name=='linejoin'){currentState.linejoin=node.getAttribute('join');}else if(name=='miterlimit'){currentState.miterlimit=node.getAttribute('limit');}else if(name=='dashed'){currentState.dashed=node.getAttribute('dashed')=='1';}else if(name=='dashpattern'){var value=node.getAttribute('pattern');if(value!=null){currentState.dashpattern=value.split(' ');}}else if(name=='strokewidth'){currentState.strokeWidth=node.getAttribute('width')*minScale;if(vml){currentState.strokeWidth/=shape.vmlScale;}}else if(name=='strokecolor'){currentState.stroke=node.getAttribute('color');}else if(name=='fillcolor'){currentState.fill=node.getAttribute('color');currentState.fillColorAssigned=true;}else if(name=='alpha'){currentState.alpha=Number(node.getAttribute('alpha'));}else if(name=='fontcolor'){currentState.fontColor=node.getAttribute('color');}else if(name=='fontsize'){currentState.fontSize=Number(node.getAttribute('size'))*minScale;}else if(name=='fontfamily'){currentState.fontFamily=node.getAttribute('family');}else if(name=='fontstyle'){currentState.fontStyle=Number(node.getAttribute('style'));}};if(!vml){var rect=document.createElementNS(mxConstants.NS_SVG,'rect');rect.setAttribute('x',bounds.x);rect.setAttribute('y',bounds.y);rect.setAttribute('width',bounds.width);rect.setAttribute('height',bounds.height);rect.setAttribute('fill','none');rect.setAttribute('stroke','none');parentNode.appendChild(rect);}if(this.bgNode!=null){var tmp=this.bgNode.firstChild;while(tmp!=null){if(tmp.nodeType==mxConstants.NODETYPE_ELEMENT){renderNode.call(this,tmp);}tmp=tmp.nextSibling;}}else{background=false;}if(this.fgNode!=null){var tmp=this.fgNode.firstChild;while(tmp!=null){if(tmp.nodeType==mxConstants.NODETYPE_ELEMENT){renderNode.call(this,tmp);}tmp=tmp.nextSibling;}}}};mxStencil.prototype.drawShape=function(canvas,state,bounds,background){var node=(background)?this.bgNode:this.fgNode;if(node!=null){var direction=mxUtils.getValue(state.style,mxConstants.STYLE_DIRECTION,null);var aspect=this.computeAspect(state,bounds,direction);var minScale=Math.min(aspect.width,aspect.height);var sw=(this.strokewidth=='inherit')?Number(mxUtils.getNumber(state.style,mxConstants.STYLE_STROKEWIDTH,1))*state.view.scale:Number(this.strokewidth)*minScale;this.lastMoveX=0;this.lastMoveY=0;canvas.setStrokeWidth(sw);var tmp=node.firstChild;while(tmp!=null){if(tmp.nodeType==mxConstants.NODETYPE_ELEMENT){this.drawNode(canvas,state,tmp,aspect);}tmp=tmp.nextSibling;}return true;}return false;};mxStencil.prototype.computeAspect=function(state,bounds,direction){var x0=bounds.x;var y0=bounds.y;var sx=bounds.width/this.w0;var sy=bounds.height/this.h0;var inverse=(direction=='north'||direction=='south');if(inverse){sy=bounds.width/this.h0;sx=bounds.height/this.w0;var delta=(bounds.width-bounds.height)/2;x0+=delta;y0-=delta;}if(this.aspect=='fixed'){sy=Math.min(sx,sy);sx=sy;if(inverse){x0+=(bounds.height-this.w0*sx)/2;y0+=(bounds.width-this.h0*sy)/2;}else{x0+=(bounds.width-this.w0*sx)/2;y0+=(bounds.height-this.h0*sy)/2;}}return new mxRectangle(x0,y0,sx,sy);};mxStencil.prototype.drawNode=function(canvas,state,node,aspect){var name=node.nodeName;var x0=aspect.x;var y0=aspect.y;var sx=aspect.width;var sy=aspect.height;var minScale=Math.min(sx,sy);if(name=='save'){canvas.save();}else if(name=='restore'){canvas.restore();}else if(name=='path'){canvas.begin();var childNode=node.firstChild;while(childNode!=null){if(childNode.nodeType==mxConstants.NODETYPE_ELEMENT){this.drawNode(canvas,state,childNode,aspect);}childNode=childNode.nextSibling;}}else if(name=='close'){canvas.close();}else if(name=='move'){this.lastMoveX=x0+Number(node.getAttribute('x'))*sx;this.lastMoveY=y0+Number(node.getAttribute('y'))*sy;canvas.moveTo(this.lastMoveX,this.lastMoveY);}else if(name=='line'){this.lastMoveX=x0+Number(node.getAttribute('x'))*sx;this.lastMoveY=y0+Number(node.getAttribute('y'))*sy;canvas.lineTo(this.lastMoveX,this.lastMoveY);}else if(name=='quad'){this.lastMoveX=x0+Number(node.getAttribute('x2'))*sx;this.lastMoveY=y0+Number(node.getAttribute('y2'))*sy;canvas.quadTo(x0+Number(node.getAttribute('x1'))*sx,y0+Number(node.getAttribute('y1'))*sy,this.lastMoveX,this.lastMoveY);}else if(name=='curve'){this.lastMoveX=x0+Number(node.getAttribute('x3'))*sx;this.lastMoveY=y0+Number(node.getAttribute('y3'))*sy;canvas.curveTo(x0+Number(node.getAttribute('x1'))*sx,y0+Number(node.getAttribute('y1'))*sy,x0+Number(node.getAttribute('x2'))*sx,y0+Number(node.getAttribute('y2'))*sy,this.lastMoveX,this.lastMoveY);}else if(name=='arc'){var r1=Number(node.getAttribute('rx'))*sx;var r2=Number(node.getAttribute('ry'))*sy;var angle=Number(node.getAttribute('x-axis-rotation'));var largeArcFlag=Number(node.getAttribute('large-arc-flag'));var sweepFlag=Number(node.getAttribute('sweep-flag'));var x=x0+Number(node.getAttribute('x'))*sx;var y=y0+Number(node.getAttribute('y'))*sy;var curves=mxUtils.arcToCurves(this.lastMoveX,this.lastMoveY,r1,r2,angle,largeArcFlag,sweepFlag,x,y);for(var i=0;i<curves.length;i+=6){canvas.curveTo(curves[i],curves[i+1],curves[i+2],curves[i+3],curves[i+4],curves[i+5]);this.lastMoveX=curves[i+4];this.lastMoveY=curves[i+5];}}else if(name=='rect'){canvas.rect(x0+Number(node.getAttribute('x'))*sx,y0+Number(node.getAttribute('y'))*sy,Number(node.getAttribute('w'))*sx,Number(node.getAttribute('h'))*sy);}else if(name=='roundrect'){var arcsize=node.getAttribute('arcsize');if(arcsize==0){arcsize=mxConstants.RECTANGLE_ROUNDING_FACTOR*100;}var w=Number(node.getAttribute('w'))*sx;var h=Number(node.getAttribute('h'))*sy;var factor=Number(arcsize)/100;var r=Math.min(w*factor,h*factor);canvas.roundrect(x0+Number(node.getAttribute('x'))*sx,y0+Number(node.getAttribute('y'))*sy,w,h,r,r);}else if(name=='ellipse'){canvas.ellipse(x0+Number(node.getAttribute('x'))*sx,y0+Number(node.getAttribute('y'))*sy,Number(node.getAttribute('w'))*sx,Number(node.getAttribute('h'))*sy);}else if(name=='image'){var src=this.evaluateAttribute(node,'src',state);canvas.image(x0+Number(node.getAttribute('x'))*sx,y0+Number(node.getAttribute('y'))*sy,Number(node.getAttribute('w'))*sx,Number(node.getAttribute('h'))*sy,src,false,node.getAttribute('flipH')=='1',node.getAttribute('flipV')=='1');}else if(name=='text'){var str=this.evaluateAttribute(node,'str',state);canvas.text(x0+Number(node.getAttribute('x'))*sx,y0+Number(node.getAttribute('y'))*sy,0,0,str,node.getAttribute('align'),node.getAttribute('valign'),node.getAttribute('vertical'));}else if(name=='include-shape'){var stencil=mxStencilRegistry.getStencil(node.getAttribute('name'));if(stencil!=null){var x=x0+Number(node.getAttribute('x'))*sx;var y=y0+Number(node.getAttribute('y'))*sy;var w=Number(node.getAttribute('w'))*sx;var h=Number(node.getAttribute('h'))*sy;var tmp=new mxRectangle(x,y,w,h);stencil.drawShape(canvas,state,tmp,true);stencil.drawShape(canvas,state,tmp,false);}}else if(name=='fillstroke'){canvas.fillAndStroke();}else if(name=='fill'){canvas.fill();}else if(name=='stroke'){canvas.stroke();}else if(name=='strokewidth'){canvas.setStrokeWidth(Number(node.getAttribute('width'))*minScale);}else if(name=='dashed'){canvas.setDashed(node.getAttribute('dashed')=='1');}else if(name=='dashpattern'){var value=node.getAttribute('pattern');if(value!=null){var tmp=value.split(' ');var pat=[];for(var i=0;i<tmp.length;i++){if(tmp[i].length>0){pat.push(Number(tmp[i])*minScale);}}value=pat.join(' ');canvas.setDashPattern(value);}}else if(name=='strokecolor'){canvas.setStrokeColor(node.getAttribute('color'));}else if(name=='linecap'){canvas.setLineCap(node.getAttribute('cap'));}else if(name=='linejoin'){canvas.setLineJoin(node.getAttribute('join'));}else if(name=='miterlimit'){canvas.setMiterLimit(Number(node.getAttribute('limit')));}else if(name=='fillcolor'){canvas.setFillColor(node.getAttribute('color'));}else if(name=='fontcolor'){canvas.setFontColor(node.getAttribute('color'));}else if(name=='fontstyle'){canvas.setFontStyle(node.getAttribute('style'));}else if(name=='fontfamily'){canvas.setFontFamily(node.getAttribute('family'));}else if(name=='fontsize'){canvas.setFontSize(Number(node.getAttribute('size'))*minScale);}};var mxStencilRegistry={stencils:[],addStencil:function(name,stencil){mxStencilRegistry.stencils[name]=stencil;},getStencil:function(name){return mxStencilRegistry.stencils[name];}};function mxStencilShape(stencil){this.stencil=stencil;};mxStencilShape.prototype=new mxShape();mxStencilShape.prototype.constructor=mxStencilShape;mxStencilShape.prototype.mixedModeHtml=false;mxStencilShape.prototype.preferModeHtml=false;mxStencilShape.prototype.stencil=null;mxStencilShape.prototype.state=null;mxStencilShape.prototype.vmlScale=4;mxStencilShape.prototype.apply=function(state){this.state=state;mxShape.prototype.apply.apply(this,arguments);};mxStencilShape.prototype.createSvg=function(){var node=document.createElementNS(mxConstants.NS_SVG,'g');this.configureSvgShape(node);return node;};mxStencilShape.prototype.configureHtmlShape=function(node){mxShape.prototype.configureHtmlShape.apply(this,arguments);if(!mxUtils.isVml(node)){node.style.overflow='visible';}};mxStencilShape.prototype.createVml=function(){var name=(document.documentMode==8)?'div':'v:group';var node=document.createElement(name);this.configureTransparentBackground(node);node.style.position='absolute';return node;};mxStencilShape.prototype.configureVmlShape=function(node){};mxStencilShape.prototype.redraw=function(){this.updateBoundingBox();if(this.dialect==mxConstants.DIALECT_SVG){this.redrawShape();}else{this.node.style.visibility='hidden';this.redrawShape();this.node.style.visibility='visible';}};mxStencilShape.prototype.redrawShape=function(){if(this.dialect!=mxConstants.DIALECT_SVG){this.node.innerHTML='';this.node.style.left=Math.round(this.bounds.x)+'px';this.node.style.top=Math.round(this.bounds.y)+'px';var w=Math.round(this.bounds.width);var h=Math.round(this.bounds.height);this.node.style.width=w+'px';this.node.style.height=h+'px';if(mxUtils.isVml(this.node)){this.node.coordsize=(w*this.vmlScale)+','+(h*this.vmlScale);}}else{while(this.node.firstChild!=null){this.node.removeChild(this.node.firstChild);}}this.stencil.renderDom(this,this.bounds,this.node);};var mxMarker={markers:[],paintMarker:function(node,type,p0,pe,color,strokewidth,size,scale,x0,y0,source,style){var marker=mxMarker.markers[type];var result=null;if(marker!=null){var isVml=mxUtils.isVml(node);var dx=pe.x-p0.x;var dy=pe.y-p0.y;if(isNaN(dx)||isNaN(dy)){return;}var dist=Math.max(1,Math.sqrt(dx*dx+dy*dy));var nx=dx*scale/dist;var ny=dy*scale/dist;pe=pe.clone();if(isVml){pe.x-=x0;pe.y-=y0;}var filled=true;var key=(source)?mxConstants.STYLE_STARTFILL:mxConstants.STYLE_ENDFILL;if(style[key]==0){filled=false;}if(isVml){node.strokecolor=color;if(filled){node.fillcolor=color;}else{node.filled='false';}}else{node.setAttribute('stroke',color);var op=(style.opacity!=null)?style.opacity/100:1;node.setAttribute('stroke-opacity',op);if(filled){node.setAttribute('fill',color);node.setAttribute('fill-opacity',op);}else{node.setAttribute('fill','none');}}result=marker.call(this,node,type,pe,nx,ny,strokewidth,size,scale,isVml);}return result;}};(function(){var tmp=function(node,type,pe,nx,ny,strokewidth,size,scale,isVml){var endOffsetX=nx*strokewidth*1.118;var endOffsetY=ny*strokewidth*1.118;pe.x-=endOffsetX;pe.y-=endOffsetY;nx=nx*(size+strokewidth);ny=ny*(size+strokewidth);if(isVml){node.path='m'+Math.round(pe.x)+','+Math.round(pe.y)+' l'+Math.round(pe.x-nx-ny/2)+' '+Math.round(pe.y-ny+nx/2)+((type!=mxConstants.ARROW_CLASSIC)?'':' '+Math.round(pe.x-nx*3/4)+' '+Math.round(pe.y-ny*3/4))+' '+Math.round(pe.x+ny/2-nx)+' '+Math.round(pe.y-ny-nx/2)+' x e';node.setAttribute('strokeweight',(strokewidth*scale)+'px');}else{node.setAttribute('d','M '+pe.x+' '+pe.y+' L '+(pe.x-nx-ny/2)+' '+(pe.y-ny+nx/2)+((type!=mxConstants.ARROW_CLASSIC)?'':' L '+(pe.x-nx*3/4)+' '+(pe.y-ny*3/4))+' L '+(pe.x+ny/2-nx)+' '+(pe.y-ny-nx/2)+' z');node.setAttribute('stroke-width',strokewidth*scale);}var f=(type!=mxConstants.ARROW_CLASSIC)?1:3/4;return new mxPoint(-nx*f-endOffsetX,-ny*f-endOffsetY);};mxMarker.markers[mxConstants.ARROW_CLASSIC]=tmp;mxMarker.markers[mxConstants.ARROW_BLOCK]=tmp;}());mxMarker.markers[mxConstants.ARROW_OPEN]=function(node,type,pe,nx,ny,strokewidth,size,scale,isVml){var endOffsetX=nx*strokewidth*1.118;var endOffsetY=ny*strokewidth*1.118;pe.x-=endOffsetX;pe.y-=endOffsetY;nx=nx*(size+strokewidth);ny=ny*(size+strokewidth);if(isVml){node.path='m'+Math.round(pe.x-nx-ny/2)+' '+Math.round(pe.y-ny+nx/2)+' l'+Math.round(pe.x)+' '+Math.round(pe.y)+' '+Math.round(pe.x+ny/2-nx)+' '+Math.round(pe.y-ny-nx/2)+' e nf';node.setAttribute('strokeweight',(strokewidth*scale)+'px');}else{node.setAttribute('d','M '+(pe.x-nx-ny/2)+' '+(pe.y-ny+nx/2)+' L '+(pe.x)+' '+(pe.y)+' L '+(pe.x+ny/2-nx)+' '+(pe.y-ny-nx/2));node.setAttribute('stroke-width',strokewidth*scale);node.setAttribute('fill','none');}return new mxPoint(-endOffsetX*2,-endOffsetY*2);};mxMarker.markers[mxConstants.ARROW_OVAL]=function(node,type,pe,nx,ny,strokewidth,size,scale,isVml){nx*=size;ny*=size;nx*=0.5+strokewidth/2;ny*=0.5+strokewidth/2;var absSize=size*scale;var radius=absSize/2;if(isVml){node.path='m'+Math.round(pe.x+radius)+' '+Math.round(pe.y)+' at '+Math.round(pe.x-radius)+' '+Math.round(pe.y-radius)+' '+Math.round(pe.x+radius)+' '+Math.round(pe.y+radius)+' '+Math.round(pe.x+radius)+' '+Math.round(pe.y)+' '+Math.round(pe.x+radius)+' '+Math.round(pe.y)+' x e';node.setAttribute('strokeweight',(strokewidth*scale)+'px');}else{node.setAttribute('d','M '+(pe.x-radius)+' '+(pe.y)+' a '+(radius)+' '+(radius)+' 0  1,1 '+(absSize)+' 0'+' a '+(radius)+' '+(radius)+' 0  1,1 '+(-absSize)+' 0 z');node.setAttribute('stroke-width',strokewidth*scale);}return new mxPoint(-nx/(2+strokewidth),-ny/(2+strokewidth));};(function(){var tmp_diamond=function(node,type,pe,nx,ny,strokewidth,size,scale,isVml){var swFactor=(type==mxConstants.ARROW_DIAMOND)?0.7071:0.9862;var endOffsetX=nx*strokewidth*swFactor;var endOffsetY=ny*strokewidth*swFactor;nx=nx*(size+strokewidth);ny=ny*(size+strokewidth);pe.x-=endOffsetX+nx/2;pe.y-=endOffsetY+ny/2;var tk=((type==mxConstants.ARROW_DIAMOND)?2:3.4);if(isVml){node.path='m'+Math.round(pe.x+nx/2)+' '+Math.round(pe.y+ny/2)+' l'+Math.round(pe.x-ny/tk)+' '+Math.round(pe.y+nx/tk)+' '+Math.round(pe.x-nx/2)+' '+Math.round(pe.y-ny/2)+' '+Math.round(pe.x+ny/tk)+' '+Math.round(pe.y-nx/tk)+' x e';node.setAttribute('strokeweight',(strokewidth*scale)+'px');}else{node.setAttribute('d','M '+(pe.x+nx/2)+' '+(pe.y+ny/2)+' L '+(pe.x-ny/tk)+' '+(pe.y+nx/tk)+' L '+(pe.x-nx/2)+' '+(pe.y-ny/2)+' L '+(pe.x+ny/tk)+' '+(pe.y-nx/tk)+' z');node.setAttribute('stroke-width',strokewidth*scale);}return new mxPoint(-endOffsetX-nx,-endOffsetY-ny);};mxMarker.markers[mxConstants.ARROW_DIAMOND]=tmp_diamond;mxMarker.markers[mxConstants.ARROW_DIAMOND_THIN]=tmp_diamond;}());function mxActor(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxActor.prototype=new mxShape();mxActor.prototype.constructor=mxActor;mxActor.prototype.mixedModeHtml=false;mxActor.prototype.preferModeHtml=false;mxActor.prototype.vmlScale=2;mxActor.prototype.createVml=function(){var node=document.createElement('v:shape');node.style.position='absolute';this.configureVmlShape(node);return node;};mxActor.prototype.redrawVml=function(){this.updateVmlShape(this.node);this.node.path=this.createPath();};mxActor.prototype.createSvg=function(){return this.createSvgGroup('path');};mxActor.prototype.redrawSvg=function(){var strokeWidth=Math.round(Math.max(1,this.strokewidth*this.scale));this.innerNode.setAttribute('stroke-width',strokeWidth);this.innerNode.setAttribute('stroke-linejoin','round');if(this.crisp){this.innerNode.setAttribute('shape-rendering','crispEdges');}else{this.innerNode.removeAttribute('shape-rendering');}var d=this.createPath();if(d.length>0){this.innerNode.setAttribute('d',d);if(this.shadowNode!=null){this.shadowNode.setAttribute('transform',this.getSvgShadowTransform());this.shadowNode.setAttribute('stroke-width',strokeWidth);this.shadowNode.setAttribute('d',d);}}else{this.innerNode.removeAttribute('d');if(this.shadowNode!=null){this.shadowNode.removeAttribute('d');}}if(this.isDashed){var phase=Math.max(1,Math.round(3*this.scale*this.strokewidth));this.innerNode.setAttribute('stroke-dasharray',phase+' '+phase);}};mxActor.prototype.redrawPath=function(path,x,y,w,h){var width=w/3;path.moveTo(0,h);path.curveTo(0,3*h/5,0,2*h/5,w/2,2*h/5);path.curveTo(w/2-width,2*h/5,w/2-width,0,w/2,0);path.curveTo(w/2+width,0,w/2+width,2*h/5,w/2,2*h/5);path.curveTo(w,2*h/5,w,3*h/5,w,h);path.close();};function mxCloud(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxCloud.prototype=new mxActor();mxCloud.prototype.constructor=mxActor;mxCloud.prototype.redrawPath=function(path,x,y,w,h){path.moveTo(0.25*w,0.25*h);path.curveTo(0.05*w,0.25*h,0,0.5*h,0.16*w,0.55*h);path.curveTo(0,0.66*h,0.18*w,0.9*h,0.31*w,0.8*h);path.curveTo(0.4*w,h,0.7*w,h,0.8*w,0.8*h);path.curveTo(w,0.8*h,w,0.6*h,0.875*w,0.5*h);path.curveTo(w,0.3*h,0.8*w,0.1*h,0.625*w,0.2*h);path.curveTo(0.5*w,0.05*h,0.3*w,0.05*h,0.25*w,0.25*h);path.close();};function mxRectangleShape(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxRectangleShape.prototype=new mxShape();mxRectangleShape.prototype.constructor=mxRectangleShape;mxRectangleShape.prototype.createHtml=function(){var node=document.createElement('DIV');this.configureHtmlShape(node);return node;};mxRectangleShape.prototype.createVml=function(){var name=(this.isRounded)?'v:roundrect':'v:rect';var node=document.createElement(name);this.configureVmlShape(node);return node;};mxRectangleShape.prototype.createSvg=function(){return this.createSvgGroup('rect');};function mxEllipse(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxEllipse.prototype=new mxShape();mxEllipse.prototype.constructor=mxEllipse;mxEllipse.prototype.mixedModeHtml=false;mxEllipse.prototype.preferModeHtml=false;mxEllipse.prototype.createVml=function(){var node=document.createElement('v:arc');node.startangle='0';node.endangle='360';this.configureVmlShape(node);return node;};mxEllipse.prototype.createSvg=function(){return this.createSvgGroup('ellipse');};mxEllipse.prototype.redrawSvg=function(){if(this.crisp){this.innerNode.setAttribute('shape-rendering','crispEdges');}else{this.innerNode.removeAttribute('shape-rendering');}this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);};mxEllipse.prototype.updateSvgNode=function(node){if(node!=null){var strokeWidth=Math.round(Math.max(1,this.strokewidth*this.scale));node.setAttribute('stroke-width',strokeWidth);node.setAttribute('cx',this.bounds.x+this.bounds.width/2);node.setAttribute('cy',this.bounds.y+this.bounds.height/2);node.setAttribute('rx',this.bounds.width/2);node.setAttribute('ry',this.bounds.height/2);if(this.shadowNode!=null){this.shadowNode.setAttribute('transform',this.getSvgShadowTransform());}if(this.isDashed){var phase=Math.max(1,Math.round(3*this.scale*this.strokewidth));node.setAttribute('stroke-dasharray',phase+' '+phase);}}};function mxDoubleEllipse(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxDoubleEllipse.prototype=new mxShape();mxDoubleEllipse.prototype.constructor=mxDoubleEllipse;mxDoubleEllipse.prototype.vmlNodes=mxDoubleEllipse.prototype.vmlNodes.concat(['background','foreground']);mxDoubleEllipse.prototype.mixedModeHtml=false;mxDoubleEllipse.prototype.preferModeHtml=false;mxDoubleEllipse.prototype.vmlScale=2;mxDoubleEllipse.prototype.createVml=function(){var node=document.createElement('v:group');this.background=document.createElement('v:arc');this.background.startangle='0';this.background.endangle='360';this.configureVmlShape(this.background);node.appendChild(this.background);this.label=this.background;this.isShadow=false;this.fill=null;this.foreground=document.createElement('v:oval');this.configureVmlShape(this.foreground);node.appendChild(this.foreground);this.stroke=null;this.configureVmlShape(node);return node;};mxDoubleEllipse.prototype.redrawVml=function(){this.updateVmlShape(this.node);this.updateVmlShape(this.background);this.updateVmlShape(this.foreground);var inset=Math.round((this.strokewidth+3)*this.scale)*this.vmlScale;var w=Math.round(this.bounds.width*this.vmlScale);var h=Math.round(this.bounds.height*this.vmlScale);this.foreground.style.top=inset+'px';this.foreground.style.left=inset+'px';this.foreground.style.width=Math.max(0,w-2*inset)+'px';this.foreground.style.height=Math.max(0,h-2*inset)+'px';};mxDoubleEllipse.prototype.createSvg=function(){var g=this.createSvgGroup('ellipse');this.foreground=document.createElementNS(mxConstants.NS_SVG,'ellipse');if(this.stroke!=null){this.foreground.setAttribute('stroke',this.stroke);}else{this.foreground.setAttribute('stroke','none');}this.foreground.setAttribute('fill','none');g.appendChild(this.foreground);return g;};mxDoubleEllipse.prototype.redrawSvg=function(){if(this.crisp){this.innerNode.setAttribute('shape-rendering','crispEdges');this.foreground.setAttribute('shape-rendering','crispEdges');}else{this.innerNode.removeAttribute('shape-rendering');this.foreground.removeAttribute('shape-rendering');}this.updateSvgNode(this.innerNode);this.updateSvgNode(this.shadowNode);this.updateSvgNode(this.foreground,(this.strokewidth+3)*this.scale);if(this.isDashed){var phase=Math.max(1,Math.round(3*this.scale*this.strokewidth));this.innerNode.setAttribute('stroke-dasharray',phase+' '+phase);}};mxDoubleEllipse.prototype.updateSvgNode=function(node,inset){inset=(inset!=null)?inset:0;if(node!=null){var strokeWidth=Math.round(Math.max(1,this.strokewidth*this.scale));node.setAttribute('stroke-width',strokeWidth);node.setAttribute('cx',this.bounds.x+this.bounds.width/2);node.setAttribute('cy',this.bounds.y+this.bounds.height/2);node.setAttribute('rx',Math.max(0,this.bounds.width/2-inset));node.setAttribute('ry',Math.max(0,this.bounds.height/2-inset));if(this.shadowNode!=null){this.shadowNode.setAttribute('transform',this.getSvgShadowTransform());}}};function mxRhombus(bounds,fill,stroke,strokewidth){this.bounds=bounds;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxRhombus.prototype=new mxShape();mxRhombus.prototype.constructor=mxRhombus;mxRhombus.prototype.mixedModeHtml=false;mxRhombus.prototype.preferModeHtml=false;mxRhombus.prototype.createHtml=function(){var node=document.createElement('DIV');this.configureHtmlShape(node);return node;};mxRhombus.prototype.createVml=function(){var node=document.createElement('v:shape');this.configureVmlShape(node);return node;};mxRhombus.prototype.createSvg=function(){return this.createSvgGroup('path');};mxRhombus.prototype.redrawVml=function(){this.updateVmlShape(this.node);var x=0;var y=0;var w=Math.round(this.bounds.width);var h=Math.round(this.bounds.height);this.node.path='m '+Math.round(x+w/2)+' '+y+' l '+(x+w)+' '+Math.round(y+h/2)+' l '+Math.round(x+w/2)+' '+(y+h)+' l '+x+' '+Math.round(y+h/2)+' x e';};mxRhombus.prototype.redrawHtml=function(){this.updateHtmlShape(this.node);};mxRhombus.prototype.redrawSvg=function(){this.updateSvgNode(this.innerNode);if(this.shadowNode!=null){this.updateSvgNode(this.shadowNode);}};mxRhombus.prototype.updateSvgNode=function(node){var strokeWidth=Math.round(Math.max(1,this.strokewidth*this.scale));node.setAttribute('stroke-width',strokeWidth);var x=this.bounds.x;var y=this.bounds.y;var w=this.bounds.width;var h=this.bounds.height;var d='M '+Math.round(x+w/2)+' '+Math.round(y)+' L '+Math.round(x+w)+' '+Math.round(y+h/2)+' L '+Math.round(x+w/2)+' '+Math.round(y+h)+' L '+Math.round(x)+' '+Math.round(y+h/2)+' Z ';node.setAttribute('d',d);this.updateSvgTransform(node,node==this.shadowNode);if(this.isDashed){var phase=Math.max(1,Math.round(3*this.scale*this.strokewidth));node.setAttribute('stroke-dasharray',phase+' '+phase);}};function mxPolyline(points,stroke,strokewidth){this.points=points;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;};mxPolyline.prototype=new mxShape();mxPolyline.prototype.constructor=mxPolyline;mxPolyline.prototype.addPipe=true;mxPolyline.prototype.create=function(){var node=null;if(this.dialect==mxConstants.DIALECT_SVG){node=this.createSvg();}else if(this.dialect==mxConstants.DIALECT_STRICTHTML||(this.dialect==mxConstants.DIALECT_PREFERHTML&&this.points!=null&&this.points.length>0)){node=document.createElement('DIV');this.configureHtmlShape(node);node.style.borderStyle='';node.style.background='';}else{node=document.createElement('v:shape');this.configureVmlShape(node);var strokeNode=document.createElement('v:stroke');if(this.opacity!=null){strokeNode.opacity=this.opacity+'%';}node.appendChild(strokeNode);}return node;};mxPolyline.prototype.redrawVml=function(){if(this.points!=null&&this.points.length>0&&this.points[0]!=null){this.bounds=new mxRectangle(this.points[0].x,this.points[0].y,0,0);for(var i=1;i<this.points.length;i++){this.bounds.add(new mxRectangle(this.points[i].x,this.points[i].y,0,0));}}mxShape.prototype.redrawVml.apply(this,arguments);};mxPolyline.prototype.createSvg=function(){var g=this.createSvgGroup('path');if(this.addPipe){this.pipe=this.createSvgPipe();g.appendChild(this.pipe);}return g;};mxPolyline.prototype.redrawSvg=function(){this.updateSvgShape(this.innerNode);var d=this.innerNode.getAttribute('d');if(d!=null&&this.pipe!=null){this.pipe.setAttribute('d',d);var strokeWidth=Math.round(Math.max(1,this.strokewidth*this.scale));this.pipe.setAttribute('stroke-width',strokeWidth+mxShape.prototype.SVG_STROKE_TOLERANCE);}};function mxArrow(points,fill,stroke,strokewidth,arrowWidth,spacing,endSize){this.points=points;this.fill=fill;this.stroke=stroke;this.strokewidth=(strokewidth!=null)?strokewidth:1;this.arrowWidth=(arrowWidth!=null)?arrowWidth:mxConstants.ARROW_WIDTH;this.spacing=(spacing!=null)?spacing:mxConstants.ARROW_SPACING;this.endSize=(endSize!=null)?endSize:mxConstants.ARROW_SIZE;};mxArrow.prototype=new mxActor();mxArrow.prototype.constructor=mxArrow;mxArrow.prototype.addPipe=false;mxArrow.prototype.enableFill=true;mxArrow.prototype.configureTransparentBackground=function(node){};mxArrow.prototype.augmentBoundingBox=function(bbox){bbox.grow(Math.max(this.arrowWidth/2,this.endSize/2)*this.scale);mxShape.prototype.augmentBoundingBox.apply(this,arguments);};mxArrow.prototype.createVml=function(){if(!this.enableFill){this.fill=null;}return mxActor.prototype.createVml.apply(this,arguments);};mxArrow.prototype.createSvg=function(){if(!this.enableFill){this.fill=null;}var g=mxActor.prototype.createSvg.apply(this,arguments);if(this.addPipe){this.pipe=this.createSvgPipe();g.appendChild(this.pipe);}return g;};mxArrow.prototype.reconfigure=function(){if(!this.enableFill){this.fill=null;}mxActor.prototype.reconfigure.apply(this,arguments);};mxArrow.prototype.redrawSvg=function(){mxActor.prototype.redrawSvg.apply(this,arguments);if(this.pipe!=null){var d=this.innerNode.getAttribute('d');if(d!=null){this.pipe.setAttribute('d',this.innerNode.getAttribute('d'));var strokeWidth=Math.round(this.strokewidth*this.scale);this.pipe.setAttribute('stroke-width',strokeWidth+mxShape.prototype.SVG_STROKE_TOLERANCE);}}};mxArrow.prototype.redrawPath=function(path,x,y,w,h){path.translate.x-=x;path.translate.y-=y;var spacing=this.spacing*this.scale;var width=this.arrowWidth*this.scale;var arrow=this.endSize*this.scale;var p0=this.points[0];var pe=this.points[this.points.length-1];var dx=pe.x-p0.x;var dy=pe.y-p0.y;var dist=Math.sqrt(dx*dx+dy*dy);var length=dist-2*spacing-arrow;var nx=dx/dist;var ny=dy/dist;var basex=length*nx;var basey=length*ny;var floorx=width*ny/3;var floory=-width*nx/3;var p0x=p0.x-floorx/2+spacing*nx;var p0y=p0.y-floory/2+spacing*ny;var p1x=p0x+floorx;var p1y=p0y+floory;var p2x=p1x+basex;var p2y=p1y+basey;var p3x=p2x+floorx;var p3y=p2y+floory;var p5x=p3x-3*floorx;var p5y=p3y-3*floory;path.moveTo(p0x,p0y);path.lineTo(p1x,p1y);path.lineTo(p2x,p2y);path.lineTo(p3x,p3y);path.lineTo(pe.x-spacing*nx,pe.y-spacing*ny);path.lineTo(p5x,p5y);path.lineTo(p5x+floorx,p5y+floory);path.lineTo(p0x,p0y);path.close();};function mxText(value,bounds,align,valign,color,family,size,fontStyle,spacing,spacingTop,spacingRight,spacingBottom,spacingLeft,horizontal,background,border,wrap,clipped,overflow,labelPadding){this.value=value;this.bounds=bounds;this.color=(color!=null)?color:'black';this.align=(align!=null)?align:'';this.valign=(valign!=null)?valign:'';this.family=(family!=null)?family:mxConstants.DEFAULT_FONTFAMILY;this.size=(size!=null)?size:mxConstants.DEFAULT_FONTSIZE;this.fontStyle=(fontStyle!=null)?fontStyle:0;this.spacing=parseInt(spacing||2);this.spacingTop=this.spacing+parseInt(spacingTop||0);this.spacingRight=this.spacing+parseInt(spacingRight||0);this.spacingBottom=this.spacing+parseInt(spacingBottom||0);this.spacingLeft=this.spacing+parseInt(spacingLeft||0);this.horizontal=(horizontal!=null)?horizontal:true;this.background=background;this.border=border;this.wrap=(wrap!=null)?wrap:false;this.clipped=(clipped!=null)?clipped:false;this.overflow=(overflow!=null)?overflow:'visible';this.labelPadding=(labelPadding!=null)?labelPadding:0;};mxText.prototype=new mxShape();mxText.prototype.constructor=mxText;mxText.prototype.replaceLinefeeds=true;mxText.prototype.ieVerticalFilter='progid:DXImageTransform.Microsoft.BasicImage(rotation=3)';mxText.prototype.verticalTextDegree=-90;mxText.prototype.forceIgnoreStringSize=false;mxText.prototype.isStyleSet=function(style){return(this.fontStyle&style)==style;};mxText.prototype.create=function(container){var node=null;if(this.dialect==mxConstants.DIALECT_SVG){node=this.createSvg();}else if(this.dialect==mxConstants.DIALECT_STRICTHTML||this.dialect==mxConstants.DIALECT_PREFERHTML||!mxUtils.isVml(container)){if(mxClient.IS_SVG&&!mxClient.NO_FO){node=this.createForeignObject();}else{node=this.createHtml();}}else{node=this.createVml();}return node;};mxText.prototype.updateBoundingBox=function(){};mxText.prototype.createForeignObject=function(){var node=document.createElementNS(mxConstants.NS_SVG,'g');var fo=document.createElementNS(mxConstants.NS_SVG,'foreignObject');fo.setAttribute('pointer-events','fill');if(this.overflow=='hidden'){fo.style.overflow='hidden';}else{fo.style.overflow='visible';}var body=document.createElementNS(mxConstants.NS_XHTML,'body');body.setAttribute('xmlns','http://www.w3.org/1999/xhtml');body.style.margin='0px';body.style.height='100%';fo.appendChild(body);node.appendChild(fo);return node;};mxText.prototype.createHtml=function(){var table=this.createHtmlTable();table.style.position='absolute';return table;};mxText.prototype.createVml=function(){return document.createElement('v:textbox');};mxText.prototype.redrawHtml=function(){this.redrawVml();};mxText.prototype.getOffset=function(outerWidth,outerHeight,actualWidth,actualHeight,horizontal){horizontal=(horizontal!=null)?horizontal:this.horizontal;var tmpalign=(horizontal)?this.align:this.valign;var tmpvalign=(horizontal)?this.valign:this.align;var dx=actualWidth-outerWidth;var dy=actualHeight-outerHeight;if(tmpalign==mxConstants.ALIGN_CENTER||tmpalign==mxConstants.ALIGN_MIDDLE){dx=Math.round(dx/2);}else if(tmpalign==mxConstants.ALIGN_LEFT||tmpalign===mxConstants.ALIGN_TOP){dx=(horizontal)?0:(actualWidth-actualHeight)/2;}else if(!horizontal) {dx=(actualWidth+actualHeight)/2-outerWidth;}if(tmpvalign==mxConstants.ALIGN_MIDDLE||tmpvalign==mxConstants.ALIGN_CENTER){dy=Math.round(dy/2);}else if(tmpvalign==mxConstants.ALIGN_TOP||tmpvalign==mxConstants.ALIGN_LEFT){dy=(horizontal)?0:(actualHeight+actualWidth)/2-outerHeight;}else if(!horizontal) {dy=(actualHeight-actualWidth)/2;}return new mxPoint(dx,dy);};mxText.prototype.getSpacing=fu